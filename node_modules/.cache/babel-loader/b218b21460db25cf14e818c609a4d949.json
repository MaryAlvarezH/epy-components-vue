{"remainingRequest":"/home/mary/Desktop/web components/vue-test/vue-button/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js!/home/mary/Desktop/web components/vue-test/vue-button/node_modules/eslint-loader/index.js??ref--13-0!/home/mary/Desktop/web components/vue-test/vue-button/dist/esm-es5/core-165e720c.js","dependencies":[{"path":"/home/mary/Desktop/web components/vue-test/vue-button/dist/esm-es5/core-165e720c.js","mtime":1579718280574},{"path":"/home/mary/Desktop/web components/vue-test/vue-button/node_modules/cache-loader/dist/cjs.js","mtime":1574719794050},{"path":"/home/mary/Desktop/web components/vue-test/vue-button/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js","mtime":1574719794019},{"path":"/home/mary/Desktop/web components/vue-test/vue-button/node_modules/eslint-loader/index.js","mtime":1576012030759}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9fZXh0ZW5kcyA9IHRoaXMgJiYgdGhpcy5fX2V4dGVuZHMgfHwgZnVuY3Rpb24gKCkgewogIHZhciBleHRlbmRTdGF0aWNzID0gZnVuY3Rpb24gKGQsIGIpIHsKICAgIGV4dGVuZFN0YXRpY3MgPSBPYmplY3Quc2V0UHJvdG90eXBlT2YgfHwgewogICAgICBfX3Byb3RvX186IFtdCiAgICB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsKICAgICAgZC5fX3Byb3RvX18gPSBiOwogICAgfSB8fCBmdW5jdGlvbiAoZCwgYikgewogICAgICBmb3IgKHZhciBwIGluIGIpIGlmIChiLmhhc093blByb3BlcnR5KHApKSBkW3BdID0gYltwXTsKICAgIH07CgogICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7CiAgfTsKCiAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7CiAgICBleHRlbmRTdGF0aWNzKGQsIGIpOwoKICAgIGZ1bmN0aW9uIF9fKCkgewogICAgICB0aGlzLmNvbnN0cnVjdG9yID0gZDsKICAgIH0KCiAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7CiAgfTsKfSgpOwoKdmFyIF9fYXdhaXRlciA9IHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikgewogIGZ1bmN0aW9uIGFkb3B0KHZhbHVlKSB7CiAgICByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICByZXNvbHZlKHZhbHVlKTsKICAgIH0pOwogIH0KCiAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsKICAgICAgdHJ5IHsKICAgICAgICBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICByZWplY3QoZSk7CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgewogICAgICB0cnkgewogICAgICAgIHN0ZXAoZ2VuZXJhdG9yWyJ0aHJvdyJdKHZhbHVlKSk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICByZWplY3QoZSk7CiAgICAgIH0KICAgIH0KCiAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgewogICAgICByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsKICAgIH0KCiAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7CiAgfSk7Cn07Cgp2YXIgX19nZW5lcmF0b3IgPSB0aGlzICYmIHRoaXMuX19nZW5lcmF0b3IgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIGJvZHkpIHsKICB2YXIgXyA9IHsKICAgIGxhYmVsOiAwLAogICAgc2VudDogZnVuY3Rpb24gKCkgewogICAgICBpZiAodFswXSAmIDEpIHRocm93IHRbMV07CiAgICAgIHJldHVybiB0WzFdOwogICAgfSwKICAgIHRyeXM6IFtdLAogICAgb3BzOiBbXQogIH0sCiAgICAgIGYsCiAgICAgIHksCiAgICAgIHQsCiAgICAgIGc7CiAgcmV0dXJuIGcgPSB7CiAgICBuZXh0OiB2ZXJiKDApLAogICAgInRocm93IjogdmVyYigxKSwKICAgICJyZXR1cm4iOiB2ZXJiKDIpCiAgfSwgdHlwZW9mIFN5bWJvbCA9PT0gImZ1bmN0aW9uIiAmJiAoZ1tTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIHRoaXM7CiAgfSksIGc7CgogIGZ1bmN0aW9uIHZlcmIobikgewogICAgcmV0dXJuIGZ1bmN0aW9uICh2KSB7CiAgICAgIHJldHVybiBzdGVwKFtuLCB2XSk7CiAgICB9OwogIH0KCiAgZnVuY3Rpb24gc3RlcChvcCkgewogICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoIkdlbmVyYXRvciBpcyBhbHJlYWR5IGV4ZWN1dGluZy4iKTsKCiAgICB3aGlsZSAoXykgdHJ5IHsKICAgICAgaWYgKGYgPSAxLCB5ICYmICh0ID0gb3BbMF0gJiAyID8geVsicmV0dXJuIl0gOiBvcFswXSA/IHlbInRocm93Il0gfHwgKCh0ID0geVsicmV0dXJuIl0pICYmIHQuY2FsbCh5KSwgMCkgOiB5Lm5leHQpICYmICEodCA9IHQuY2FsbCh5LCBvcFsxXSkpLmRvbmUpIHJldHVybiB0OwogICAgICBpZiAoeSA9IDAsIHQpIG9wID0gW29wWzBdICYgMiwgdC52YWx1ZV07CgogICAgICBzd2l0Y2ggKG9wWzBdKSB7CiAgICAgICAgY2FzZSAwOgogICAgICAgIGNhc2UgMToKICAgICAgICAgIHQgPSBvcDsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDQ6CiAgICAgICAgICBfLmxhYmVsKys7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICB2YWx1ZTogb3BbMV0sCiAgICAgICAgICAgIGRvbmU6IGZhbHNlCiAgICAgICAgICB9OwoKICAgICAgICBjYXNlIDU6CiAgICAgICAgICBfLmxhYmVsKys7CiAgICAgICAgICB5ID0gb3BbMV07CiAgICAgICAgICBvcCA9IFswXTsKICAgICAgICAgIGNvbnRpbnVlOwoKICAgICAgICBjYXNlIDc6CiAgICAgICAgICBvcCA9IF8ub3BzLnBvcCgpOwoKICAgICAgICAgIF8udHJ5cy5wb3AoKTsKCiAgICAgICAgICBjb250aW51ZTsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIGlmICghKHQgPSBfLnRyeXMsIHQgPSB0Lmxlbmd0aCA+IDAgJiYgdFt0Lmxlbmd0aCAtIDFdKSAmJiAob3BbMF0gPT09IDYgfHwgb3BbMF0gPT09IDIpKSB7CiAgICAgICAgICAgIF8gPSAwOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IG9wWzFdID4gdFswXSAmJiBvcFsxXSA8IHRbM10pKSB7CiAgICAgICAgICAgIF8ubGFiZWwgPSBvcFsxXTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKG9wWzBdID09PSA2ICYmIF8ubGFiZWwgPCB0WzFdKSB7CiAgICAgICAgICAgIF8ubGFiZWwgPSB0WzFdOwogICAgICAgICAgICB0ID0gb3A7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7CiAgICAgICAgICAgIF8ubGFiZWwgPSB0WzJdOwoKICAgICAgICAgICAgXy5vcHMucHVzaChvcCk7CgogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7CgogICAgICAgICAgXy50cnlzLnBvcCgpOwoKICAgICAgICAgIGNvbnRpbnVlOwogICAgICB9CgogICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgb3AgPSBbNiwgZV07CiAgICAgIHkgPSAwOwogICAgfSBmaW5hbGx5IHsKICAgICAgZiA9IHQgPSAwOwogICAgfQoKICAgIGlmIChvcFswXSAmIDUpIHRocm93IG9wWzFdOwogICAgcmV0dXJuIHsKICAgICAgdmFsdWU6IG9wWzBdID8gb3BbMV0gOiB2b2lkIDAsCiAgICAgIGRvbmU6IHRydWUKICAgIH07CiAgfQp9OwoKdmFyIF9fc3ByZWFkQXJyYXlzID0gdGhpcyAmJiB0aGlzLl9fc3ByZWFkQXJyYXlzIHx8IGZ1bmN0aW9uICgpIHsKICBmb3IgKHZhciBzID0gMCwgaSA9IDAsIGlsID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGlsOyBpKyspIHMgKz0gYXJndW1lbnRzW2ldLmxlbmd0aDsKCiAgZm9yICh2YXIgciA9IEFycmF5KHMpLCBrID0gMCwgaSA9IDA7IGkgPCBpbDsgaSsrKSBmb3IgKHZhciBhID0gYXJndW1lbnRzW2ldLCBqID0gMCwgamwgPSBhLmxlbmd0aDsgaiA8IGpsOyBqKyssIGsrKykgcltrXSA9IGFbal07CgogIHJldHVybiByOwp9OwoKdmFyIEJVSUxEID0gewogICJhbGxSZW5kZXJGbiI6IHRydWUsCiAgImNtcERpZExvYWQiOiBmYWxzZSwKICAiY21wU2hvdWxkVXBkYXRlIjogZmFsc2UsCiAgImNtcERpZFVubG9hZCI6IGZhbHNlLAogICJjbXBEaWRVcGRhdGUiOiBmYWxzZSwKICAiY21wRGlkUmVuZGVyIjogZmFsc2UsCiAgImNtcFdpbGxMb2FkIjogZmFsc2UsCiAgImNtcFdpbGxVcGRhdGUiOiBmYWxzZSwKICAiY21wV2lsbFJlbmRlciI6IGZhbHNlLAogICJjb25uZWN0ZWRDYWxsYmFjayI6IGZhbHNlLAogICJkaXNjb25uZWN0ZWRDYWxsYmFjayI6IGZhbHNlLAogICJlbGVtZW50IjogZmFsc2UsCiAgImV2ZW50IjogdHJ1ZSwKICAiaGFzUmVuZGVyRm4iOiB0cnVlLAogICJsaWZlY3ljbGUiOiBmYWxzZSwKICAiYXN5bmNMb2FkaW5nIjogdHJ1ZSwKICAiaG9zdExpc3RlbmVyIjogZmFsc2UsCiAgImhvc3RMaXN0ZW5lclRhcmdldFdpbmRvdyI6IGZhbHNlLAogICJob3N0TGlzdGVuZXJUYXJnZXREb2N1bWVudCI6IGZhbHNlLAogICJob3N0TGlzdGVuZXJUYXJnZXRCb2R5IjogZmFsc2UsCiAgImhvc3RMaXN0ZW5lclRhcmdldFBhcmVudCI6IGZhbHNlLAogICJob3N0TGlzdGVuZXJUYXJnZXQiOiBmYWxzZSwKICAibWVtYmVyIjogdHJ1ZSwKICAibWV0aG9kIjogZmFsc2UsCiAgIm1vZGUiOiBmYWxzZSwKICAibm9WZG9tUmVuZGVyIjogZmFsc2UsCiAgIm9ic2VydmVBdHRyaWJ1dGUiOiB0cnVlLAogICJwcm9wIjogdHJ1ZSwKICAicHJvcEJvb2xlYW4iOiBmYWxzZSwKICAicHJvcE51bWJlciI6IGZhbHNlLAogICJwcm9wU3RyaW5nIjogdHJ1ZSwKICAicHJvcE11dGFibGUiOiBmYWxzZSwKICAicmVmbGVjdCI6IGZhbHNlLAogICJzY29wZWQiOiBmYWxzZSwKICAic2hhZG93RG9tIjogZmFsc2UsCiAgInNoYWRvd0RlbGVnYXRlc0ZvY3VzIjogZmFsc2UsCiAgInNsb3QiOiB0cnVlLAogICJzbG90UmVsb2NhdGlvbiI6IHRydWUsCiAgInN0YXRlIjogZmFsc2UsCiAgInN0eWxlIjogdHJ1ZSwKICAic3ZnIjogZmFsc2UsCiAgInVwZGF0YWJsZSI6IHRydWUsCiAgInZkb21BdHRyaWJ1dGUiOiB0cnVlLAogICJ2ZG9tWGxpbmsiOiBmYWxzZSwKICAidmRvbUNsYXNzIjogdHJ1ZSwKICAidmRvbUZ1bmN0aW9uYWwiOiBmYWxzZSwKICAidmRvbUtleSI6IGZhbHNlLAogICJ2ZG9tTGlzdGVuZXIiOiB0cnVlLAogICJ2ZG9tUmVmIjogZmFsc2UsCiAgInZkb21SZW5kZXIiOiB0cnVlLAogICJ2ZG9tU3R5bGUiOiBmYWxzZSwKICAidmRvbVRleHQiOiBmYWxzZSwKICAid2F0Y2hDYWxsYmFjayI6IGZhbHNlLAogICJ0YXNrUXVldWUiOiB0cnVlLAogICJjbG9uZU5vZGVGaXgiOiBmYWxzZSwKICAiYXBwZW5kQ2hpbGRTbG90Rml4IjogZmFsc2UsCiAgImxhenlMb2FkIjogdHJ1ZSwKICAiaHlkcmF0ZVNlcnZlclNpZGUiOiBmYWxzZSwKICAiY3NzVmFyU2hpbSI6IHRydWUsCiAgImluaXRpYWxpemVOZXh0VGljayI6IHRydWUsCiAgImh5ZHJhdGVDbGllbnRTaWRlIjogZmFsc2UsCiAgImlzRGVidWciOiBmYWxzZSwKICAiaXNEZXYiOiBmYWxzZSwKICAiZGV2VG9vbHMiOiBmYWxzZSwKICAibGlmZWN5Y2xlRE9NRXZlbnRzIjogZmFsc2UsCiAgInByb2ZpbGUiOiBmYWxzZSwKICAiaG90TW9kdWxlUmVwbGFjZW1lbnQiOiBmYWxzZSwKICAiY29uc3RydWN0YWJsZUNTUyI6IHRydWUsCiAgImNzc0Fubm90YXRpb25zIjogdHJ1ZQp9Owp2YXIgTkFNRVNQQUNFID0gJ2VweS1jb21wb25lbnRzJzsKdmFyIHF1ZXVlQ29uZ2VzdGlvbiA9IDA7CnZhciBxdWV1ZVBlbmRpbmcgPSBmYWxzZTsKdmFyIHNjb3BlSWQ7CnZhciBjb250ZW50UmVmOwp2YXIgaG9zdFRhZ05hbWU7CnZhciB1c2VOYXRpdmVTaGFkb3dEb20gPSBmYWxzZTsKdmFyIGNoZWNrU2xvdEZhbGxiYWNrVmlzaWJpbGl0eSA9IGZhbHNlOwp2YXIgY2hlY2tTbG90UmVsb2NhdGUgPSBmYWxzZTsKdmFyIGlzU3ZnTW9kZSA9IGZhbHNlOwp2YXIgd2luID0gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgPyB3aW5kb3cgOiB7fTsKdmFyIGRvYyA9IHdpbi5kb2N1bWVudCB8fCB7CiAgaGVhZDoge30KfTsKdmFyIHBsdCA9IHsKICAkZmxhZ3MkOiAwLAogICRyZXNvdXJjZXNVcmwkOiAnJywKICBqbXA6IGZ1bmN0aW9uIChoKSB7CiAgICByZXR1cm4gaCgpOwogIH0sCiAgcmFmOiBmdW5jdGlvbiAoaCkgewogICAgcmV0dXJuIHJlcXVlc3RBbmltYXRpb25GcmFtZShoKTsKICB9LAogIGFlbDogZnVuY3Rpb24gKGVsLCBldmVudE5hbWUsIGxpc3RlbmVyLCBvcHRzKSB7CiAgICByZXR1cm4gZWwuYWRkRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIGxpc3RlbmVyLCBvcHRzKTsKICB9LAogIHJlbDogZnVuY3Rpb24gKGVsLCBldmVudE5hbWUsIGxpc3RlbmVyLCBvcHRzKSB7CiAgICByZXR1cm4gZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIGxpc3RlbmVyLCBvcHRzKTsKICB9Cn07CnZhciBzdXBwb3J0c1NoYWRvd0RvbSA9IGZhbHNlOwoKdmFyIHN1cHBvcnRzQ29uc3RydWN0aWJsZVN0eWxlc2hlZXRzID0KLypAX19QVVJFX18qLwpmdW5jdGlvbiAoKSB7CiAgdHJ5IHsKICAgIG5ldyBDU1NTdHlsZVNoZWV0KCk7CiAgICByZXR1cm4gdHJ1ZTsKICB9IGNhdGNoIChlKSB7fQoKICByZXR1cm4gZmFsc2U7Cn0oKTsKCnZhciBob3N0UmVmcyA9IG5ldyBXZWFrTWFwKCk7Cgp2YXIgZ2V0SG9zdFJlZiA9IGZ1bmN0aW9uIChyZWYpIHsKICByZXR1cm4gaG9zdFJlZnMuZ2V0KHJlZik7Cn07Cgp2YXIgcmVnaXN0ZXJJbnN0YW5jZSA9IGZ1bmN0aW9uIChsYXp5SW5zdGFuY2UsIGhvc3RSZWYpIHsKICByZXR1cm4gaG9zdFJlZnMuc2V0KGhvc3RSZWYuJGxhenlJbnN0YW5jZSQgPSBsYXp5SW5zdGFuY2UsIGhvc3RSZWYpOwp9OwoKdmFyIHJlZ2lzdGVySG9zdCA9IGZ1bmN0aW9uIChlbG0pIHsKICB2YXIgaG9zdFJlZiA9IHsKICAgICRmbGFncyQ6IDAsCiAgICAkaG9zdEVsZW1lbnQkOiBlbG0sCiAgICAkaW5zdGFuY2VWYWx1ZXMkOiBuZXcgTWFwKCkKICB9OwogIHsKICAgIGhvc3RSZWYuJG9uUmVhZHlQcm9taXNlJCA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyKSB7CiAgICAgIHJldHVybiBob3N0UmVmLiRvblJlYWR5UmVzb2x2ZSQgPSByOwogICAgfSk7CiAgICBlbG1bJ3MtcCddID0gW107CiAgICBlbG1bJ3MtcmMnXSA9IFtdOwogIH0KICByZXR1cm4gaG9zdFJlZnMuc2V0KGVsbSwgaG9zdFJlZik7Cn07Cgp2YXIgaXNNZW1iZXJJbkVsZW1lbnQgPSBmdW5jdGlvbiAoZWxtLCBtZW1iZXJOYW1lKSB7CiAgcmV0dXJuIG1lbWJlck5hbWUgaW4gZWxtOwp9OwoKdmFyIGNvbnNvbGVFcnJvciA9IGZ1bmN0aW9uIChlKSB7CiAgcmV0dXJuIGNvbnNvbGUuZXJyb3IoZSk7Cn07Cgp2YXIgbW9kdWxlQ2FjaGUgPQovKkBfX1BVUkVfXyovCm5ldyBNYXAoKTsKCnZhciBsb2FkTW9kdWxlID0gZnVuY3Rpb24gKGNtcE1ldGEsIGhvc3RSZWYsIGhtclZlcnNpb25JZCkgewogIC8vIGxvYWRNb2R1bGVJbXBvcnQKICB2YXIgZXhwb3J0TmFtZSA9IGNtcE1ldGEuJHRhZ05hbWUkLnJlcGxhY2UoLy0vZywgJ18nKTsKICB2YXIgYnVuZGxlSWQgPSBjbXBNZXRhLiRsYXp5QnVuZGxlSWRzJDsKICB2YXIgbW9kdWxlID0gbW9kdWxlQ2FjaGUuZ2V0KGJ1bmRsZUlkKTsKCiAgaWYgKG1vZHVsZSkgewogICAgcmV0dXJuIG1vZHVsZVtleHBvcnROYW1lXTsKICB9CgogIHJldHVybiBpbXBvcnQoCiAgLyogd2VicGFja0luY2x1ZGU6IC9cLmVudHJ5XC5qcyQvICovCgogIC8qIHdlYnBhY2tFeGNsdWRlOiAvXC5zeXN0ZW1cLmVudHJ5XC5qcyQvICovCgogIC8qIHdlYnBhY2tNb2RlOiAibGF6eSIgKi8KICAiLi8iICsgYnVuZGxlSWQgKyAiLmVudHJ5LmpzIiArICcnKS50aGVuKGZ1bmN0aW9uIChpbXBvcnRlZE1vZHVsZSkgewogICAgewogICAgICBtb2R1bGVDYWNoZS5zZXQoYnVuZGxlSWQsIGltcG9ydGVkTW9kdWxlKTsKICAgIH0KICAgIHJldHVybiBpbXBvcnRlZE1vZHVsZVtleHBvcnROYW1lXTsKICB9LCBjb25zb2xlRXJyb3IpOwp9OwoKdmFyIHN0eWxlcyA9IG5ldyBNYXAoKTsKdmFyIHF1ZXVlRG9tUmVhZHMgPSBbXTsKdmFyIHF1ZXVlRG9tV3JpdGVzID0gW107CnZhciBxdWV1ZURvbVdyaXRlc0xvdyA9IFtdOwoKdmFyIHF1ZXVlVGFzayA9IGZ1bmN0aW9uIChxdWV1ZSwgd3JpdGUpIHsKICByZXR1cm4gZnVuY3Rpb24gKGNiKSB7CiAgICBxdWV1ZS5wdXNoKGNiKTsKCiAgICBpZiAoIXF1ZXVlUGVuZGluZykgewogICAgICBxdWV1ZVBlbmRpbmcgPSB0cnVlOwoKICAgICAgaWYgKHdyaXRlICYmIHBsdC4kZmxhZ3MkICYgNAogICAgICAvKiBxdWV1ZVN5bmMgKi8KICAgICAgKSB7CiAgICAgICAgICBuZXh0VGljayhmbHVzaCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICBwbHQucmFmKGZsdXNoKTsKICAgICAgfQogICAgfQogIH07Cn07Cgp2YXIgY29uc3VtZSA9IGZ1bmN0aW9uIChxdWV1ZSkgewogIGZvciAodmFyIGkgPSAwOyBpIDwgcXVldWUubGVuZ3RoOyBpKyspIHsKICAgIHRyeSB7CiAgICAgIHF1ZXVlW2ldKHBlcmZvcm1hbmNlLm5vdygpKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgY29uc29sZUVycm9yKGUpOwogICAgfQogIH0KCiAgcXVldWUubGVuZ3RoID0gMDsKfTsKCnZhciBjb25zdW1lVGltZW91dCA9IGZ1bmN0aW9uIChxdWV1ZSwgdGltZW91dCkgewogIHZhciBpID0gMDsKICB2YXIgdHMgPSAwOwoKICB3aGlsZSAoaSA8IHF1ZXVlLmxlbmd0aCAmJiAodHMgPSBwZXJmb3JtYW5jZS5ub3coKSkgPCB0aW1lb3V0KSB7CiAgICB0cnkgewogICAgICBxdWV1ZVtpKytdKHRzKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgY29uc29sZUVycm9yKGUpOwogICAgfQogIH0KCiAgaWYgKGkgPT09IHF1ZXVlLmxlbmd0aCkgewogICAgcXVldWUubGVuZ3RoID0gMDsKICB9IGVsc2UgaWYgKGkgIT09IDApIHsKICAgIHF1ZXVlLnNwbGljZSgwLCBpKTsKICB9Cn07Cgp2YXIgZmx1c2ggPSBmdW5jdGlvbiAoKSB7CiAgcXVldWVDb25nZXN0aW9uKys7IC8vIGFsd2F5cyBmb3JjZSBhIGJ1bmNoIG9mIG1lZGl1bSBjYWxsYmFja3MgdG8gcnVuLCBidXQgc3RpbGwgaGF2ZQogIC8vIGEgdGhyb3R0bGUgb24gaG93IG1hbnkgY2FuIHJ1biBpbiBhIGNlcnRhaW4gdGltZQogIC8vIERPTSBSRUFEUyEhIQoKICBjb25zdW1lKHF1ZXVlRG9tUmVhZHMpOwogIHZhciB0aW1lb3V0ID0gKHBsdC4kZmxhZ3MkICYgNgogIC8qIHF1ZXVlTWFzayAqLwogICkgPT09IDIKICAvKiBhcHBMb2FkZWQgKi8KICA/IHBlcmZvcm1hbmNlLm5vdygpICsgMTAgKiBNYXRoLmNlaWwocXVldWVDb25nZXN0aW9uICogKDEuMCAvIDIyLjApKSA6IEluZmluaXR5OyAvLyBET00gV1JJVEVTISEhCgogIGNvbnN1bWVUaW1lb3V0KHF1ZXVlRG9tV3JpdGVzLCB0aW1lb3V0KTsKICBjb25zdW1lVGltZW91dChxdWV1ZURvbVdyaXRlc0xvdywgdGltZW91dCk7CgogIGlmIChxdWV1ZURvbVdyaXRlcy5sZW5ndGggPiAwKSB7CiAgICBxdWV1ZURvbVdyaXRlc0xvdy5wdXNoLmFwcGx5KHF1ZXVlRG9tV3JpdGVzTG93LCBxdWV1ZURvbVdyaXRlcyk7CiAgICBxdWV1ZURvbVdyaXRlcy5sZW5ndGggPSAwOwogIH0KCiAgaWYgKHF1ZXVlUGVuZGluZyA9IHF1ZXVlRG9tUmVhZHMubGVuZ3RoICsgcXVldWVEb21Xcml0ZXMubGVuZ3RoICsgcXVldWVEb21Xcml0ZXNMb3cubGVuZ3RoID4gMCkgewogICAgLy8gc3RpbGwgbW9yZSB0byBkbyB5ZXQsIGJ1dCB3ZSd2ZSBydW4gb3V0IG9mIHRpbWUKICAgIC8vIGxldCdzIGxldCB0aGlzIHRoaW5nIGNvb2wgb2ZmIGFuZCB0cnkgYWdhaW4gaW4gdGhlIG5leHQgdGljawogICAgcGx0LnJhZihmbHVzaCk7CiAgfSBlbHNlIHsKICAgIHF1ZXVlQ29uZ2VzdGlvbiA9IDA7CiAgfQp9OwoKdmFyIG5leHRUaWNrID0KLypAX19QVVJFX18qLwpmdW5jdGlvbiAoY2IpIHsKICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCkudGhlbihjYik7Cn07Cgp2YXIgd3JpdGVUYXNrID0KLypAX19QVVJFX18qLwpxdWV1ZVRhc2socXVldWVEb21Xcml0ZXMsIHRydWUpOwovKioKICogRGVmYXVsdCBzdHlsZSBtb2RlIGlkCiAqLwoKLyoqCiAqIFJldXNhYmxlIGVtcHR5IG9iai9hcnJheQogKiBEb24ndCBhZGQgdmFsdWVzIHRvIHRoZXNlISEKICovCgp2YXIgRU1QVFlfT0JKID0ge307Cgp2YXIgaXNDb21wbGV4VHlwZSA9IGZ1bmN0aW9uIChvKSB7CiAgLy8gaHR0cHM6Ly9qc3BlcmYuY29tL3R5cGVvZi1mbi1vYmplY3QvNQogIG8gPSB0eXBlb2YgbzsKICByZXR1cm4gbyA9PT0gJ29iamVjdCcgfHwgbyA9PT0gJ2Z1bmN0aW9uJzsKfTsKCnZhciBnZXREeW5hbWljSW1wb3J0RnVuY3Rpb24gPSBmdW5jdGlvbiAobmFtZXNwYWNlKSB7CiAgcmV0dXJuICJfX3NjX2ltcG9ydF8iICsgbmFtZXNwYWNlLnJlcGxhY2UoL1xzfC0vZywgJ18nKTsKfTsKCnZhciBwYXRjaEVzbSA9IGZ1bmN0aW9uICgpIHsKICAvLyBAdHMtaWdub3JlCiAgaWYgKCEod2luLkNTUyAmJiB3aW4uQ1NTLnN1cHBvcnRzICYmIHdpbi5DU1Muc3VwcG9ydHMoJ2NvbG9yJywgJ3ZhcigtLWMpJykpKSB7CiAgICAvLyBAdHMtaWdub3JlCiAgICByZXR1cm4gaW1wb3J0KCcuL2Nzcy1zaGltLTZhYWY3MTNkLTliMTM4MTZhLmpzJykudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgIHBsdC4kY3NzU2hpbSQgPSB3aW4uX19zdGVuY2lsX2Nzc3NoaW07CgogICAgICBpZiAocGx0LiRjc3NTaGltJCkgewogICAgICAgIHJldHVybiBwbHQuJGNzc1NoaW0kLmluaXRTaGltKCk7CiAgICAgIH0KICAgIH0pOwogIH0KCiAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSgpOwp9OwoKdmFyIHBhdGNoQnJvd3NlciA9IGZ1bmN0aW9uICgpIHsKICB7CiAgICAvLyBzaGltIGNzcyB2YXJzCiAgICBwbHQuJGNzc1NoaW0kID0gd2luLl9fc3RlbmNpbF9jc3NzaGltOwogIH0gLy8gQHRzLWlnbm9yZQoKICB2YXIgc2NyaXB0RWxtID0gQXJyYXkuZnJvbShkb2MucXVlcnlTZWxlY3RvckFsbCgnc2NyaXB0JykpLmZpbmQoZnVuY3Rpb24gKHMpIHsKICAgIHJldHVybiBuZXcgUmVnRXhwKCIvIiArIE5BTUVTUEFDRSArICIoXFwuZXNtKT9cXC5qcygkfFxcP3wjKSIpLnRlc3Qocy5zcmMpIHx8IHMuZ2V0QXR0cmlidXRlKCdkYXRhLXN0ZW5jaWwtbmFtZXNwYWNlJykgPT09IE5BTUVTUEFDRTsKICB9KTsKICB2YXIgb3B0cyA9IHNjcmlwdEVsbVsnZGF0YS1vcHRzJ10gfHwge307CiAgdmFyIGltcG9ydE1ldGEgPSAiIjsKCiAgaWYgKCdvbmJlZm9yZWxvYWQnIGluIHNjcmlwdEVsbSAmJiAhaGlzdG9yeS5zY3JvbGxSZXN0b3JhdGlvbiAmJiBmYWxzZQogIC8qIElTX1NZU1RFTV9KU19CVUlMRCAqLwogICkgewogICAgICAvLyBTYWZhcmkgPCB2MTEgc3VwcG9ydDogVGhpcyBJRiBpcyB0cnVlIGlmIGl0J3MgU2FmYXJpIGJlbG93IHYxMS4KICAgICAgLy8gVGhpcyBmbiBjYW5ub3QgdXNlIGFzeW5jL2F3YWl0IHNpbmNlIFNhZmFyaSBkaWRuJ3Qgc3VwcG9ydCBpdCB1bnRpbCB2MTEsCiAgICAgIC8vIGhvd2V2ZXIsIFNhZmFyaSAxMCBkaWQgc3VwcG9ydCBtb2R1bGVzLiBTYWZhcmkgMTAgYWxzbyBkaWRuJ3Qgc3VwcG9ydCAibm9tb2R1bGUiLAogICAgICAvLyBzbyBib3RoIHRoZSBFU00gZmlsZSBhbmQgbm9tb2R1bGUgZmlsZSB3b3VsZCBnZXQgZG93bmxvYWRlZC4gT25seSBTYWZhcmkKICAgICAgLy8gaGFzICdvbmJlZm9yZWxvYWQnIGluIHRoZSBzY3JpcHQsIGFuZCAiaGlzdG9yeS5zY3JvbGxSZXN0b3JhdGlvbiIgd2FzIGFkZGVkCiAgICAgIC8vIHRvIFNhZmFyaSBpbiB2MTEuIFJldHVybiBhIG5vb3AgdGhlbigpIHNvIHRoZSBhc3luYy9hd2FpdCBFU00gY29kZSBkb2Vzbid0IGNvbnRpbnVlLgogICAgICAvLyBJU19FU01fQlVJTEQgaXMgcmVwbGFjZWQgYXQgYnVpbGQgdGltZSBzbyB0aGlzIGNoZWNrIGRvZXNuJ3QgaGFwcGVuIGluIHN5c3RlbWpzIGJ1aWxkcy4KICAgICAgcmV0dXJuIHsKICAgICAgICB0aGVuOiBmdW5jdGlvbiAoKSB7fQogICAgICB9OwogICAgfQoKICBpZiAoaW1wb3J0TWV0YSAhPT0gJycpIHsKICAgIG9wdHMucmVzb3VyY2VzVXJsID0gbmV3IFVSTCgnLicsIGltcG9ydE1ldGEpLmhyZWY7CiAgfSBlbHNlIHsKICAgIG9wdHMucmVzb3VyY2VzVXJsID0gbmV3IFVSTCgnLicsIG5ldyBVUkwoc2NyaXB0RWxtLmdldEF0dHJpYnV0ZSgnZGF0YS1yZXNvdXJjZXMtdXJsJykgfHwgc2NyaXB0RWxtLnNyYywgd2luLmxvY2F0aW9uLmhyZWYpKS5ocmVmOwogICAgcGF0Y2hEeW5hbWljSW1wb3J0KG9wdHMucmVzb3VyY2VzVXJsLCBzY3JpcHRFbG0pOwoKICAgIGlmICghd2luZG93LmN1c3RvbUVsZW1lbnRzKSB7CiAgICAgIC8vIG1vZHVsZSBzdXBwb3J0LCBidXQgbm8gY3VzdG9tIGVsZW1lbnRzIHN1cHBvcnQgKE9sZCBFZGdlKQogICAgICAvLyBAdHMtaWdub3JlCiAgICAgIHJldHVybiBpbXBvcnQoJy4vZG9tLTc2Y2M3YzdkLTBhMDgyODk1LmpzJykudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIG9wdHM7CiAgICAgIH0pOwogICAgfQogIH0KCiAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShvcHRzKTsKfTsKCnZhciBwYXRjaER5bmFtaWNJbXBvcnQgPSBmdW5jdGlvbiAoYmFzZSwgb3JnU2NyaXB0RWxtKSB7CiAgdmFyIGltcG9ydEZ1bmN0aW9uTmFtZSA9IGdldER5bmFtaWNJbXBvcnRGdW5jdGlvbihOQU1FU1BBQ0UpOwoKICB0cnkgewogICAgLy8gdGVzdCBpZiB0aGlzIGJyb3dzZXIgc3VwcG9ydHMgZHluYW1pYyBpbXBvcnRzCiAgICAvLyBUaGVyZSBpcyBhIGNhY2hpbmcgaXNzdWUgaW4gVjgsIHRoYXQgYnJlYWtzIHVzaW5nIGltcG9ydCgpIGluIEZ1bmN0aW9uCiAgICAvLyBCeSBnZW5lcmF0aW5nIGEgcmFuZG9tIHN0cmluZywgd2UgY2FuIHdvcmthcm91bmQgaXQKICAgIC8vIENoZWNrIGh0dHBzOi8vYnVncy5jaHJvbWl1bS5vcmcvcC92OC9pc3N1ZXMvZGV0YWlsP2lkPTk1NTggZm9yIG1vcmUgaW5mbwogICAgd2luW2ltcG9ydEZ1bmN0aW9uTmFtZV0gPSBuZXcgRnVuY3Rpb24oJ3cnLCAicmV0dXJuIGltcG9ydCh3KTsvLyIgKyBNYXRoLnJhbmRvbSgpKTsKICB9IGNhdGNoIChlKSB7CiAgICAvLyB0aGlzIHNoaW0gaXMgc3BlY2lmaWNhbGx5IGZvciBicm93c2VycyB0aGF0IGRvIHN1cHBvcnQgImVzbSIgaW1wb3J0cwogICAgLy8gaG93ZXZlciwgdGhleSBkbyBOT1Qgc3VwcG9ydCAiZHluYW1pYyIgaW1wb3J0cwogICAgLy8gYmFzaWNhbGx5IHRoaXMgY29kZSBpcyBmb3Igb2xkIEVkZ2UsIHYxOCBhbmQgYmVsb3cKICAgIHZhciBtb2R1bGVNYXBfMSA9IG5ldyBNYXAoKTsKCiAgICB3aW5baW1wb3J0RnVuY3Rpb25OYW1lXSA9IGZ1bmN0aW9uIChzcmMpIHsKICAgICAgdmFyIHVybCA9IG5ldyBVUkwoc3JjLCBiYXNlKS5ocmVmOwogICAgICB2YXIgbW9kID0gbW9kdWxlTWFwXzEuZ2V0KHVybCk7CgogICAgICBpZiAoIW1vZCkgewogICAgICAgIHZhciBzY3JpcHRfMSA9IGRvYy5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTsKICAgICAgICBzY3JpcHRfMS50eXBlID0gJ21vZHVsZSc7CiAgICAgICAgc2NyaXB0XzEuY3Jvc3NPcmlnaW4gPSBvcmdTY3JpcHRFbG0uY3Jvc3NPcmlnaW47CiAgICAgICAgc2NyaXB0XzEuc3JjID0gVVJMLmNyZWF0ZU9iamVjdFVSTChuZXcgQmxvYihbImltcG9ydCAqIGFzIG0gZnJvbSAnIiArIHVybCArICInOyB3aW5kb3cuIiArIGltcG9ydEZ1bmN0aW9uTmFtZSArICIubSA9IG07Il0sIHsKICAgICAgICAgIHR5cGU6ICdhcHBsaWNhdGlvbi9qYXZhc2NyaXB0JwogICAgICAgIH0pKTsKICAgICAgICBtb2QgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgICAgc2NyaXB0XzEub25sb2FkID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXNvbHZlKHdpbltpbXBvcnRGdW5jdGlvbk5hbWVdLm0pOwogICAgICAgICAgICBzY3JpcHRfMS5yZW1vdmUoKTsKICAgICAgICAgIH07CiAgICAgICAgfSk7CiAgICAgICAgbW9kdWxlTWFwXzEuc2V0KHVybCwgbW9kKTsKICAgICAgICBkb2MuaGVhZC5hcHBlbmRDaGlsZChzY3JpcHRfMSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBtb2Q7CiAgICB9OwogIH0KfTsKCnZhciBwYXJzZVByb3BlcnR5VmFsdWUgPSBmdW5jdGlvbiAocHJvcFZhbHVlLCBwcm9wVHlwZSkgewogIC8vIGVuc3VyZSB0aGlzIHZhbHVlIGlzIG9mIHRoZSBjb3JyZWN0IHByb3AgdHlwZQogIGlmIChwcm9wVmFsdWUgIT0gbnVsbCAmJiAhaXNDb21wbGV4VHlwZShwcm9wVmFsdWUpKSB7CiAgICBpZiAocHJvcFR5cGUgJiAxCiAgICAvKiBTdHJpbmcgKi8KICAgICkgewogICAgICAgIC8vIGNvdWxkIGhhdmUgYmVlbiBwYXNzZWQgYXMgYSBudW1iZXIgb3IgYm9vbGVhbgogICAgICAgIC8vIGJ1dCB3ZSBzdGlsbCB3YW50IGl0IGFzIGEgc3RyaW5nCiAgICAgICAgcmV0dXJuIFN0cmluZyhwcm9wVmFsdWUpOwogICAgICB9IC8vIHJlZHVuZGFudCByZXR1cm4gaGVyZSBmb3IgYmV0dGVyIG1pbmlmaWNhdGlvbgoKCiAgICByZXR1cm4gcHJvcFZhbHVlOwogIH0gLy8gbm90IHN1cmUgZXhhY3RseSB3aGF0IHR5cGUgd2Ugd2FudAogIC8vIHNvIG5vIG5lZWQgdG8gY2hhbmdlIHRvIGEgZGlmZmVyZW50IHR5cGUKCgogIHJldHVybiBwcm9wVmFsdWU7Cn07Cgp2YXIgSFlEUkFURURfQ0xBU1MgPSAnaHlkcmF0ZWQnOwoKdmFyIGNyZWF0ZVRpbWUgPSBmdW5jdGlvbiAoZm5OYW1lLCB0YWdOYW1lKSB7CiAgaWYgKHRhZ05hbWUgPT09IHZvaWQgMCkgewogICAgdGFnTmFtZSA9ICcnOwogIH0KCiAgewogICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuOwogICAgfTsKICB9Cn07Cgp2YXIgdW5pcXVlVGltZSA9IGZ1bmN0aW9uIChrZXksIG1lYXN1cmVUZXh0KSB7CiAgewogICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuOwogICAgfTsKICB9Cn07Cgp2YXIgcm9vdEFwcGxpZWRTdHlsZXMgPSBuZXcgV2Vha01hcCgpOwoKdmFyIHJlZ2lzdGVyU3R5bGUgPSBmdW5jdGlvbiAoc2NvcGVJZCwgY3NzVGV4dCwgYWxsb3dDUykgewogIHZhciBzdHlsZSA9IHN0eWxlcy5nZXQoc2NvcGVJZCk7CgogIGlmIChzdXBwb3J0c0NvbnN0cnVjdGlibGVTdHlsZXNoZWV0cyAmJiBhbGxvd0NTKSB7CiAgICBzdHlsZSA9IHN0eWxlIHx8IG5ldyBDU1NTdHlsZVNoZWV0KCk7CiAgICBzdHlsZS5yZXBsYWNlKGNzc1RleHQpOwogIH0gZWxzZSB7CiAgICBzdHlsZSA9IGNzc1RleHQ7CiAgfQoKICBzdHlsZXMuc2V0KHNjb3BlSWQsIHN0eWxlKTsKfTsKCnZhciBhZGRTdHlsZSA9IGZ1bmN0aW9uIChzdHlsZUNvbnRhaW5lck5vZGUsIGNtcE1ldGEsIG1vZGUsIGhvc3RFbG0pIHsKICB2YXIgc2NvcGVJZCA9IGdldFNjb3BlSWQoY21wTWV0YS4kdGFnTmFtZSQpOwogIHZhciBzdHlsZSA9IHN0eWxlcy5nZXQoc2NvcGVJZCk7IC8vIGlmIGFuIGVsZW1lbnQgaXMgTk9UIGNvbm5lY3RlZCB0aGVuIGdldFJvb3ROb2RlKCkgd2lsbCByZXR1cm4gdGhlIHdyb25nIHJvb3Qgbm9kZQogIC8vIHNvIHRoZSBmYWxsYmFjayBpcyB0byBhbHdheXMgdXNlIHRoZSBkb2N1bWVudCBmb3IgdGhlIHJvb3Qgbm9kZSBpbiB0aG9zZSBjYXNlcwoKICBzdHlsZUNvbnRhaW5lck5vZGUgPSBzdHlsZUNvbnRhaW5lck5vZGUubm9kZVR5cGUgPT09IDExCiAgLyogRG9jdW1lbnRGcmFnbWVudCAqLwogID8gc3R5bGVDb250YWluZXJOb2RlIDogZG9jOwoKICBpZiAoc3R5bGUpIHsKICAgIGlmICh0eXBlb2Ygc3R5bGUgPT09ICdzdHJpbmcnKSB7CiAgICAgIHN0eWxlQ29udGFpbmVyTm9kZSA9IHN0eWxlQ29udGFpbmVyTm9kZS5oZWFkIHx8IHN0eWxlQ29udGFpbmVyTm9kZTsKICAgICAgdmFyIGFwcGxpZWRTdHlsZXMgPSByb290QXBwbGllZFN0eWxlcy5nZXQoc3R5bGVDb250YWluZXJOb2RlKTsKICAgICAgdmFyIHN0eWxlRWxtID0gdm9pZCAwOwoKICAgICAgaWYgKCFhcHBsaWVkU3R5bGVzKSB7CiAgICAgICAgcm9vdEFwcGxpZWRTdHlsZXMuc2V0KHN0eWxlQ29udGFpbmVyTm9kZSwgYXBwbGllZFN0eWxlcyA9IG5ldyBTZXQoKSk7CiAgICAgIH0KCiAgICAgIGlmICghYXBwbGllZFN0eWxlcy5oYXMoc2NvcGVJZCkpIHsKICAgICAgICB7CiAgICAgICAgICBpZiAocGx0LiRjc3NTaGltJCkgewogICAgICAgICAgICBzdHlsZUVsbSA9IHBsdC4kY3NzU2hpbSQuY3JlYXRlSG9zdFN0eWxlKGhvc3RFbG0sIHNjb3BlSWQsIHN0eWxlLCAhIShjbXBNZXRhLiRmbGFncyQgJiAxMAogICAgICAgICAgICAvKiBuZWVkc1Njb3BlZEVuY2Fwc3VsYXRpb24gKi8KICAgICAgICAgICAgKSk7CiAgICAgICAgICAgIHZhciBuZXdTY29wZUlkID0gc3R5bGVFbG1bJ3Mtc2MnXTsKCiAgICAgICAgICAgIGlmIChuZXdTY29wZUlkKSB7CiAgICAgICAgICAgICAgc2NvcGVJZCA9IG5ld1Njb3BlSWQ7IC8vIHdlIGRvbid0IHdhbnQgdG8gYWRkIHRoaXMgc3R5bGVJRCB0byB0aGUgYXBwbGllZFN0eWxlcyBTZXQKICAgICAgICAgICAgICAvLyBzaW5jZSB0aGUgY3NzVmFyU2hpbSBtaWdodCBuZWVkIHRvIGFwcGx5IHNldmVyYWwgZGlmZmVyZW50CiAgICAgICAgICAgICAgLy8gc3R5bGVzaGVldHMgZm9yIHRoZSBzYW1lIGNvbXBvbmVudAoKICAgICAgICAgICAgICBhcHBsaWVkU3R5bGVzID0gbnVsbDsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3R5bGVFbG0gPSBkb2MuY3JlYXRlRWxlbWVudCgnc3R5bGUnKTsKICAgICAgICAgICAgc3R5bGVFbG0uaW5uZXJIVE1MID0gc3R5bGU7CiAgICAgICAgICB9CgogICAgICAgICAgc3R5bGVDb250YWluZXJOb2RlLmluc2VydEJlZm9yZShzdHlsZUVsbSwgc3R5bGVDb250YWluZXJOb2RlLnF1ZXJ5U2VsZWN0b3IoJ2xpbmsnKSk7CiAgICAgICAgfQoKICAgICAgICBpZiAoYXBwbGllZFN0eWxlcykgewogICAgICAgICAgYXBwbGllZFN0eWxlcy5hZGQoc2NvcGVJZCk7CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgaWYgKCFzdHlsZUNvbnRhaW5lck5vZGUuYWRvcHRlZFN0eWxlU2hlZXRzLmluY2x1ZGVzKHN0eWxlKSkgewogICAgICBzdHlsZUNvbnRhaW5lck5vZGUuYWRvcHRlZFN0eWxlU2hlZXRzID0gX19zcHJlYWRBcnJheXMoc3R5bGVDb250YWluZXJOb2RlLmFkb3B0ZWRTdHlsZVNoZWV0cywgW3N0eWxlXSk7CiAgICB9CiAgfQoKICByZXR1cm4gc2NvcGVJZDsKfTsKCnZhciBhdHRhY2hTdHlsZXMgPSBmdW5jdGlvbiAoZWxtLCBjbXBNZXRhLCBtb2RlKSB7CiAgdmFyIGVuZEF0dGFjaFN0eWxlcyA9IGNyZWF0ZVRpbWUoJ2F0dGFjaFN0eWxlcycsIGNtcE1ldGEuJHRhZ05hbWUkKTsKICB2YXIgc2NvcGVJZCA9IGFkZFN0eWxlKGVsbS5nZXRSb290Tm9kZSgpLCBjbXBNZXRhLCBtb2RlLCBlbG0pOwogIGVuZEF0dGFjaFN0eWxlcygpOwp9OwoKdmFyIGdldFNjb3BlSWQgPSBmdW5jdGlvbiAodGFnTmFtZSwgbW9kZSkgewogIHJldHVybiAnc2MtJyArIHRhZ05hbWU7Cn07Ci8qKgogKiBQcm9kdWN0aW9uIGgoKSBmdW5jdGlvbiBiYXNlZCBvbiBQcmVhY3QgYnkKICogSmFzb24gTWlsbGVyIChAZGV2ZWxvcGl0KQogKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UKICogaHR0cHM6Ly9naXRodWIuY29tL2RldmVsb3BpdC9wcmVhY3QvYmxvYi9tYXN0ZXIvTElDRU5TRQogKgogKiBNb2RpZmllZCBmb3IgU3RlbmNpbCdzIGNvbXBpbGVyIGFuZCB2ZG9tCiAqLwovLyBjb25zdCBzdGFjazogYW55W10gPSBbXTsKLy8gZXhwb3J0IGZ1bmN0aW9uIGgobm9kZU5hbWU6IHN0cmluZyB8IGQuRnVuY3Rpb25hbENvbXBvbmVudCwgdm5vZGVEYXRhOiBkLlByb3BzVHlwZSwgY2hpbGQ/OiBkLkNoaWxkVHlwZSk6IGQuVk5vZGU7Ci8vIGV4cG9ydCBmdW5jdGlvbiBoKG5vZGVOYW1lOiBzdHJpbmcgfCBkLkZ1bmN0aW9uYWxDb21wb25lbnQsIHZub2RlRGF0YTogZC5Qcm9wc1R5cGUsIC4uLmNoaWxkcmVuOiBkLkNoaWxkVHlwZVtdKTogZC5WTm9kZTsKCgp2YXIgaCA9IGZ1bmN0aW9uIChub2RlTmFtZSwgdm5vZGVEYXRhKSB7CiAgdmFyIGNoaWxkcmVuID0gW107CgogIGZvciAodmFyIF9pID0gMjsgX2kgPCBhcmd1bWVudHMubGVuZ3RoOyBfaSsrKSB7CiAgICBjaGlsZHJlbltfaSAtIDJdID0gYXJndW1lbnRzW19pXTsKICB9CgogIHZhciBjaGlsZCA9IG51bGw7CiAgdmFyIHNsb3ROYW1lID0gbnVsbDsKICB2YXIgc2ltcGxlID0gZmFsc2U7CiAgdmFyIGxhc3RTaW1wbGUgPSBmYWxzZTsKICB2YXIgdk5vZGVDaGlsZHJlbiA9IFtdOwoKICB2YXIgd2FsayA9IGZ1bmN0aW9uIChjKSB7CiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGMubGVuZ3RoOyBpKyspIHsKICAgICAgY2hpbGQgPSBjW2ldOwoKICAgICAgaWYgKEFycmF5LmlzQXJyYXkoY2hpbGQpKSB7CiAgICAgICAgd2FsayhjaGlsZCk7CiAgICAgIH0gZWxzZSBpZiAoY2hpbGQgIT0gbnVsbCAmJiB0eXBlb2YgY2hpbGQgIT09ICdib29sZWFuJykgewogICAgICAgIGlmIChzaW1wbGUgPSB0eXBlb2Ygbm9kZU5hbWUgIT09ICdmdW5jdGlvbicgJiYgIWlzQ29tcGxleFR5cGUoY2hpbGQpKSB7CiAgICAgICAgICBjaGlsZCA9IFN0cmluZyhjaGlsZCk7CiAgICAgICAgfQoKICAgICAgICBpZiAoc2ltcGxlICYmIGxhc3RTaW1wbGUpIHsKICAgICAgICAgIC8vIElmIHRoZSBwcmV2aW91cyBjaGlsZCB3YXMgc2ltcGxlIChzdHJpbmcpLCB3ZSBtZXJnZSBib3RoCiAgICAgICAgICB2Tm9kZUNoaWxkcmVuW3ZOb2RlQ2hpbGRyZW4ubGVuZ3RoIC0gMV0uJHRleHQkICs9IGNoaWxkOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBBcHBlbmQgYSBuZXcgdk5vZGUsIGlmIGl0J3MgdGV4dCwgd2UgY3JlYXRlIGEgdGV4dCB2Tm9kZQogICAgICAgICAgdk5vZGVDaGlsZHJlbi5wdXNoKHNpbXBsZSA/IG5ld1ZOb2RlKG51bGwsIGNoaWxkKSA6IGNoaWxkKTsKICAgICAgICB9CgogICAgICAgIGxhc3RTaW1wbGUgPSBzaW1wbGU7CiAgICAgIH0KICAgIH0KICB9OwoKICB3YWxrKGNoaWxkcmVuKTsKCiAgaWYgKHZub2RlRGF0YSkgewogICAgaWYgKHZub2RlRGF0YS5uYW1lKSB7CiAgICAgIHNsb3ROYW1lID0gdm5vZGVEYXRhLm5hbWU7CiAgICB9CgogICAgewogICAgICB2YXIgY2xhc3NEYXRhXzEgPSB2bm9kZURhdGEuY2xhc3NOYW1lIHx8IHZub2RlRGF0YS5jbGFzczsKCiAgICAgIGlmIChjbGFzc0RhdGFfMSkgewogICAgICAgIHZub2RlRGF0YS5jbGFzcyA9IHR5cGVvZiBjbGFzc0RhdGFfMSAhPT0gJ29iamVjdCcgPyBjbGFzc0RhdGFfMSA6IE9iamVjdC5rZXlzKGNsYXNzRGF0YV8xKS5maWx0ZXIoZnVuY3Rpb24gKGspIHsKICAgICAgICAgIHJldHVybiBjbGFzc0RhdGFfMVtrXTsKICAgICAgICB9KS5qb2luKCcgJyk7CiAgICAgIH0KICAgIH0KICB9CgogIHZhciB2bm9kZSA9IG5ld1ZOb2RlKG5vZGVOYW1lLCBudWxsKTsKICB2bm9kZS4kYXR0cnMkID0gdm5vZGVEYXRhOwoKICBpZiAodk5vZGVDaGlsZHJlbi5sZW5ndGggPiAwKSB7CiAgICB2bm9kZS4kY2hpbGRyZW4kID0gdk5vZGVDaGlsZHJlbjsKICB9CgogIHsKICAgIHZub2RlLiRuYW1lJCA9IHNsb3ROYW1lOwogIH0KICByZXR1cm4gdm5vZGU7Cn07Cgp2YXIgbmV3Vk5vZGUgPSBmdW5jdGlvbiAodGFnLCB0ZXh0KSB7CiAgdmFyIHZub2RlID0gewogICAgJGZsYWdzJDogMCwKICAgICR0YWckOiB0YWcsCiAgICAkdGV4dCQ6IHRleHQsCiAgICAkZWxtJDogbnVsbCwKICAgICRjaGlsZHJlbiQ6IG51bGwKICB9OwogIHsKICAgIHZub2RlLiRhdHRycyQgPSBudWxsOwogIH0KICB7CiAgICB2bm9kZS4kbmFtZSQgPSBudWxsOwogIH0KICByZXR1cm4gdm5vZGU7Cn07Cgp2YXIgSG9zdCA9IHt9OwoKdmFyIGlzSG9zdCA9IGZ1bmN0aW9uIChub2RlKSB7CiAgcmV0dXJuIG5vZGUgJiYgbm9kZS4kdGFnJCA9PT0gSG9zdDsKfTsKLyoqCiAqIFByb2R1Y3Rpb24gc2V0QWNjZXNzb3IoKSBmdW5jdGlvbiBiYXNlZCBvbiBQcmVhY3QgYnkKICogSmFzb24gTWlsbGVyIChAZGV2ZWxvcGl0KQogKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UKICogaHR0cHM6Ly9naXRodWIuY29tL2RldmVsb3BpdC9wcmVhY3QvYmxvYi9tYXN0ZXIvTElDRU5TRQogKgogKiBNb2RpZmllZCBmb3IgU3RlbmNpbCdzIGNvbXBpbGVyIGFuZCB2ZG9tCiAqLwoKCnZhciBzZXRBY2Nlc3NvciA9IGZ1bmN0aW9uIChlbG0sIG1lbWJlck5hbWUsIG9sZFZhbHVlLCBuZXdWYWx1ZSwgaXNTdmcsIGZsYWdzKSB7CiAgaWYgKG9sZFZhbHVlID09PSBuZXdWYWx1ZSkgewogICAgcmV0dXJuOwogIH0KCiAgdmFyIGlzUHJvcCA9IGlzTWVtYmVySW5FbGVtZW50KGVsbSwgbWVtYmVyTmFtZSk7CiAgdmFyIGxuID0gbWVtYmVyTmFtZS50b0xvd2VyQ2FzZSgpOwoKICBpZiAobWVtYmVyTmFtZSA9PT0gJ2NsYXNzJykgewogICAgdmFyIGNsYXNzTGlzdCA9IGVsbS5jbGFzc0xpc3Q7CiAgICB2YXIgb2xkQ2xhc3Nlc18xID0gcGFyc2VDbGFzc0xpc3Qob2xkVmFsdWUpOwogICAgdmFyIG5ld0NsYXNzZXNfMSA9IHBhcnNlQ2xhc3NMaXN0KG5ld1ZhbHVlKTsKICAgIGNsYXNzTGlzdC5yZW1vdmUuYXBwbHkoY2xhc3NMaXN0LCBvbGRDbGFzc2VzXzEuZmlsdGVyKGZ1bmN0aW9uIChjKSB7CiAgICAgIHJldHVybiBjICYmICFuZXdDbGFzc2VzXzEuaW5jbHVkZXMoYyk7CiAgICB9KSk7CiAgICBjbGFzc0xpc3QuYWRkLmFwcGx5KGNsYXNzTGlzdCwgbmV3Q2xhc3Nlc18xLmZpbHRlcihmdW5jdGlvbiAoYykgewogICAgICByZXR1cm4gYyAmJiAhb2xkQ2xhc3Nlc18xLmluY2x1ZGVzKGMpOwogICAgfSkpOwogIH0gZWxzZSBpZiAoIWlzUHJvcCAmJiBtZW1iZXJOYW1lWzBdID09PSAnbycgJiYgbWVtYmVyTmFtZVsxXSA9PT0gJ24nKSB7CiAgICAvLyBFdmVudCBIYW5kbGVycwogICAgLy8gc28gaWYgdGhlIG1lbWJlciBuYW1lIHN0YXJ0cyB3aXRoICJvbiIgYW5kIHRoZSAzcmQgY2hhcmFjdGVycyBpcwogICAgLy8gYSBjYXBpdGFsIGxldHRlciwgYW5kIGl0J3Mgbm90IGFscmVhZHkgYSBtZW1iZXIgb24gdGhlIGVsZW1lbnQsCiAgICAvLyB0aGVuIHdlJ3JlIGFzc3VtaW5nIGl0J3MgYW4gZXZlbnQgbGlzdGVuZXIKICAgIGlmIChtZW1iZXJOYW1lWzJdID09PSAnLScpIHsKICAgICAgLy8gb24tIHByZWZpeGVkIGV2ZW50cwogICAgICAvLyBhbGxvd3MgdG8gYmUgZXhwbGljaXQgYWJvdXQgdGhlIGRvbSBldmVudCB0byBsaXN0ZW4gd2l0aG91dCBhbnkgbWFnaWMKICAgICAgLy8gdW5kZXIgdGhlIGhvb2Q6CiAgICAgIC8vIDxteS1jbXAgb24tY2xpY2s+IC8vIGxpc3RlbnMgZm9yICJjbGljayIKICAgICAgLy8gPG15LWNtcCBvbi1DbGljaz4gLy8gbGlzdGVucyBmb3IgIkNsaWNrIgogICAgICAvLyA8bXktY21wIG9uLWlvbkNoYW5nZT4gLy8gbGlzdGVucyBmb3IgImlvbkNoYW5nZSIKICAgICAgLy8gPG15LWNtcCBvbi1FVkVOVFM+IC8vIGxpc3RlbnMgZm9yICJFVkVOVFMiCiAgICAgIG1lbWJlck5hbWUgPSBtZW1iZXJOYW1lLnNsaWNlKDMpOwogICAgfSBlbHNlIGlmIChpc01lbWJlckluRWxlbWVudCh3aW4sIGxuKSkgewogICAgICAvLyBzdGFuZGFyZCBldmVudAogICAgICAvLyB0aGUgSlNYIGF0dHJpYnV0ZSBjb3VsZCBoYXZlIGJlZW4gIm9uTW91c2VPdmVyIiBhbmQgdGhlCiAgICAgIC8vIG1lbWJlciBuYW1lICJvbm1vdXNlb3ZlciIgaXMgb24gdGhlIHdpbmRvdydzIHByb3RvdHlwZQogICAgICAvLyBzbyBsZXQncyBhZGQgdGhlIGxpc3RlbmVyICJtb3VzZW92ZXIiLCB3aGljaCBpcyBhbGwgbG93ZXJjYXNlZAogICAgICBtZW1iZXJOYW1lID0gbG4uc2xpY2UoMik7CiAgICB9IGVsc2UgewogICAgICAvLyBjdXN0b20gZXZlbnQKICAgICAgLy8gdGhlIEpTWCBhdHRyaWJ1dGUgY291bGQgaGF2ZSBiZWVuICJvbk15Q3VzdG9tRXZlbnQiCiAgICAgIC8vIHNvIGxldCdzIHRyaW0gb2ZmIHRoZSAib24iIHByZWZpeCBhbmQgbG93ZXJjYXNlIHRoZSBmaXJzdCBjaGFyYWN0ZXIKICAgICAgLy8gYW5kIGFkZCB0aGUgbGlzdGVuZXIgIm15Q3VzdG9tRXZlbnQiCiAgICAgIC8vIGV4Y2VwdCBmb3IgdGhlIGZpcnN0IGNoYXJhY3Rlciwgd2Uga2VlcCB0aGUgZXZlbnQgbmFtZSBjYXNlCiAgICAgIG1lbWJlck5hbWUgPSBsblsyXSArIG1lbWJlck5hbWUuc2xpY2UoMyk7CiAgICB9CgogICAgaWYgKG9sZFZhbHVlKSB7CiAgICAgIHBsdC5yZWwoZWxtLCBtZW1iZXJOYW1lLCBvbGRWYWx1ZSwgZmFsc2UpOwogICAgfQoKICAgIGlmIChuZXdWYWx1ZSkgewogICAgICBwbHQuYWVsKGVsbSwgbWVtYmVyTmFtZSwgbmV3VmFsdWUsIGZhbHNlKTsKICAgIH0KICB9IGVsc2UgewogICAgLy8gU2V0IHByb3BlcnR5IGlmIGl0IGV4aXN0cyBhbmQgaXQncyBub3QgYSBTVkcKICAgIHZhciBpc0NvbXBsZXggPSBpc0NvbXBsZXhUeXBlKG5ld1ZhbHVlKTsKCiAgICBpZiAoKGlzUHJvcCB8fCBpc0NvbXBsZXggJiYgbmV3VmFsdWUgIT09IG51bGwpICYmICFpc1N2ZykgewogICAgICB0cnkgewogICAgICAgIGlmICghZWxtLnRhZ05hbWUuaW5jbHVkZXMoJy0nKSkgewogICAgICAgICAgdmFyIG4gPSBuZXdWYWx1ZSA9PSBudWxsID8gJycgOiBuZXdWYWx1ZTsgLy8gV29ya2Fyb3VuZCBmb3IgU2FmYXJpLCBtb3ZpbmcgdGhlIDxpbnB1dD4gY2FyZXQgd2hlbiByZS1hc3NpZ25pbmcgdGhlIHNhbWUgdmFsdWVkCgogICAgICAgICAgaWYgKG1lbWJlck5hbWUgPT09ICdsaXN0JykgewogICAgICAgICAgICBpc1Byb3AgPSBmYWxzZTsgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOiB0cmlwbGUtZXF1YWxzCiAgICAgICAgICB9IGVsc2UgaWYgKG9sZFZhbHVlID09IG51bGwgfHwgZWxtW21lbWJlck5hbWVdICE9IG4pIHsKICAgICAgICAgICAgZWxtW21lbWJlck5hbWVdID0gbjsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgZWxtW21lbWJlck5hbWVdID0gbmV3VmFsdWU7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlKSB7fQogICAgfQoKICAgIGlmIChuZXdWYWx1ZSA9PSBudWxsIHx8IG5ld1ZhbHVlID09PSBmYWxzZSkgewogICAgICB7CiAgICAgICAgZWxtLnJlbW92ZUF0dHJpYnV0ZShtZW1iZXJOYW1lKTsKICAgICAgfQogICAgfSBlbHNlIGlmICgoIWlzUHJvcCB8fCBmbGFncyAmIDQKICAgIC8qIGlzSG9zdCAqLwogICAgfHwgaXNTdmcpICYmICFpc0NvbXBsZXgpIHsKICAgICAgbmV3VmFsdWUgPSBuZXdWYWx1ZSA9PT0gdHJ1ZSA/ICcnIDogbmV3VmFsdWU7CiAgICAgIHsKICAgICAgICBlbG0uc2V0QXR0cmlidXRlKG1lbWJlck5hbWUsIG5ld1ZhbHVlKTsKICAgICAgfQogICAgfQogIH0KfTsKCnZhciBwYXJzZUNsYXNzTGlzdFJlZ2V4ID0gL1xzLzsKCnZhciBwYXJzZUNsYXNzTGlzdCA9IGZ1bmN0aW9uICh2YWx1ZSkgewogIHJldHVybiAhdmFsdWUgPyBbXSA6IHZhbHVlLnNwbGl0KHBhcnNlQ2xhc3NMaXN0UmVnZXgpOwp9OwoKdmFyIHVwZGF0ZUVsZW1lbnQgPSBmdW5jdGlvbiAob2xkVm5vZGUsIG5ld1Zub2RlLCBpc1N2Z01vZGUsIG1lbWJlck5hbWUpIHsKICAvLyBpZiB0aGUgZWxlbWVudCBwYXNzZWQgaW4gaXMgYSBzaGFkb3cgcm9vdCwgd2hpY2ggaXMgYSBkb2N1bWVudCBmcmFnbWVudAogIC8vIHRoZW4gd2Ugd2FudCB0byBiZSBhZGRpbmcgYXR0cnMvcHJvcHMgdG8gdGhlIHNoYWRvdyByb290J3MgImhvc3QiIGVsZW1lbnQKICAvLyBpZiBpdCdzIG5vdCBhIHNoYWRvdyByb290LCB0aGVuIHdlIGFkZCBhdHRycy9wcm9wcyB0byB0aGUgc2FtZSBlbGVtZW50CiAgdmFyIGVsbSA9IG5ld1Zub2RlLiRlbG0kLm5vZGVUeXBlID09PSAxMQogIC8qIERvY3VtZW50RnJhZ21lbnQgKi8KICAmJiBuZXdWbm9kZS4kZWxtJC5ob3N0ID8gbmV3Vm5vZGUuJGVsbSQuaG9zdCA6IG5ld1Zub2RlLiRlbG0kOwogIHZhciBvbGRWbm9kZUF0dHJzID0gb2xkVm5vZGUgJiYgb2xkVm5vZGUuJGF0dHJzJCB8fCBFTVBUWV9PQko7CiAgdmFyIG5ld1Zub2RlQXR0cnMgPSBuZXdWbm9kZS4kYXR0cnMkIHx8IEVNUFRZX09CSjsKICB7CiAgICAvLyByZW1vdmUgYXR0cmlidXRlcyBubyBsb25nZXIgcHJlc2VudCBvbiB0aGUgdm5vZGUgYnkgc2V0dGluZyB0aGVtIHRvIHVuZGVmaW5lZAogICAgZm9yIChtZW1iZXJOYW1lIGluIG9sZFZub2RlQXR0cnMpIHsKICAgICAgaWYgKCEobWVtYmVyTmFtZSBpbiBuZXdWbm9kZUF0dHJzKSkgewogICAgICAgIHNldEFjY2Vzc29yKGVsbSwgbWVtYmVyTmFtZSwgb2xkVm5vZGVBdHRyc1ttZW1iZXJOYW1lXSwgdW5kZWZpbmVkLCBpc1N2Z01vZGUsIG5ld1Zub2RlLiRmbGFncyQpOwogICAgICB9CiAgICB9CiAgfSAvLyBhZGQgbmV3ICYgdXBkYXRlIGNoYW5nZWQgYXR0cmlidXRlcwoKICBmb3IgKG1lbWJlck5hbWUgaW4gbmV3Vm5vZGVBdHRycykgewogICAgc2V0QWNjZXNzb3IoZWxtLCBtZW1iZXJOYW1lLCBvbGRWbm9kZUF0dHJzW21lbWJlck5hbWVdLCBuZXdWbm9kZUF0dHJzW21lbWJlck5hbWVdLCBpc1N2Z01vZGUsIG5ld1Zub2RlLiRmbGFncyQpOwogIH0KfTsKCnZhciBjcmVhdGVFbG0gPSBmdW5jdGlvbiAob2xkUGFyZW50Vk5vZGUsIG5ld1BhcmVudFZOb2RlLCBjaGlsZEluZGV4LCBwYXJlbnRFbG0pIHsKICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6IHByZWZlci1jb25zdAogIHZhciBuZXdWTm9kZSA9IG5ld1BhcmVudFZOb2RlLiRjaGlsZHJlbiRbY2hpbGRJbmRleF07CiAgdmFyIGkgPSAwOwogIHZhciBlbG07CiAgdmFyIGNoaWxkTm9kZTsKICB2YXIgb2xkVk5vZGU7CgogIGlmICghdXNlTmF0aXZlU2hhZG93RG9tKSB7CiAgICAvLyByZW1lbWJlciBmb3IgbGF0ZXIgd2UgbmVlZCB0byBjaGVjayB0byByZWxvY2F0ZSBub2RlcwogICAgY2hlY2tTbG90UmVsb2NhdGUgPSB0cnVlOwoKICAgIGlmIChuZXdWTm9kZS4kdGFnJCA9PT0gJ3Nsb3QnKSB7CiAgICAgIGlmIChzY29wZUlkKSB7CiAgICAgICAgLy8gc2NvcGVkIGNzcyBuZWVkcyB0byBhZGQgaXRzIHNjb3BlZCBpZCB0byB0aGUgcGFyZW50IGVsZW1lbnQKICAgICAgICBwYXJlbnRFbG0uY2xhc3NMaXN0LmFkZChzY29wZUlkICsgJy1zJyk7CiAgICAgIH0KCiAgICAgIG5ld1ZOb2RlLiRmbGFncyQgfD0gbmV3Vk5vZGUuJGNoaWxkcmVuJCA/IC8vIHNsb3QgZWxlbWVudCBoYXMgZmFsbGJhY2sgY29udGVudAogICAgICAvLyBzdGlsbCBjcmVhdGUgYW4gZWxlbWVudCB0aGF0ICJtb2NrcyIgdGhlIHNsb3QgZWxlbWVudAogICAgICAyCiAgICAgIC8qIGlzU2xvdEZhbGxiYWNrICovCiAgICAgIC8vIHNsb3QgZWxlbWVudCBkb2VzIG5vdCBoYXZlIGZhbGxiYWNrIGNvbnRlbnQKICAgICAgLy8gY3JlYXRlIGFuIGh0bWwgY29tbWVudCB3ZSdsbCB1c2UgdG8gYWx3YXlzIHJlZmVyZW5jZQogICAgICAvLyB3aGVyZSBhY3R1YWwgc2xvdCBjb250ZW50IHNob3VsZCBzaXQgbmV4dCB0bwogICAgICA6IDEKICAgICAgLyogaXNTbG90UmVmZXJlbmNlICovCiAgICAgIDsKICAgIH0KICB9CgogIGlmIChuZXdWTm9kZS4kZmxhZ3MkICYgMQogIC8qIGlzU2xvdFJlZmVyZW5jZSAqLwogICkgewogICAgICAvLyBjcmVhdGUgYSBzbG90IHJlZmVyZW5jZSBub2RlCiAgICAgIGVsbSA9IG5ld1ZOb2RlLiRlbG0kID0gZG9jLmNyZWF0ZVRleHROb2RlKCcnKTsKICAgIH0gZWxzZSB7CiAgICAvLyBjcmVhdGUgZWxlbWVudAogICAgZWxtID0gbmV3Vk5vZGUuJGVsbSQgPSBkb2MuY3JlYXRlRWxlbWVudChuZXdWTm9kZS4kZmxhZ3MkICYgMgogICAgLyogaXNTbG90RmFsbGJhY2sgKi8KICAgID8gJ3Nsb3QtZmInIDogbmV3Vk5vZGUuJHRhZyQpOyAvLyBhZGQgY3NzIGNsYXNzZXMsIGF0dHJzLCBwcm9wcywgbGlzdGVuZXJzLCBldGMuCgogICAgewogICAgICB1cGRhdGVFbGVtZW50KG51bGwsIG5ld1ZOb2RlLCBpc1N2Z01vZGUpOwogICAgfQoKICAgIGlmIChuZXdWTm9kZS4kY2hpbGRyZW4kKSB7CiAgICAgIGZvciAoaSA9IDA7IGkgPCBuZXdWTm9kZS4kY2hpbGRyZW4kLmxlbmd0aDsgKytpKSB7CiAgICAgICAgLy8gY3JlYXRlIHRoZSBub2RlCiAgICAgICAgY2hpbGROb2RlID0gY3JlYXRlRWxtKG9sZFBhcmVudFZOb2RlLCBuZXdWTm9kZSwgaSwgZWxtKTsgLy8gcmV0dXJuIG5vZGUgY291bGQgaGF2ZSBiZWVuIG51bGwKCiAgICAgICAgaWYgKGNoaWxkTm9kZSkgewogICAgICAgICAgLy8gYXBwZW5kIG91ciBuZXcgbm9kZQogICAgICAgICAgZWxtLmFwcGVuZENoaWxkKGNoaWxkTm9kZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICB7CiAgICBlbG1bJ3MtaG4nXSA9IGhvc3RUYWdOYW1lOwoKICAgIGlmIChuZXdWTm9kZS4kZmxhZ3MkICYgKDIKICAgIC8qIGlzU2xvdEZhbGxiYWNrICovCiAgICB8IDEKICAgIC8qIGlzU2xvdFJlZmVyZW5jZSAqLwogICAgKSkgewogICAgICAvLyByZW1lbWJlciB0aGUgY29udGVudCByZWZlcmVuY2UgY29tbWVudAogICAgICBlbG1bJ3Mtc3InXSA9IHRydWU7IC8vIHJlbWVtYmVyIHRoZSBjb250ZW50IHJlZmVyZW5jZSBjb21tZW50CgogICAgICBlbG1bJ3MtY3InXSA9IGNvbnRlbnRSZWY7IC8vIHJlbWVtYmVyIHRoZSBzbG90IG5hbWUsIG9yIGVtcHR5IHN0cmluZyBmb3IgZGVmYXVsdCBzbG90CgogICAgICBlbG1bJ3Mtc24nXSA9IG5ld1ZOb2RlLiRuYW1lJCB8fCAnJzsgLy8gY2hlY2sgaWYgd2UndmUgZ290IGFuIG9sZCB2bm9kZSBmb3IgdGhpcyBzbG90CgogICAgICBvbGRWTm9kZSA9IG9sZFBhcmVudFZOb2RlICYmIG9sZFBhcmVudFZOb2RlLiRjaGlsZHJlbiQgJiYgb2xkUGFyZW50Vk5vZGUuJGNoaWxkcmVuJFtjaGlsZEluZGV4XTsKCiAgICAgIGlmIChvbGRWTm9kZSAmJiBvbGRWTm9kZS4kdGFnJCA9PT0gbmV3Vk5vZGUuJHRhZyQgJiYgb2xkUGFyZW50Vk5vZGUuJGVsbSQpIHsKICAgICAgICAvLyB3ZSd2ZSBnb3QgYW4gb2xkIHNsb3Qgdm5vZGUgYW5kIHRoZSB3cmFwcGVyIGlzIGJlaW5nIHJlcGxhY2VkCiAgICAgICAgLy8gc28gbGV0J3MgbW92ZSB0aGUgb2xkIHNsb3QgY29udGVudCBiYWNrIHRvIGl0J3Mgb3JpZ2luYWwgbG9jYXRpb24KICAgICAgICBwdXRCYWNrSW5PcmlnaW5hbExvY2F0aW9uKG9sZFBhcmVudFZOb2RlLiRlbG0kLCBmYWxzZSk7CiAgICAgIH0KICAgIH0KICB9CiAgcmV0dXJuIGVsbTsKfTsKCnZhciBwdXRCYWNrSW5PcmlnaW5hbExvY2F0aW9uID0gZnVuY3Rpb24gKHBhcmVudEVsbSwgcmVjdXJzaXZlKSB7CiAgcGx0LiRmbGFncyQgfD0gMQogIC8qIGlzVG1wRGlzY29ubmVjdGVkICovCiAgOwogIHZhciBvbGRTbG90Q2hpbGROb2RlcyA9IHBhcmVudEVsbS5jaGlsZE5vZGVzOwoKICBmb3IgKHZhciBpID0gb2xkU2xvdENoaWxkTm9kZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgIHZhciBjaGlsZE5vZGUgPSBvbGRTbG90Q2hpbGROb2Rlc1tpXTsKCiAgICBpZiAoY2hpbGROb2RlWydzLWhuJ10gIT09IGhvc3RUYWdOYW1lICYmIGNoaWxkTm9kZVsncy1vbCddKSB7CiAgICAgIC8vIC8vIHRoaXMgY2hpbGQgbm9kZSBpbiB0aGUgb2xkIGVsZW1lbnQgaXMgZnJvbSBhbm90aGVyIGNvbXBvbmVudAogICAgICAvLyAvLyByZW1vdmUgdGhpcyBub2RlIGZyb20gdGhlIG9sZCBzbG90J3MgcGFyZW50CiAgICAgIC8vIGNoaWxkTm9kZS5yZW1vdmUoKTsKICAgICAgLy8gYW5kIHJlbG9jYXRlIGl0IGJhY2sgdG8gaXQncyBvcmlnaW5hbCBsb2NhdGlvbgogICAgICBwYXJlbnRSZWZlcmVuY2VOb2RlKGNoaWxkTm9kZSkuaW5zZXJ0QmVmb3JlKGNoaWxkTm9kZSwgcmVmZXJlbmNlTm9kZShjaGlsZE5vZGUpKTsgLy8gcmVtb3ZlIHRoZSBvbGQgb3JpZ2luYWwgbG9jYXRpb24gY29tbWVudCBlbnRpcmVseQogICAgICAvLyBsYXRlciBvbiB0aGUgcGF0Y2ggZnVuY3Rpb24gd2lsbCBrbm93IHdoYXQgdG8gZG8KICAgICAgLy8gYW5kIG1vdmUgdGhpcyB0byB0aGUgY29ycmVjdCBzcG90IGluIG5lZWQgYmUKCiAgICAgIGNoaWxkTm9kZVsncy1vbCddLnJlbW92ZSgpOwogICAgICBjaGlsZE5vZGVbJ3Mtb2wnXSA9IHVuZGVmaW5lZDsKICAgICAgY2hlY2tTbG90UmVsb2NhdGUgPSB0cnVlOwogICAgfQoKICAgIGlmIChyZWN1cnNpdmUpIHsKICAgICAgcHV0QmFja0luT3JpZ2luYWxMb2NhdGlvbihjaGlsZE5vZGUsIHJlY3Vyc2l2ZSk7CiAgICB9CiAgfQoKICBwbHQuJGZsYWdzJCAmPSB+MQogIC8qIGlzVG1wRGlzY29ubmVjdGVkICovCiAgOwp9OwoKdmFyIGFkZFZub2RlcyA9IGZ1bmN0aW9uIChwYXJlbnRFbG0sIGJlZm9yZSwgcGFyZW50Vk5vZGUsIHZub2Rlcywgc3RhcnRJZHgsIGVuZElkeCkgewogIHZhciBjb250YWluZXJFbG0gPSBwYXJlbnRFbG1bJ3MtY3InXSAmJiBwYXJlbnRFbG1bJ3MtY3InXS5wYXJlbnROb2RlIHx8IHBhcmVudEVsbTsKICB2YXIgY2hpbGROb2RlOwoKICBmb3IgKDsgc3RhcnRJZHggPD0gZW5kSWR4OyArK3N0YXJ0SWR4KSB7CiAgICBpZiAodm5vZGVzW3N0YXJ0SWR4XSkgewogICAgICBjaGlsZE5vZGUgPSBjcmVhdGVFbG0obnVsbCwgcGFyZW50Vk5vZGUsIHN0YXJ0SWR4LCBwYXJlbnRFbG0pOwoKICAgICAgaWYgKGNoaWxkTm9kZSkgewogICAgICAgIHZub2Rlc1tzdGFydElkeF0uJGVsbSQgPSBjaGlsZE5vZGU7CiAgICAgICAgY29udGFpbmVyRWxtLmluc2VydEJlZm9yZShjaGlsZE5vZGUsIHJlZmVyZW5jZU5vZGUoYmVmb3JlKSk7CiAgICAgIH0KICAgIH0KICB9Cn07Cgp2YXIgcmVtb3ZlVm5vZGVzID0gZnVuY3Rpb24gKHZub2Rlcywgc3RhcnRJZHgsIGVuZElkeCwgdm5vZGUsIGVsbSkgewogIGZvciAoOyBzdGFydElkeCA8PSBlbmRJZHg7ICsrc3RhcnRJZHgpIHsKICAgIGlmICh2bm9kZSA9IHZub2Rlc1tzdGFydElkeF0pIHsKICAgICAgZWxtID0gdm5vZGUuJGVsbSQ7CiAgICAgIHsKICAgICAgICAvLyB3ZSdyZSByZW1vdmluZyB0aGlzIGVsZW1lbnQKICAgICAgICAvLyBzbyBpdCdzIHBvc3NpYmxlIHdlIG5lZWQgdG8gc2hvdyBzbG90IGZhbGxiYWNrIGNvbnRlbnQgbm93CiAgICAgICAgY2hlY2tTbG90RmFsbGJhY2tWaXNpYmlsaXR5ID0gdHJ1ZTsKCiAgICAgICAgaWYgKGVsbVsncy1vbCddKSB7CiAgICAgICAgICAvLyByZW1vdmUgdGhlIG9yaWdpbmFsIGxvY2F0aW9uIGNvbW1lbnQKICAgICAgICAgIGVsbVsncy1vbCddLnJlbW92ZSgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBpdCdzIHBvc3NpYmxlIHRoYXQgY2hpbGQgbm9kZXMgb2YgdGhlIG5vZGUKICAgICAgICAgIC8vIHRoYXQncyBiZWluZyByZW1vdmVkIGFyZSBzbG90IG5vZGVzCiAgICAgICAgICBwdXRCYWNrSW5PcmlnaW5hbExvY2F0aW9uKGVsbSwgdHJ1ZSk7CiAgICAgICAgfQogICAgICB9IC8vIHJlbW92ZSB0aGUgdm5vZGUncyBlbGVtZW50IGZyb20gdGhlIGRvbQoKICAgICAgZWxtLnJlbW92ZSgpOwogICAgfQogIH0KfTsKCnZhciB1cGRhdGVDaGlsZHJlbiA9IGZ1bmN0aW9uIChwYXJlbnRFbG0sIG9sZENoLCBuZXdWTm9kZSwgbmV3Q2gpIHsKICB2YXIgb2xkU3RhcnRJZHggPSAwOwogIHZhciBuZXdTdGFydElkeCA9IDA7CiAgdmFyIG9sZEVuZElkeCA9IG9sZENoLmxlbmd0aCAtIDE7CiAgdmFyIG9sZFN0YXJ0Vm5vZGUgPSBvbGRDaFswXTsKICB2YXIgb2xkRW5kVm5vZGUgPSBvbGRDaFtvbGRFbmRJZHhdOwogIHZhciBuZXdFbmRJZHggPSBuZXdDaC5sZW5ndGggLSAxOwogIHZhciBuZXdTdGFydFZub2RlID0gbmV3Q2hbMF07CiAgdmFyIG5ld0VuZFZub2RlID0gbmV3Q2hbbmV3RW5kSWR4XTsKICB2YXIgbm9kZTsKCiAgd2hpbGUgKG9sZFN0YXJ0SWR4IDw9IG9sZEVuZElkeCAmJiBuZXdTdGFydElkeCA8PSBuZXdFbmRJZHgpIHsKICAgIGlmIChvbGRTdGFydFZub2RlID09IG51bGwpIHsKICAgICAgLy8gVm5vZGUgbWlnaHQgaGF2ZSBiZWVuIG1vdmVkIGxlZnQKICAgICAgb2xkU3RhcnRWbm9kZSA9IG9sZENoWysrb2xkU3RhcnRJZHhdOwogICAgfSBlbHNlIGlmIChvbGRFbmRWbm9kZSA9PSBudWxsKSB7CiAgICAgIG9sZEVuZFZub2RlID0gb2xkQ2hbLS1vbGRFbmRJZHhdOwogICAgfSBlbHNlIGlmIChuZXdTdGFydFZub2RlID09IG51bGwpIHsKICAgICAgbmV3U3RhcnRWbm9kZSA9IG5ld0NoWysrbmV3U3RhcnRJZHhdOwogICAgfSBlbHNlIGlmIChuZXdFbmRWbm9kZSA9PSBudWxsKSB7CiAgICAgIG5ld0VuZFZub2RlID0gbmV3Q2hbLS1uZXdFbmRJZHhdOwogICAgfSBlbHNlIGlmIChpc1NhbWVWbm9kZShvbGRTdGFydFZub2RlLCBuZXdTdGFydFZub2RlKSkgewogICAgICBwYXRjaChvbGRTdGFydFZub2RlLCBuZXdTdGFydFZub2RlKTsKICAgICAgb2xkU3RhcnRWbm9kZSA9IG9sZENoWysrb2xkU3RhcnRJZHhdOwogICAgICBuZXdTdGFydFZub2RlID0gbmV3Q2hbKytuZXdTdGFydElkeF07CiAgICB9IGVsc2UgaWYgKGlzU2FtZVZub2RlKG9sZEVuZFZub2RlLCBuZXdFbmRWbm9kZSkpIHsKICAgICAgcGF0Y2gob2xkRW5kVm5vZGUsIG5ld0VuZFZub2RlKTsKICAgICAgb2xkRW5kVm5vZGUgPSBvbGRDaFstLW9sZEVuZElkeF07CiAgICAgIG5ld0VuZFZub2RlID0gbmV3Q2hbLS1uZXdFbmRJZHhdOwogICAgfSBlbHNlIGlmIChpc1NhbWVWbm9kZShvbGRTdGFydFZub2RlLCBuZXdFbmRWbm9kZSkpIHsKICAgICAgLy8gVm5vZGUgbW92ZWQgcmlnaHQKICAgICAgaWYgKG9sZFN0YXJ0Vm5vZGUuJHRhZyQgPT09ICdzbG90JyB8fCBuZXdFbmRWbm9kZS4kdGFnJCA9PT0gJ3Nsb3QnKSB7CiAgICAgICAgcHV0QmFja0luT3JpZ2luYWxMb2NhdGlvbihvbGRTdGFydFZub2RlLiRlbG0kLnBhcmVudE5vZGUsIGZhbHNlKTsKICAgICAgfQoKICAgICAgcGF0Y2gob2xkU3RhcnRWbm9kZSwgbmV3RW5kVm5vZGUpOwogICAgICBwYXJlbnRFbG0uaW5zZXJ0QmVmb3JlKG9sZFN0YXJ0Vm5vZGUuJGVsbSQsIG9sZEVuZFZub2RlLiRlbG0kLm5leHRTaWJsaW5nKTsKICAgICAgb2xkU3RhcnRWbm9kZSA9IG9sZENoWysrb2xkU3RhcnRJZHhdOwogICAgICBuZXdFbmRWbm9kZSA9IG5ld0NoWy0tbmV3RW5kSWR4XTsKICAgIH0gZWxzZSBpZiAoaXNTYW1lVm5vZGUob2xkRW5kVm5vZGUsIG5ld1N0YXJ0Vm5vZGUpKSB7CiAgICAgIC8vIFZub2RlIG1vdmVkIGxlZnQKICAgICAgaWYgKG9sZFN0YXJ0Vm5vZGUuJHRhZyQgPT09ICdzbG90JyB8fCBuZXdFbmRWbm9kZS4kdGFnJCA9PT0gJ3Nsb3QnKSB7CiAgICAgICAgcHV0QmFja0luT3JpZ2luYWxMb2NhdGlvbihvbGRFbmRWbm9kZS4kZWxtJC5wYXJlbnROb2RlLCBmYWxzZSk7CiAgICAgIH0KCiAgICAgIHBhdGNoKG9sZEVuZFZub2RlLCBuZXdTdGFydFZub2RlKTsKICAgICAgcGFyZW50RWxtLmluc2VydEJlZm9yZShvbGRFbmRWbm9kZS4kZWxtJCwgb2xkU3RhcnRWbm9kZS4kZWxtJCk7CiAgICAgIG9sZEVuZFZub2RlID0gb2xkQ2hbLS1vbGRFbmRJZHhdOwogICAgICBuZXdTdGFydFZub2RlID0gbmV3Q2hbKytuZXdTdGFydElkeF07CiAgICB9IGVsc2UgewogICAgICB7CiAgICAgICAgLy8gbmV3IGVsZW1lbnQKICAgICAgICBub2RlID0gY3JlYXRlRWxtKG9sZENoICYmIG9sZENoW25ld1N0YXJ0SWR4XSwgbmV3Vk5vZGUsIG5ld1N0YXJ0SWR4LCBwYXJlbnRFbG0pOwogICAgICAgIG5ld1N0YXJ0Vm5vZGUgPSBuZXdDaFsrK25ld1N0YXJ0SWR4XTsKICAgICAgfQoKICAgICAgaWYgKG5vZGUpIHsKICAgICAgICB7CiAgICAgICAgICBwYXJlbnRSZWZlcmVuY2VOb2RlKG9sZFN0YXJ0Vm5vZGUuJGVsbSQpLmluc2VydEJlZm9yZShub2RlLCByZWZlcmVuY2VOb2RlKG9sZFN0YXJ0Vm5vZGUuJGVsbSQpKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CgogIGlmIChvbGRTdGFydElkeCA+IG9sZEVuZElkeCkgewogICAgYWRkVm5vZGVzKHBhcmVudEVsbSwgbmV3Q2hbbmV3RW5kSWR4ICsgMV0gPT0gbnVsbCA/IG51bGwgOiBuZXdDaFtuZXdFbmRJZHggKyAxXS4kZWxtJCwgbmV3Vk5vZGUsIG5ld0NoLCBuZXdTdGFydElkeCwgbmV3RW5kSWR4KTsKICB9IGVsc2UgaWYgKG5ld1N0YXJ0SWR4ID4gbmV3RW5kSWR4KSB7CiAgICByZW1vdmVWbm9kZXMob2xkQ2gsIG9sZFN0YXJ0SWR4LCBvbGRFbmRJZHgpOwogIH0KfTsKCnZhciBpc1NhbWVWbm9kZSA9IGZ1bmN0aW9uICh2bm9kZTEsIHZub2RlMikgewogIC8vIGNvbXBhcmUgaWYgdHdvIHZub2RlIHRvIHNlZSBpZiB0aGV5J3JlICJ0ZWNobmljYWxseSIgdGhlIHNhbWUKICAvLyBuZWVkIHRvIGhhdmUgdGhlIHNhbWUgZWxlbWVudCB0YWcsIGFuZCBzYW1lIGtleSB0byBiZSB0aGUgc2FtZQogIGlmICh2bm9kZTEuJHRhZyQgPT09IHZub2RlMi4kdGFnJCkgewogICAgaWYgKHZub2RlMS4kdGFnJCA9PT0gJ3Nsb3QnKSB7CiAgICAgIHJldHVybiB2bm9kZTEuJG5hbWUkID09PSB2bm9kZTIuJG5hbWUkOwogICAgfQoKICAgIHJldHVybiB0cnVlOwogIH0KCiAgcmV0dXJuIGZhbHNlOwp9OwoKdmFyIHJlZmVyZW5jZU5vZGUgPSBmdW5jdGlvbiAobm9kZSkgewogIC8vIHRoaXMgbm9kZSB3YXMgcmVsb2NhdGVkIHRvIGEgbmV3IGxvY2F0aW9uIGluIHRoZSBkb20KICAvLyBiZWNhdXNlIG9mIHNvbWUgb3RoZXIgY29tcG9uZW50J3Mgc2xvdAogIC8vIGJ1dCB3ZSBzdGlsbCBoYXZlIGFuIGh0bWwgY29tbWVudCBpbiBwbGFjZSBvZiB3aGVyZQogIC8vIGl0J3Mgb3JpZ2luYWwgbG9jYXRpb24gd2FzIGFjY29yZGluZyB0byBpdCdzIG9yaWdpbmFsIHZkb20KICByZXR1cm4gbm9kZSAmJiBub2RlWydzLW9sJ10gfHwgbm9kZTsKfTsKCnZhciBwYXJlbnRSZWZlcmVuY2VOb2RlID0gZnVuY3Rpb24gKG5vZGUpIHsKICByZXR1cm4gKG5vZGVbJ3Mtb2wnXSA/IG5vZGVbJ3Mtb2wnXSA6IG5vZGUpLnBhcmVudE5vZGU7Cn07Cgp2YXIgcGF0Y2ggPSBmdW5jdGlvbiAob2xkVk5vZGUsIG5ld1ZOb2RlKSB7CiAgdmFyIGVsbSA9IG5ld1ZOb2RlLiRlbG0kID0gb2xkVk5vZGUuJGVsbSQ7CiAgdmFyIG9sZENoaWxkcmVuID0gb2xkVk5vZGUuJGNoaWxkcmVuJDsKICB2YXIgbmV3Q2hpbGRyZW4gPSBuZXdWTm9kZS4kY2hpbGRyZW4kOwogIHsKICAgIC8vIGVsZW1lbnQgbm9kZQogICAgewogICAgICBpZiAobmV3Vk5vZGUuJHRhZyQgPT09ICdzbG90JykgO2Vsc2UgewogICAgICAgIC8vIGVpdGhlciB0aGlzIGlzIHRoZSBmaXJzdCByZW5kZXIgb2YgYW4gZWxlbWVudCBPUiBpdCdzIGFuIHVwZGF0ZQogICAgICAgIC8vIEFORCB3ZSBhbHJlYWR5IGtub3cgaXQncyBwb3NzaWJsZSBpdCBjb3VsZCBoYXZlIGNoYW5nZWQKICAgICAgICAvLyB0aGlzIHVwZGF0ZXMgdGhlIGVsZW1lbnQncyBjc3MgY2xhc3NlcywgYXR0cnMsIHByb3BzLCBsaXN0ZW5lcnMsIGV0Yy4KICAgICAgICB1cGRhdGVFbGVtZW50KG9sZFZOb2RlLCBuZXdWTm9kZSwgaXNTdmdNb2RlKTsKICAgICAgfQogICAgfQoKICAgIGlmIChvbGRDaGlsZHJlbiAhPT0gbnVsbCAmJiBuZXdDaGlsZHJlbiAhPT0gbnVsbCkgewogICAgICAvLyBsb29rcyBsaWtlIHRoZXJlJ3MgY2hpbGQgdm5vZGVzIGZvciBib3RoIHRoZSBvbGQgYW5kIG5ldyB2bm9kZXMKICAgICAgdXBkYXRlQ2hpbGRyZW4oZWxtLCBvbGRDaGlsZHJlbiwgbmV3Vk5vZGUsIG5ld0NoaWxkcmVuKTsKICAgIH0gZWxzZSBpZiAobmV3Q2hpbGRyZW4gIT09IG51bGwpIHsKICAgICAgLy8gYWRkIHRoZSBuZXcgdm5vZGUgY2hpbGRyZW4KICAgICAgYWRkVm5vZGVzKGVsbSwgbnVsbCwgbmV3Vk5vZGUsIG5ld0NoaWxkcmVuLCAwLCBuZXdDaGlsZHJlbi5sZW5ndGggLSAxKTsKICAgIH0gZWxzZSBpZiAob2xkQ2hpbGRyZW4gIT09IG51bGwpIHsKICAgICAgLy8gbm8gbmV3IGNoaWxkIHZub2RlcywgYnV0IHRoZXJlIGFyZSBvbGQgY2hpbGQgdm5vZGVzIHRvIHJlbW92ZQogICAgICByZW1vdmVWbm9kZXMob2xkQ2hpbGRyZW4sIDAsIG9sZENoaWxkcmVuLmxlbmd0aCAtIDEpOwogICAgfQogIH0KfTsKCnZhciB1cGRhdGVGYWxsYmFja1Nsb3RWaXNpYmlsaXR5ID0gZnVuY3Rpb24gKGVsbSkgewogIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTogcHJlZmVyLWNvbnN0CiAgdmFyIGNoaWxkTm9kZXMgPSBlbG0uY2hpbGROb2RlczsKICB2YXIgY2hpbGROb2RlOwogIHZhciBpOwogIHZhciBpbGVuOwogIHZhciBqOwogIHZhciBzbG90TmFtZUF0dHI7CiAgdmFyIG5vZGVUeXBlOwoKICBmb3IgKGkgPSAwLCBpbGVuID0gY2hpbGROb2Rlcy5sZW5ndGg7IGkgPCBpbGVuOyBpKyspIHsKICAgIGNoaWxkTm9kZSA9IGNoaWxkTm9kZXNbaV07CgogICAgaWYgKGNoaWxkTm9kZS5ub2RlVHlwZSA9PT0gMQogICAgLyogRWxlbWVudE5vZGUgKi8KICAgICkgewogICAgICAgIGlmIChjaGlsZE5vZGVbJ3Mtc3InXSkgewogICAgICAgICAgLy8gdGhpcyBpcyBhIHNsb3QgZmFsbGJhY2sgbm9kZQogICAgICAgICAgLy8gZ2V0IHRoZSBzbG90IG5hbWUgZm9yIHRoaXMgc2xvdCByZWZlcmVuY2Ugbm9kZQogICAgICAgICAgc2xvdE5hbWVBdHRyID0gY2hpbGROb2RlWydzLXNuJ107IC8vIGJ5IGRlZmF1bHQgYWx3YXlzIHNob3cgYSBmYWxsYmFjayBzbG90IG5vZGUKICAgICAgICAgIC8vIHRoZW4gaGlkZSBpdCBpZiB0aGVyZSBhcmUgb3RoZXIgc2xvdHMgaW4gdGhlIGxpZ2h0IGRvbQoKICAgICAgICAgIGNoaWxkTm9kZS5oaWRkZW4gPSBmYWxzZTsKCiAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgaWxlbjsgaisrKSB7CiAgICAgICAgICAgIGlmIChjaGlsZE5vZGVzW2pdWydzLWhuJ10gIT09IGNoaWxkTm9kZVsncy1obiddKSB7CiAgICAgICAgICAgICAgLy8gdGhpcyBzaWJsaW5nIG5vZGUgaXMgZnJvbSBhIGRpZmZlcmVudCBjb21wb25lbnQKICAgICAgICAgICAgICBub2RlVHlwZSA9IGNoaWxkTm9kZXNbal0ubm9kZVR5cGU7CgogICAgICAgICAgICAgIGlmIChzbG90TmFtZUF0dHIgIT09ICcnKSB7CiAgICAgICAgICAgICAgICAvLyB0aGlzIGlzIGEgbmFtZWQgZmFsbGJhY2sgc2xvdCBub2RlCiAgICAgICAgICAgICAgICBpZiAobm9kZVR5cGUgPT09IDEKICAgICAgICAgICAgICAgIC8qIEVsZW1lbnROb2RlICovCiAgICAgICAgICAgICAgICAmJiBzbG90TmFtZUF0dHIgPT09IGNoaWxkTm9kZXNbal0uZ2V0QXR0cmlidXRlKCdzbG90JykpIHsKICAgICAgICAgICAgICAgICAgY2hpbGROb2RlLmhpZGRlbiA9IHRydWU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAvLyB0aGlzIGlzIGEgZGVmYXVsdCBmYWxsYmFjayBzbG90IG5vZGUKICAgICAgICAgICAgICAgIC8vIGFueSBlbGVtZW50IG9yIHRleHQgbm9kZSAod2l0aCBjb250ZW50KQogICAgICAgICAgICAgICAgLy8gc2hvdWxkIGhpZGUgdGhlIGRlZmF1bHQgZmFsbGJhY2sgc2xvdCBub2RlCiAgICAgICAgICAgICAgICBpZiAobm9kZVR5cGUgPT09IDEKICAgICAgICAgICAgICAgIC8qIEVsZW1lbnROb2RlICovCiAgICAgICAgICAgICAgICB8fCBub2RlVHlwZSA9PT0gMwogICAgICAgICAgICAgICAgLyogVGV4dE5vZGUgKi8KICAgICAgICAgICAgICAgICYmIGNoaWxkTm9kZXNbal0udGV4dENvbnRlbnQudHJpbSgpICE9PSAnJykgewogICAgICAgICAgICAgICAgICBjaGlsZE5vZGUuaGlkZGVuID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSAvLyBrZWVwIGRyaWxsaW5nIGRvd24KCgogICAgICAgIHVwZGF0ZUZhbGxiYWNrU2xvdFZpc2liaWxpdHkoY2hpbGROb2RlKTsKICAgICAgfQogIH0KfTsKCnZhciByZWxvY2F0ZU5vZGVzID0gW107Cgp2YXIgcmVsb2NhdGVTbG90Q29udGVudCA9IGZ1bmN0aW9uIChlbG0pIHsKICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6IHByZWZlci1jb25zdAogIHZhciBjaGlsZE5vZGVzID0gZWxtLmNoaWxkTm9kZXM7CiAgdmFyIGlsZW4gPSBjaGlsZE5vZGVzLmxlbmd0aDsKICB2YXIgaSA9IDA7CiAgdmFyIGogPSAwOwogIHZhciBub2RlVHlwZSA9IDA7CiAgdmFyIGNoaWxkTm9kZTsKICB2YXIgbm9kZTsKICB2YXIgaG9zdENvbnRlbnROb2RlczsKICB2YXIgc2xvdE5hbWVBdHRyOwoKICBmb3IgKGlsZW4gPSBjaGlsZE5vZGVzLmxlbmd0aDsgaSA8IGlsZW47IGkrKykgewogICAgY2hpbGROb2RlID0gY2hpbGROb2Rlc1tpXTsKCiAgICBpZiAoY2hpbGROb2RlWydzLXNyJ10gJiYgKG5vZGUgPSBjaGlsZE5vZGVbJ3MtY3InXSkpIHsKICAgICAgLy8gZmlyc3QgZ290IHRoZSBjb250ZW50IHJlZmVyZW5jZSBjb21tZW50IG5vZGUKICAgICAgLy8gdGhlbiB3ZSBnb3QgaXQncyBwYXJlbnQsIHdoaWNoIGlzIHdoZXJlIGFsbCB0aGUgaG9zdCBjb250ZW50IGlzIGluIG5vdwogICAgICBob3N0Q29udGVudE5vZGVzID0gbm9kZS5wYXJlbnROb2RlLmNoaWxkTm9kZXM7CiAgICAgIHNsb3ROYW1lQXR0ciA9IGNoaWxkTm9kZVsncy1zbiddOwoKICAgICAgZm9yIChqID0gaG9zdENvbnRlbnROb2Rlcy5sZW5ndGggLSAxOyBqID49IDA7IGotLSkgewogICAgICAgIG5vZGUgPSBob3N0Q29udGVudE5vZGVzW2pdOwoKICAgICAgICBpZiAoIW5vZGVbJ3MtY24nXSAmJiAhbm9kZVsncy1uciddICYmIG5vZGVbJ3MtaG4nXSAhPT0gY2hpbGROb2RlWydzLWhuJ10pIHsKICAgICAgICAgIC8vIGxldCdzIGRvIHNvbWUgcmVsb2NhdGluZyB0byBpdHMgbmV3IGhvbWUKICAgICAgICAgIC8vIGJ1dCBuZXZlciByZWxvY2F0ZSBhIGNvbnRlbnQgcmVmZXJlbmNlIG5vZGUKICAgICAgICAgIC8vIHRoYXQgaXMgc3VwcG9zZSB0byBhbHdheXMgcmVwcmVzZW50IHRoZSBvcmlnaW5hbCBjb250ZW50IGxvY2F0aW9uCiAgICAgICAgICBub2RlVHlwZSA9IG5vZGUubm9kZVR5cGU7CgogICAgICAgICAgaWYgKChub2RlVHlwZSA9PT0gMwogICAgICAgICAgLyogVGV4dE5vZGUgKi8KICAgICAgICAgIHx8IG5vZGVUeXBlID09PSA4CiAgICAgICAgICAvKiBDb21tZW50Tm9kZSAqLwogICAgICAgICAgKSAmJiBzbG90TmFtZUF0dHIgPT09ICcnIHx8IG5vZGVUeXBlID09PSAxCiAgICAgICAgICAvKiBFbGVtZW50Tm9kZSAqLwogICAgICAgICAgJiYgbm9kZS5nZXRBdHRyaWJ1dGUoJ3Nsb3QnKSA9PT0gbnVsbCAmJiBzbG90TmFtZUF0dHIgPT09ICcnIHx8IG5vZGVUeXBlID09PSAxCiAgICAgICAgICAvKiBFbGVtZW50Tm9kZSAqLwogICAgICAgICAgJiYgbm9kZS5nZXRBdHRyaWJ1dGUoJ3Nsb3QnKSA9PT0gc2xvdE5hbWVBdHRyKSB7CiAgICAgICAgICAgIC8vIGl0J3MgcG9zc2libGUgd2UndmUgYWxyZWFkeSBkZWNpZGVkIHRvIHJlbG9jYXRlIHRoaXMgbm9kZQogICAgICAgICAgICBpZiAoIXJlbG9jYXRlTm9kZXMuc29tZShmdW5jdGlvbiAocikgewogICAgICAgICAgICAgIHJldHVybiByLiRub2RlVG9SZWxvY2F0ZSQgPT09IG5vZGU7CiAgICAgICAgICAgIH0pKSB7CiAgICAgICAgICAgICAgLy8gbWFkZSBzb21lIGNoYW5nZXMgdG8gc2xvdHMKICAgICAgICAgICAgICAvLyBsZXQncyBtYWtlIHN1cmUgd2UgYWxzbyBkb3VibGUgY2hlY2sKICAgICAgICAgICAgICAvLyBmYWxsYmFja3MgYXJlIGNvcnJlY3RseSBoaWRkZW4gb3Igc2hvd24KICAgICAgICAgICAgICBjaGVja1Nsb3RGYWxsYmFja1Zpc2liaWxpdHkgPSB0cnVlOwogICAgICAgICAgICAgIG5vZGVbJ3Mtc24nXSA9IHNsb3ROYW1lQXR0cjsgLy8gYWRkIHRvIG91ciBsaXN0IG9mIG5vZGVzIHRvIHJlbG9jYXRlCgogICAgICAgICAgICAgIHJlbG9jYXRlTm9kZXMucHVzaCh7CiAgICAgICAgICAgICAgICAkc2xvdFJlZk5vZGUkOiBjaGlsZE5vZGUsCiAgICAgICAgICAgICAgICAkbm9kZVRvUmVsb2NhdGUkOiBub2RlCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBpZiAoY2hpbGROb2RlLm5vZGVUeXBlID09PSAxCiAgICAvKiBFbGVtZW50Tm9kZSAqLwogICAgKSB7CiAgICAgICAgcmVsb2NhdGVTbG90Q29udGVudChjaGlsZE5vZGUpOwogICAgICB9CiAgfQp9OwoKdmFyIHJlbmRlclZkb20gPSBmdW5jdGlvbiAoaG9zdEVsbSwgaG9zdFJlZiwgY21wTWV0YSwgcmVuZGVyRm5SZXN1bHRzKSB7CiAgaG9zdFRhZ05hbWUgPSBob3N0RWxtLnRhZ05hbWU7CiAgdmFyIG9sZFZOb2RlID0gaG9zdFJlZi4kdm5vZGUkIHx8IG5ld1ZOb2RlKG51bGwsIG51bGwpOwogIHZhciByb290Vm5vZGUgPSBpc0hvc3QocmVuZGVyRm5SZXN1bHRzKSA/IHJlbmRlckZuUmVzdWx0cyA6IGgobnVsbCwgbnVsbCwgcmVuZGVyRm5SZXN1bHRzKTsKICByb290Vm5vZGUuJHRhZyQgPSBudWxsOwogIHJvb3RWbm9kZS4kZmxhZ3MkIHw9IDQKICAvKiBpc0hvc3QgKi8KICA7CiAgaG9zdFJlZi4kdm5vZGUkID0gcm9vdFZub2RlOwogIHJvb3RWbm9kZS4kZWxtJCA9IG9sZFZOb2RlLiRlbG0kID0gaG9zdEVsbTsKICB7CiAgICBjb250ZW50UmVmID0gaG9zdEVsbVsncy1jciddOwogICAgdXNlTmF0aXZlU2hhZG93RG9tID0gc3VwcG9ydHNTaGFkb3dEb207IC8vIGFsd2F5cyByZXNldAoKICAgIGNoZWNrU2xvdEZhbGxiYWNrVmlzaWJpbGl0eSA9IGZhbHNlOwogIH0gLy8gc3luY2hyb25vdXMgcGF0Y2gKCiAgcGF0Y2gob2xkVk5vZGUsIHJvb3RWbm9kZSk7CiAgewogICAgaWYgKGNoZWNrU2xvdFJlbG9jYXRlKSB7CiAgICAgIHJlbG9jYXRlU2xvdENvbnRlbnQocm9vdFZub2RlLiRlbG0kKTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVsb2NhdGVOb2Rlcy5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciByZWxvY2F0ZU5vZGUgPSByZWxvY2F0ZU5vZGVzW2ldOwoKICAgICAgICBpZiAoIXJlbG9jYXRlTm9kZS4kbm9kZVRvUmVsb2NhdGUkWydzLW9sJ10pIHsKICAgICAgICAgIC8vIGFkZCBhIHJlZmVyZW5jZSBub2RlIG1hcmtpbmcgdGhpcyBub2RlJ3Mgb3JpZ2luYWwgbG9jYXRpb24KICAgICAgICAgIC8vIGtlZXAgYSByZWZlcmVuY2UgdG8gdGhpcyBub2RlIGZvciBsYXRlciBsb29rdXBzCiAgICAgICAgICB2YXIgb3JnTG9jYXRpb25Ob2RlID0gZG9jLmNyZWF0ZVRleHROb2RlKCcnKTsKICAgICAgICAgIG9yZ0xvY2F0aW9uTm9kZVsncy1uciddID0gcmVsb2NhdGVOb2RlLiRub2RlVG9SZWxvY2F0ZSQ7CiAgICAgICAgICByZWxvY2F0ZU5vZGUuJG5vZGVUb1JlbG9jYXRlJC5wYXJlbnROb2RlLmluc2VydEJlZm9yZShyZWxvY2F0ZU5vZGUuJG5vZGVUb1JlbG9jYXRlJFsncy1vbCddID0gb3JnTG9jYXRpb25Ob2RlLCByZWxvY2F0ZU5vZGUuJG5vZGVUb1JlbG9jYXRlJCk7CiAgICAgICAgfQogICAgICB9IC8vIHdoaWxlIHdlJ3JlIG1vdmluZyBub2RlcyBhcm91bmQgZXhpc3Rpbmcgbm9kZXMsIHRlbXBvcmFyaWx5IGRpc2FibGUKICAgICAgLy8gdGhlIGRpc2Nvbm5lY3RDYWxsYmFjayBmcm9tIHdvcmtpbmcKCgogICAgICBwbHQuJGZsYWdzJCB8PSAxCiAgICAgIC8qIGlzVG1wRGlzY29ubmVjdGVkICovCiAgICAgIDsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVsb2NhdGVOb2Rlcy5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciByZWxvY2F0ZU5vZGUgPSByZWxvY2F0ZU5vZGVzW2ldOyAvLyBieSBkZWZhdWx0IHdlJ3JlIGp1c3QgZ29pbmcgdG8gaW5zZXJ0IGl0IGRpcmVjdGx5CiAgICAgICAgLy8gYWZ0ZXIgdGhlIHNsb3QgcmVmZXJlbmNlIG5vZGUKCiAgICAgICAgdmFyIHBhcmVudE5vZGVSZWYgPSByZWxvY2F0ZU5vZGUuJHNsb3RSZWZOb2RlJC5wYXJlbnROb2RlOwogICAgICAgIHZhciBpbnNlcnRCZWZvcmVOb2RlID0gcmVsb2NhdGVOb2RlLiRzbG90UmVmTm9kZSQubmV4dFNpYmxpbmc7CiAgICAgICAgdmFyIG9yZ0xvY2F0aW9uTm9kZSA9IHJlbG9jYXRlTm9kZS4kbm9kZVRvUmVsb2NhdGUkWydzLW9sJ107CgogICAgICAgIHdoaWxlIChvcmdMb2NhdGlvbk5vZGUgPSBvcmdMb2NhdGlvbk5vZGUucHJldmlvdXNTaWJsaW5nKSB7CiAgICAgICAgICB2YXIgcmVmTm9kZSA9IG9yZ0xvY2F0aW9uTm9kZVsncy1uciddOwoKICAgICAgICAgIGlmIChyZWZOb2RlICYmIHJlZk5vZGVbJ3Mtc24nXSA9PT0gcmVsb2NhdGVOb2RlLiRub2RlVG9SZWxvY2F0ZSRbJ3Mtc24nXSAmJiBwYXJlbnROb2RlUmVmID09PSByZWZOb2RlLnBhcmVudE5vZGUpIHsKICAgICAgICAgICAgcmVmTm9kZSA9IHJlZk5vZGUubmV4dFNpYmxpbmc7CgogICAgICAgICAgICBpZiAoIXJlZk5vZGUgfHwgIXJlZk5vZGVbJ3MtbnInXSkgewogICAgICAgICAgICAgIGluc2VydEJlZm9yZU5vZGUgPSByZWZOb2RlOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBpZiAoIWluc2VydEJlZm9yZU5vZGUgJiYgcGFyZW50Tm9kZVJlZiAhPT0gcmVsb2NhdGVOb2RlLiRub2RlVG9SZWxvY2F0ZSQucGFyZW50Tm9kZSB8fCByZWxvY2F0ZU5vZGUuJG5vZGVUb1JlbG9jYXRlJC5uZXh0U2libGluZyAhPT0gaW5zZXJ0QmVmb3JlTm9kZSkgewogICAgICAgICAgLy8gd2UndmUgY2hlY2tlZCB0aGF0IGl0J3Mgd29ydGggd2hpbGUgdG8gcmVsb2NhdGUKICAgICAgICAgIC8vIHNpbmNlIHRoYXQgdGhlIG5vZGUgdG8gcmVsb2NhdGUKICAgICAgICAgIC8vIGhhcyBhIGRpZmZlcmVudCBuZXh0IHNpYmxpbmcgb3IgcGFyZW50IHJlbG9jYXRlZAogICAgICAgICAgaWYgKHJlbG9jYXRlTm9kZS4kbm9kZVRvUmVsb2NhdGUkICE9PSBpbnNlcnRCZWZvcmVOb2RlKSB7CiAgICAgICAgICAgIC8vIGFkZCBpdCBiYWNrIHRvIHRoZSBkb20gYnV0IGluIGl0cyBuZXcgaG9tZQogICAgICAgICAgICBwYXJlbnROb2RlUmVmLmluc2VydEJlZm9yZShyZWxvY2F0ZU5vZGUuJG5vZGVUb1JlbG9jYXRlJCwgaW5zZXJ0QmVmb3JlTm9kZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vIGRvbmUgbW92aW5nIG5vZGVzIGFyb3VuZAogICAgICAvLyBhbGxvdyB0aGUgZGlzY29ubmVjdCBjYWxsYmFjayB0byB3b3JrIGFnYWluCgoKICAgICAgcGx0LiRmbGFncyQgJj0gfjEKICAgICAgLyogaXNUbXBEaXNjb25uZWN0ZWQgKi8KICAgICAgOwogICAgfQoKICAgIGlmIChjaGVja1Nsb3RGYWxsYmFja1Zpc2liaWxpdHkpIHsKICAgICAgdXBkYXRlRmFsbGJhY2tTbG90VmlzaWJpbGl0eShyb290Vm5vZGUuJGVsbSQpOwogICAgfSAvLyBhbHdheXMgcmVzZXQKCgogICAgcmVsb2NhdGVOb2Rlcy5sZW5ndGggPSAwOwogIH0KfTsKCnZhciBhdHRhY2hUb0FuY2VzdG9yID0gZnVuY3Rpb24gKGhvc3RSZWYsIGFuY2VzdG9yQ29tcG9uZW50KSB7CiAgaWYgKGFuY2VzdG9yQ29tcG9uZW50ICYmICFob3N0UmVmLiRvblJlbmRlclJlc29sdmUkKSB7CiAgICBhbmNlc3RvckNvbXBvbmVudFsncy1wJ10ucHVzaChuZXcgUHJvbWlzZShmdW5jdGlvbiAocikgewogICAgICByZXR1cm4gaG9zdFJlZi4kb25SZW5kZXJSZXNvbHZlJCA9IHI7CiAgICB9KSk7CiAgfQp9OwoKdmFyIHNjaGVkdWxlVXBkYXRlID0gZnVuY3Rpb24gKGVsbSwgaG9zdFJlZiwgY21wTWV0YSwgaXNJbml0aWFsTG9hZCkgewogIHsKICAgIGhvc3RSZWYuJGZsYWdzJCB8PSAxNgogICAgLyogaXNRdWV1ZWRGb3JVcGRhdGUgKi8KICAgIDsKICB9CgogIGlmIChob3N0UmVmLiRmbGFncyQgJiA0CiAgLyogaXNXYWl0aW5nRm9yQ2hpbGRyZW4gKi8KICApIHsKICAgICAgaG9zdFJlZi4kZmxhZ3MkIHw9IDUxMgogICAgICAvKiBuZWVkc1JlcmVuZGVyICovCiAgICAgIDsKICAgICAgcmV0dXJuOwogICAgfQoKICB2YXIgZW5kU2NoZWR1bGUgPSBjcmVhdGVUaW1lKCdzY2hlZHVsZVVwZGF0ZScsIGNtcE1ldGEuJHRhZ05hbWUkKTsKICB2YXIgYW5jZXN0b3JDb21wb25lbnQgPSBob3N0UmVmLiRhbmNlc3RvckNvbXBvbmVudCQ7CiAgdmFyIGluc3RhbmNlID0gaG9zdFJlZi4kbGF6eUluc3RhbmNlJDsKCiAgdmFyIHVwZGF0ZSA9IGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB1cGRhdGVDb21wb25lbnQoZWxtLCBob3N0UmVmLCBjbXBNZXRhLCBpbnN0YW5jZSwgaXNJbml0aWFsTG9hZCk7CiAgfTsKCiAgYXR0YWNoVG9BbmNlc3Rvcihob3N0UmVmLCBhbmNlc3RvckNvbXBvbmVudCk7CiAgdmFyIHByb21pc2U7CiAgZW5kU2NoZWR1bGUoKTsgLy8gdGhlcmUgaXMgbm8gYW5jZXN0b3JjIG9tcG9uZW50IG9yIHRoZSBhbmNlc3RvciBjb21wb25lbnQKICAvLyBoYXMgYWxyZWFkeSBmaXJlZCBvZmYgaXRzIGxpZmVjeWNsZSB1cGRhdGUgdGhlbgogIC8vIGZpcmUgb2ZmIHRoZSBpbml0aWFsIHVwZGF0ZQoKICByZXR1cm4gdGhlbihwcm9taXNlLCBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gd3JpdGVUYXNrKHVwZGF0ZSk7CiAgfSk7Cn07Cgp2YXIgdXBkYXRlQ29tcG9uZW50ID0gZnVuY3Rpb24gKGVsbSwgaG9zdFJlZiwgY21wTWV0YSwgaW5zdGFuY2UsIGlzSW5pdGlhbExvYWQpIHsKICAvLyB1cGRhdGVDb21wb25lbnQKICB2YXIgZW5kVXBkYXRlID0gY3JlYXRlVGltZSgndXBkYXRlJywgY21wTWV0YS4kdGFnTmFtZSQpOwogIHZhciByYyA9IGVsbVsncy1yYyddOwoKICBpZiAoaXNJbml0aWFsTG9hZCkgewogICAgLy8gRE9NIFdSSVRFIQogICAgYXR0YWNoU3R5bGVzKGVsbSwgY21wTWV0YSwgaG9zdFJlZi4kbW9kZU5hbWUkKTsKICB9CgogIHZhciBlbmRSZW5kZXIgPSBjcmVhdGVUaW1lKCdyZW5kZXInLCBjbXBNZXRhLiR0YWdOYW1lJCk7CiAgewogICAgewogICAgICAvLyBsb29rcyBsaWtlIHdlJ3ZlIGdvdCBjaGlsZCBub2RlcyB0byByZW5kZXIgaW50byB0aGlzIGhvc3QgZWxlbWVudAogICAgICAvLyBvciB3ZSBuZWVkIHRvIHVwZGF0ZSB0aGUgY3NzIGNsYXNzL2F0dHJzIG9uIHRoZSBob3N0IGVsZW1lbnQKICAgICAgLy8gRE9NIFdSSVRFIQogICAgICByZW5kZXJWZG9tKGVsbSwgaG9zdFJlZiwgY21wTWV0YSwgY2FsbFJlbmRlcihpbnN0YW5jZSkpOwogICAgfQogIH0KCiAgaWYgKHBsdC4kY3NzU2hpbSQpIHsKICAgIHBsdC4kY3NzU2hpbSQudXBkYXRlSG9zdChlbG0pOwogIH0KCiAgewogICAgaG9zdFJlZi4kZmxhZ3MkICY9IH4xNgogICAgLyogaXNRdWV1ZWRGb3JVcGRhdGUgKi8KICAgIDsKICB9CiAgewogICAgaG9zdFJlZi4kZmxhZ3MkIHw9IDIKICAgIC8qIGhhc1JlbmRlcmVkICovCiAgICA7CiAgfQoKICBpZiAocmMpIHsKICAgIC8vIG9rLCBzbyB0dXJucyBvdXQgdGhlcmUgYXJlIHNvbWUgY2hpbGQgaG9zdCBlbGVtZW50cwogICAgLy8gd2FpdGluZyBvbiB0aGlzIHBhcmVudCBlbGVtZW50IHRvIGxvYWQKICAgIC8vIGxldCdzIGZpcmUgb2ZmIGFsbCB1cGRhdGUgY2FsbGJhY2tzIHdhaXRpbmcKICAgIHJjLmZvckVhY2goZnVuY3Rpb24gKGNiKSB7CiAgICAgIHJldHVybiBjYigpOwogICAgfSk7CiAgICBlbG1bJ3MtcmMnXSA9IHVuZGVmaW5lZDsKICB9CgogIGVuZFJlbmRlcigpOwogIGVuZFVwZGF0ZSgpOwogIHsKICAgIHZhciBjaGlsZHJlblByb21pc2VzID0gZWxtWydzLXAnXTsKCiAgICB2YXIgcG9zdFVwZGF0ZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHBvc3RVcGRhdGVDb21wb25lbnQoZWxtLCBob3N0UmVmLCBjbXBNZXRhKTsKICAgIH07CgogICAgaWYgKGNoaWxkcmVuUHJvbWlzZXMubGVuZ3RoID09PSAwKSB7CiAgICAgIHBvc3RVcGRhdGUoKTsKICAgIH0gZWxzZSB7CiAgICAgIFByb21pc2UuYWxsKGNoaWxkcmVuUHJvbWlzZXMpLnRoZW4ocG9zdFVwZGF0ZSk7CiAgICAgIGhvc3RSZWYuJGZsYWdzJCB8PSA0CiAgICAgIC8qIGlzV2FpdGluZ0ZvckNoaWxkcmVuICovCiAgICAgIDsKICAgICAgY2hpbGRyZW5Qcm9taXNlcy5sZW5ndGggPSAwOwogICAgfQogIH0KfTsKCnZhciBjYWxsUmVuZGVyID0gZnVuY3Rpb24gKGluc3RhbmNlLCBlbG0pIHsKICB0cnkgewogICAgaW5zdGFuY2UgPSBpbnN0YW5jZS5yZW5kZXIoKTsKICB9IGNhdGNoIChlKSB7CiAgICBjb25zb2xlRXJyb3IoZSk7CiAgfQoKICByZXR1cm4gaW5zdGFuY2U7Cn07Cgp2YXIgcG9zdFVwZGF0ZUNvbXBvbmVudCA9IGZ1bmN0aW9uIChlbG0sIGhvc3RSZWYsIGNtcE1ldGEpIHsKICB2YXIgZW5kUG9zdFVwZGF0ZSA9IGNyZWF0ZVRpbWUoJ3Bvc3RVcGRhdGUnLCBjbXBNZXRhLiR0YWdOYW1lJCk7CiAgdmFyIGFuY2VzdG9yQ29tcG9uZW50ID0gaG9zdFJlZi4kYW5jZXN0b3JDb21wb25lbnQkOwoKICBpZiAoIShob3N0UmVmLiRmbGFncyQgJiA2NAogIC8qIGhhc0xvYWRlZENvbXBvbmVudCAqLwogICkpIHsKICAgIGhvc3RSZWYuJGZsYWdzJCB8PSA2NAogICAgLyogaGFzTG9hZGVkQ29tcG9uZW50ICovCiAgICA7CiAgICB7CiAgICAgIC8vIERPTSBXUklURSEKICAgICAgLy8gYWRkIHRoZSBjc3MgY2xhc3MgdGhhdCB0aGlzIGVsZW1lbnQgaGFzIG9mZmljaWFsbHkgaHlkcmF0ZWQKICAgICAgZWxtLmNsYXNzTGlzdC5hZGQoSFlEUkFURURfQ0xBU1MpOwogICAgfQogICAgZW5kUG9zdFVwZGF0ZSgpOwogICAgewogICAgICBob3N0UmVmLiRvblJlYWR5UmVzb2x2ZSQoZWxtKTsKCiAgICAgIGlmICghYW5jZXN0b3JDb21wb25lbnQpIHsKICAgICAgICBhcHBEaWRMb2FkKCk7CiAgICAgIH0KICAgIH0KICB9IGVsc2UgewogICAgZW5kUG9zdFVwZGF0ZSgpOwogIH0gLy8gbG9hZCBldmVudHMgZmlyZSBmcm9tIGJvdHRvbSB0byB0b3AKICAvLyB0aGUgZGVlcGVzdCBlbGVtZW50cyBsb2FkIGZpcnN0IHRoZW4gYnViYmxlcyB1cAoKCiAgewogICAgaWYgKGhvc3RSZWYuJG9uUmVuZGVyUmVzb2x2ZSQpIHsKICAgICAgaG9zdFJlZi4kb25SZW5kZXJSZXNvbHZlJCgpOwogICAgICBob3N0UmVmLiRvblJlbmRlclJlc29sdmUkID0gdW5kZWZpbmVkOwogICAgfQoKICAgIGlmIChob3N0UmVmLiRmbGFncyQgJiA1MTIKICAgIC8qIG5lZWRzUmVyZW5kZXIgKi8KICAgICkgewogICAgICAgIG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBzY2hlZHVsZVVwZGF0ZShlbG0sIGhvc3RSZWYsIGNtcE1ldGEsIGZhbHNlKTsKICAgICAgICB9KTsKICAgICAgfQoKICAgIGhvc3RSZWYuJGZsYWdzJCAmPSB+KDQKICAgIC8qIGlzV2FpdGluZ0ZvckNoaWxkcmVuICovCiAgICB8IDUxMgogICAgLyogbmVlZHNSZXJlbmRlciAqLwogICAgKTsKICB9IC8vICgg4oCiX+KAoikKICAvLyAoIOKAol/igKIpPuKMkOKWoC3ilqAKICAvLyAo4oyQ4pagX+KWoCkKfTsKCnZhciBmb3JjZVVwZGF0ZSA9IGZ1bmN0aW9uIChlbG0sIGNtcE1ldGEpIHsKICB7CiAgICB2YXIgaG9zdFJlZiA9IGdldEhvc3RSZWYoZWxtKTsKICAgIHZhciBpc0Nvbm5lY3RlZCA9IGhvc3RSZWYuJGhvc3RFbGVtZW50JC5pc0Nvbm5lY3RlZDsKCiAgICBpZiAoaXNDb25uZWN0ZWQgJiYgKGhvc3RSZWYuJGZsYWdzJCAmICgyCiAgICAvKiBoYXNSZW5kZXJlZCAqLwogICAgfCAxNgogICAgLyogaXNRdWV1ZWRGb3JVcGRhdGUgKi8KICAgICkpID09PSAyCiAgICAvKiBoYXNSZW5kZXJlZCAqLwogICAgKSB7CiAgICAgICAgc2NoZWR1bGVVcGRhdGUoZWxtLCBob3N0UmVmLCBjbXBNZXRhLCBmYWxzZSk7CiAgICAgIH0gLy8gUmV0dXJucyAidHJ1ZSIgd2hlbiB0aGUgZm9yY2VkIHVwZGF0ZSB3YXMgc3VjY2Vzc2Z1bGx5IHNjaGVkdWxlZAoKCiAgICByZXR1cm4gaXNDb25uZWN0ZWQ7CiAgfQp9OwoKdmFyIGFwcERpZExvYWQgPSBmdW5jdGlvbiAod2hvKSB7CiAgLy8gb24gYXBwbG9hZAogIC8vIHdlIGhhdmUgZmluaXNoIHRoZSBmaXJzdCBiaWcgaW5pdGlhbCByZW5kZXIKICB7CiAgICBkb2MuZG9jdW1lbnRFbGVtZW50LmNsYXNzTGlzdC5hZGQoSFlEUkFURURfQ0xBU1MpOwogIH0KICB7CiAgICBwbHQuJGZsYWdzJCB8PSAyCiAgICAvKiBhcHBMb2FkZWQgKi8KICAgIDsKICB9Cn07Cgp2YXIgdGhlbiA9IGZ1bmN0aW9uIChwcm9taXNlLCB0aGVuRm4pIHsKICByZXR1cm4gcHJvbWlzZSAmJiBwcm9taXNlLnRoZW4gPyBwcm9taXNlLnRoZW4odGhlbkZuKSA6IHRoZW5GbigpOwp9OwoKdmFyIGdldFZhbHVlID0gZnVuY3Rpb24gKHJlZiwgcHJvcE5hbWUpIHsKICByZXR1cm4gZ2V0SG9zdFJlZihyZWYpLiRpbnN0YW5jZVZhbHVlcyQuZ2V0KHByb3BOYW1lKTsKfTsKCnZhciBzZXRWYWx1ZSA9IGZ1bmN0aW9uIChyZWYsIHByb3BOYW1lLCBuZXdWYWwsIGNtcE1ldGEpIHsKICAvLyBjaGVjayBvdXIgbmV3IHByb3BlcnR5IHZhbHVlIGFnYWluc3Qgb3VyIGludGVybmFsIHZhbHVlCiAgdmFyIGhvc3RSZWYgPSBnZXRIb3N0UmVmKHJlZik7CiAgdmFyIGVsbSA9IGhvc3RSZWYuJGhvc3RFbGVtZW50JDsKICB2YXIgb2xkVmFsID0gaG9zdFJlZi4kaW5zdGFuY2VWYWx1ZXMkLmdldChwcm9wTmFtZSk7CiAgdmFyIGZsYWdzID0gaG9zdFJlZi4kZmxhZ3MkOwogIHZhciBpbnN0YW5jZSA9IGhvc3RSZWYuJGxhenlJbnN0YW5jZSQ7CiAgbmV3VmFsID0gcGFyc2VQcm9wZXJ0eVZhbHVlKG5ld1ZhbCwgY21wTWV0YS4kbWVtYmVycyRbcHJvcE5hbWVdWzBdKTsKCiAgaWYgKG5ld1ZhbCAhPT0gb2xkVmFsICYmICghKGZsYWdzICYgOAogIC8qIGlzQ29uc3RydWN0aW5nSW5zdGFuY2UgKi8KICApIHx8IG9sZFZhbCA9PT0gdW5kZWZpbmVkKSkgewogICAgLy8gZ2Fkem9va3MhIHRoZSBwcm9wZXJ0eSdzIHZhbHVlIGhhcyBjaGFuZ2VkISEKICAgIC8vIHNldCBvdXIgbmV3IHZhbHVlIQogICAgaG9zdFJlZi4kaW5zdGFuY2VWYWx1ZXMkLnNldChwcm9wTmFtZSwgbmV3VmFsKTsKCiAgICBpZiAoaW5zdGFuY2UpIHsKICAgICAgaWYgKChmbGFncyAmICgyCiAgICAgIC8qIGhhc1JlbmRlcmVkICovCiAgICAgIHwgMTYKICAgICAgLyogaXNRdWV1ZWRGb3JVcGRhdGUgKi8KICAgICAgKSkgPT09IDIKICAgICAgLyogaGFzUmVuZGVyZWQgKi8KICAgICAgKSB7CiAgICAgICAgICAvLyBsb29rcyBsaWtlIHRoaXMgdmFsdWUgYWN0dWFsbHkgY2hhbmdlZCwgc28gd2UndmUgZ290IHdvcmsgdG8gZG8hCiAgICAgICAgICAvLyBidXQgb25seSBpZiB3ZSd2ZSBhbHJlYWR5IHJlbmRlcmVkLCBvdGhlcndpc2UganVzdCBjaGlsbCBvdXQKICAgICAgICAgIC8vIHF1ZXVlIHRoYXQgd2UgbmVlZCB0byBkbyBhbiB1cGRhdGUsIGJ1dCBkb24ndCB3b3JyeSBhYm91dCBxdWV1aW5nCiAgICAgICAgICAvLyB1cCBtaWxsaW9ucyBjdXogdGhpcyBmdW5jdGlvbiBlbnN1cmVzIGl0IG9ubHkgcnVucyBvbmNlCiAgICAgICAgICBzY2hlZHVsZVVwZGF0ZShlbG0sIGhvc3RSZWYsIGNtcE1ldGEsIGZhbHNlKTsKICAgICAgICB9CiAgICB9CiAgfQp9OwoKdmFyIHByb3h5Q29tcG9uZW50ID0gZnVuY3Rpb24gKENzdHIsIGNtcE1ldGEsIGZsYWdzKSB7CiAgaWYgKGNtcE1ldGEuJG1lbWJlcnMkKSB7CiAgICAvLyBJdCdzIGJldHRlciB0byBoYXZlIGEgY29uc3QgdGhhbiB0d28gT2JqZWN0LmVudHJpZXMoKQogICAgdmFyIG1lbWJlcnMgPSBPYmplY3QuZW50cmllcyhjbXBNZXRhLiRtZW1iZXJzJCk7CiAgICB2YXIgcHJvdG90eXBlXzEgPSBDc3RyLnByb3RvdHlwZTsKICAgIG1lbWJlcnMuZm9yRWFjaChmdW5jdGlvbiAoX2EpIHsKICAgICAgdmFyIG1lbWJlck5hbWUgPSBfYVswXSwKICAgICAgICAgIG1lbWJlckZsYWdzID0gX2FbMV1bMF07CgogICAgICBpZiAobWVtYmVyRmxhZ3MgJiAzMQogICAgICAvKiBQcm9wICovCiAgICAgIHx8IGZsYWdzICYgMgogICAgICAvKiBwcm94eVN0YXRlICovCiAgICAgICYmIG1lbWJlckZsYWdzICYgMzIKICAgICAgLyogU3RhdGUgKi8KICAgICAgKSB7CiAgICAgICAgLy8gcHJveHlDb21wb25lbnQgLSBwcm9wCiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHByb3RvdHlwZV8xLCBtZW1iZXJOYW1lLCB7CiAgICAgICAgICBnZXQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgLy8gcHJveHlDb21wb25lbnQsIGdldCB2YWx1ZQogICAgICAgICAgICByZXR1cm4gZ2V0VmFsdWUodGhpcywgbWVtYmVyTmFtZSk7CiAgICAgICAgICB9LAogICAgICAgICAgc2V0OiBmdW5jdGlvbiAobmV3VmFsdWUpIHsKICAgICAgICAgICAgLy8gcHJveHlDb21wb25lbnQsIHNldCB2YWx1ZQogICAgICAgICAgICBzZXRWYWx1ZSh0aGlzLCBtZW1iZXJOYW1lLCBuZXdWYWx1ZSwgY21wTWV0YSk7CiAgICAgICAgICB9LAogICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLAogICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZQogICAgICAgIH0pOwogICAgICB9CiAgICB9KTsKCiAgICBpZiAoZmxhZ3MgJiAxCiAgICAvKiBpc0VsZW1lbnRDb25zdHJ1Y3RvciAqLwogICAgKSB7CiAgICAgICAgdmFyIGF0dHJOYW1lVG9Qcm9wTmFtZV8xID0gbmV3IE1hcCgpOwoKICAgICAgICBwcm90b3R5cGVfMS5hdHRyaWJ1dGVDaGFuZ2VkQ2FsbGJhY2sgPSBmdW5jdGlvbiAoYXR0ck5hbWUsIF9vbGRWYWx1ZSwgbmV3VmFsdWUpIHsKICAgICAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICAgICAgcGx0LmptcChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHZhciBwcm9wTmFtZSA9IGF0dHJOYW1lVG9Qcm9wTmFtZV8xLmdldChhdHRyTmFtZSk7CiAgICAgICAgICAgIF90aGlzW3Byb3BOYW1lXSA9IG5ld1ZhbHVlID09PSBudWxsICYmIHR5cGVvZiBfdGhpc1twcm9wTmFtZV0gPT09ICdib29sZWFuJyA/IGZhbHNlIDogbmV3VmFsdWU7CiAgICAgICAgICB9KTsKICAgICAgICB9OyAvLyBjcmVhdGUgYW4gYXJyYXkgb2YgYXR0cmlidXRlcyB0byBvYnNlcnZlCiAgICAgICAgLy8gYW5kIGFsc28gY3JlYXRlIGEgbWFwIG9mIGh0bWwgYXR0cmlidXRlIG5hbWUgdG8ganMgcHJvcGVydHkgbmFtZQoKCiAgICAgICAgQ3N0ci5vYnNlcnZlZEF0dHJpYnV0ZXMgPSBtZW1iZXJzLmZpbHRlcihmdW5jdGlvbiAoX2EpIHsKICAgICAgICAgIHZhciBfID0gX2FbMF0sCiAgICAgICAgICAgICAgbSA9IF9hWzFdOwogICAgICAgICAgcmV0dXJuIG1bMF0gJiAxNTsKICAgICAgICB9CiAgICAgICAgLyogSGFzQXR0cmlidXRlICovCiAgICAgICAgKSAvLyBmaWx0ZXIgdG8gb25seSBrZWVwIHByb3BzIHRoYXQgc2hvdWxkIG1hdGNoIGF0dHJpYnV0ZXMKICAgICAgICAubWFwKGZ1bmN0aW9uIChfYSkgewogICAgICAgICAgdmFyIHByb3BOYW1lID0gX2FbMF0sCiAgICAgICAgICAgICAgbSA9IF9hWzFdOwogICAgICAgICAgdmFyIGF0dHJOYW1lID0gbVsxXSB8fCBwcm9wTmFtZTsKICAgICAgICAgIGF0dHJOYW1lVG9Qcm9wTmFtZV8xLnNldChhdHRyTmFtZSwgcHJvcE5hbWUpOwogICAgICAgICAgcmV0dXJuIGF0dHJOYW1lOwogICAgICAgIH0pOwogICAgICB9CiAgfQoKICByZXR1cm4gQ3N0cjsKfTsKCnZhciBpbml0aWFsaXplQ29tcG9uZW50ID0gZnVuY3Rpb24gKGVsbSwgaG9zdFJlZiwgY21wTWV0YSwgaG1yVmVyc2lvbklkLCBDc3RyKSB7CiAgcmV0dXJuIF9fYXdhaXRlcih2b2lkIDAsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiAoKSB7CiAgICB2YXIgZW5kTG9hZCwgZW5kTmV3SW5zdGFuY2UsIHNjb3BlSWRfMSwgZW5kUmVnaXN0ZXJTdHlsZXMsIHN0eWxlLCBhbmNlc3RvckNvbXBvbmVudCwgc2NoZWR1bGU7CiAgICByZXR1cm4gX19nZW5lcmF0b3IodGhpcywgZnVuY3Rpb24gKF9hKSB7CiAgICAgIHN3aXRjaCAoX2EubGFiZWwpIHsKICAgICAgICBjYXNlIDA6CiAgICAgICAgICBpZiAoISgoaG9zdFJlZi4kZmxhZ3MkICYgMzIKICAgICAgICAgIC8qIGhhc0luaXRpYWxpemVkQ29tcG9uZW50ICovCiAgICAgICAgICApID09PSAwKSkgcmV0dXJuIFszCiAgICAgICAgICAvKmJyZWFrKi8KICAgICAgICAgICwgM107IC8vIHdlIGhhdmVuJ3QgaW5pdGlhbGl6ZWQgdGhpcyBlbGVtZW50IHlldAoKICAgICAgICAgIGhvc3RSZWYuJGZsYWdzJCB8PSAzMgogICAgICAgICAgLyogaGFzSW5pdGlhbGl6ZWRDb21wb25lbnQgKi8KICAgICAgICAgIDsgLy8gbGF6eSBsb2FkZWQgY29tcG9uZW50cwogICAgICAgICAgLy8gcmVxdWVzdCB0aGUgY29tcG9uZW50J3MgaW1wbGVtZW50YXRpb24gdG8gYmUKICAgICAgICAgIC8vIHdpcmVkIHVwIHdpdGggdGhlIGhvc3QgZWxlbWVudAoKICAgICAgICAgIENzdHIgPSBsb2FkTW9kdWxlKGNtcE1ldGEpOwogICAgICAgICAgaWYgKCFDc3RyLnRoZW4pIHJldHVybiBbMwogICAgICAgICAgLypicmVhayovCiAgICAgICAgICAsIDJdOwogICAgICAgICAgZW5kTG9hZCA9IHVuaXF1ZVRpbWUoKTsKICAgICAgICAgIHJldHVybiBbNAogICAgICAgICAgLyp5aWVsZCovCiAgICAgICAgICAsIENzdHJdOwoKICAgICAgICBjYXNlIDE6CiAgICAgICAgICBDc3RyID0gX2Euc2VudCgpOwogICAgICAgICAgZW5kTG9hZCgpOwogICAgICAgICAgX2EubGFiZWwgPSAyOwoKICAgICAgICBjYXNlIDI6CiAgICAgICAgICBpZiAoIUNzdHIuaXNQcm94aWVkKSB7CiAgICAgICAgICAgIHByb3h5Q29tcG9uZW50KENzdHIsIGNtcE1ldGEsIDIKICAgICAgICAgICAgLyogcHJveHlTdGF0ZSAqLwogICAgICAgICAgICApOwogICAgICAgICAgICBDc3RyLmlzUHJveGllZCA9IHRydWU7CiAgICAgICAgICB9CgogICAgICAgICAgZW5kTmV3SW5zdGFuY2UgPSBjcmVhdGVUaW1lKCdjcmVhdGVJbnN0YW5jZScsIGNtcE1ldGEuJHRhZ05hbWUkKTsgLy8gb2ssIHRpbWUgdG8gY29uc3RydWN0IHRoZSBpbnN0YW5jZQogICAgICAgICAgLy8gYnV0IGxldCdzIGtlZXAgdHJhY2sgb2Ygd2hlbiB3ZSBzdGFydCBhbmQgc3RvcAogICAgICAgICAgLy8gc28gdGhhdCB0aGUgZ2V0dGVycy9zZXR0ZXJzIGRvbid0IGluY29ycmVjdGx5IHN0ZXAgb24gZGF0YQoKICAgICAgICAgIHsKICAgICAgICAgICAgaG9zdFJlZi4kZmxhZ3MkIHw9IDgKICAgICAgICAgICAgLyogaXNDb25zdHJ1Y3RpbmdJbnN0YW5jZSAqLwogICAgICAgICAgICA7CiAgICAgICAgICB9IC8vIGNvbnN0cnVjdCB0aGUgbGF6eS1sb2FkZWQgY29tcG9uZW50IGltcGxlbWVudGF0aW9uCiAgICAgICAgICAvLyBwYXNzaW5nIHRoZSBob3N0UmVmIGlzIHZlcnkgaW1wb3J0YW50IGR1cmluZwogICAgICAgICAgLy8gY29uc3RydWN0aW9uIGluIG9yZGVyIHRvIGRpcmVjdGx5IHdpcmUgdG9nZXRoZXIgdGhlCiAgICAgICAgICAvLyBob3N0IGVsZW1lbnQgYW5kIHRoZSBsYXp5LWxvYWRlZCBpbnN0YW5jZQoKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIG5ldyBDc3RyKGhvc3RSZWYpOwogICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICBjb25zb2xlRXJyb3IoZSk7CiAgICAgICAgICB9CgogICAgICAgICAgewogICAgICAgICAgICBob3N0UmVmLiRmbGFncyQgJj0gfjgKICAgICAgICAgICAgLyogaXNDb25zdHJ1Y3RpbmdJbnN0YW5jZSAqLwogICAgICAgICAgICA7CiAgICAgICAgICB9CiAgICAgICAgICBlbmROZXdJbnN0YW5jZSgpOwogICAgICAgICAgc2NvcGVJZF8xID0gZ2V0U2NvcGVJZChjbXBNZXRhLiR0YWdOYW1lJCk7CgogICAgICAgICAgaWYgKCFzdHlsZXMuaGFzKHNjb3BlSWRfMSkgJiYgQ3N0ci5zdHlsZSkgewogICAgICAgICAgICBlbmRSZWdpc3RlclN0eWxlcyA9IGNyZWF0ZVRpbWUoJ3JlZ2lzdGVyU3R5bGVzJywgY21wTWV0YS4kdGFnTmFtZSQpOwogICAgICAgICAgICBzdHlsZSA9IENzdHIuc3R5bGU7CiAgICAgICAgICAgIHJlZ2lzdGVyU3R5bGUoc2NvcGVJZF8xLCBzdHlsZSwgISEoY21wTWV0YS4kZmxhZ3MkICYgMQogICAgICAgICAgICAvKiBzaGFkb3dEb21FbmNhcHN1bGF0aW9uICovCiAgICAgICAgICAgICkpOwogICAgICAgICAgICBlbmRSZWdpc3RlclN0eWxlcygpOwogICAgICAgICAgfQoKICAgICAgICAgIF9hLmxhYmVsID0gMzsKCiAgICAgICAgY2FzZSAzOgogICAgICAgICAgYW5jZXN0b3JDb21wb25lbnQgPSBob3N0UmVmLiRhbmNlc3RvckNvbXBvbmVudCQ7CgogICAgICAgICAgc2NoZWR1bGUgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHJldHVybiBzY2hlZHVsZVVwZGF0ZShlbG0sIGhvc3RSZWYsIGNtcE1ldGEsIHRydWUpOwogICAgICAgICAgfTsKCiAgICAgICAgICBpZiAoYW5jZXN0b3JDb21wb25lbnQgJiYgYW5jZXN0b3JDb21wb25lbnRbJ3MtcmMnXSkgewogICAgICAgICAgICAvLyB0aGlzIGlzIHRoZSBpbnRpYWwgbG9hZCBhbmQgdGhpcyBjb21wb25lbnQgaXQgaGFzIGFuIGFuY2VzdG9yIGNvbXBvbmVudAogICAgICAgICAgICAvLyBidXQgdGhlIGFuY2VzdG9yIGNvbXBvbmVudCBoYXMgTk9UIGZpcmVkIGl0cyB3aWxsIHVwZGF0ZSBsaWZlY3ljbGUgeWV0CiAgICAgICAgICAgIC8vIHNvIGxldCdzIGp1c3QgY29vbCBvdXIgamV0cyBhbmQgd2FpdCBmb3IgdGhlIGFuY2VzdG9yIHRvIGNvbnRpbnVlIGZpcnN0CiAgICAgICAgICAgIC8vIHRoaXMgd2lsbCBnZXQgZmlyZWQgb2ZmIHdoZW4gdGhlIGFuY2VzdG9yIGNvbXBvbmVudAogICAgICAgICAgICAvLyBmaW5hbGx5IGdldHMgYXJvdW5kIHRvIHJlbmRlcmluZyBpdHMgbGF6eSBzZWxmCiAgICAgICAgICAgIC8vIGZpcmUgb2ZmIHRoZSBpbml0aWFsIHVwZGF0ZQogICAgICAgICAgICBhbmNlc3RvckNvbXBvbmVudFsncy1yYyddLnB1c2goc2NoZWR1bGUpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc2NoZWR1bGUoKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gWzIKICAgICAgICAgIC8qcmV0dXJuKi8KICAgICAgICAgIF07CiAgICAgIH0KICAgIH0pOwogIH0pOwp9OwoKdmFyIGNvbm5lY3RlZENhbGxiYWNrID0gZnVuY3Rpb24gKGVsbSwgY21wTWV0YSkgewogIGlmICgocGx0LiRmbGFncyQgJiAxCiAgLyogaXNUbXBEaXNjb25uZWN0ZWQgKi8KICApID09PSAwKSB7CiAgICB2YXIgZW5kQ29ubmVjdGVkID0gY3JlYXRlVGltZSgnY29ubmVjdGVkQ2FsbGJhY2snLCBjbXBNZXRhLiR0YWdOYW1lJCk7IC8vIGNvbm5lY3RlZENhbGxiYWNrCgogICAgdmFyIGhvc3RSZWZfMSA9IGdldEhvc3RSZWYoZWxtKTsKCiAgICBpZiAoIShob3N0UmVmXzEuJGZsYWdzJCAmIDEKICAgIC8qIGhhc0Nvbm5lY3RlZCAqLwogICAgKSkgewogICAgICAvLyBmaXJzdCB0aW1lIHRoaXMgY29tcG9uZW50IGhhcyBjb25uZWN0ZWQKICAgICAgaG9zdFJlZl8xLiRmbGFncyQgfD0gMQogICAgICAvKiBoYXNDb25uZWN0ZWQgKi8KICAgICAgOwogICAgICB2YXIgaG9zdElkID0gdm9pZCAwOwoKICAgICAgaWYgKCFob3N0SWQpIHsKICAgICAgICAvLyBpbml0VXBkYXRlCiAgICAgICAgLy8gaWYgdGhlIHNsb3QgcG9seWZpbGwgaXMgcmVxdWlyZWQgd2UnbGwgbmVlZCB0byBwdXQgc29tZSBub2RlcwogICAgICAgIC8vIGluIGhlcmUgdG8gYWN0IGFzIG9yaWdpbmFsIGNvbnRlbnQgYW5jaG9ycyBhcyB3ZSBtb3ZlIG5vZGVzIGFyb3VuZAogICAgICAgIC8vIGhvc3QgZWxlbWVudCBoYXMgYmVlbiBjb25uZWN0ZWQgdG8gdGhlIERPTQogICAgICAgIGlmIChjbXBNZXRhLiRmbGFncyQgJiA0CiAgICAgICAgLyogaGFzU2xvdFJlbG9jYXRpb24gKi8KICAgICAgICB8fCBCVUlMRC5zaGFkb3dEb20KICAgICAgICAvKiBuZWVkc1NoYWRvd0RvbVNoaW0gKi8KICAgICAgICApIHsKICAgICAgICAgIHNldENvbnRlbnRSZWZlcmVuY2UoZWxtKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHsKICAgICAgICAvLyBmaW5kIHRoZSBmaXJzdCBhbmNlc3RvciBjb21wb25lbnQgKGlmIHRoZXJlIGlzIG9uZSkgYW5kIHJlZ2lzdGVyCiAgICAgICAgLy8gdGhpcyBjb21wb25lbnQgYXMgb25lIG9mIHRoZSBhY3RpdmVseSBsb2FkaW5nIGNoaWxkIGNvbXBvbmVudHMgZm9yIGl0cyBhbmNlc3RvcgogICAgICAgIHZhciBhbmNlc3RvckNvbXBvbmVudCA9IGVsbTsKCiAgICAgICAgd2hpbGUgKGFuY2VzdG9yQ29tcG9uZW50ID0gYW5jZXN0b3JDb21wb25lbnQucGFyZW50Tm9kZSB8fCBhbmNlc3RvckNvbXBvbmVudC5ob3N0KSB7CiAgICAgICAgICAvLyBjbGltYiB1cCB0aGUgYW5jZXN0b3JzIGxvb2tpbmcgZm9yIHRoZSBmaXJzdAogICAgICAgICAgLy8gY29tcG9uZW50IHRoYXQgaGFzbid0IGZpbmlzaGVkIGl0cyBsaWZlY3ljbGUgdXBkYXRlIHlldAogICAgICAgICAgaWYgKGFuY2VzdG9yQ29tcG9uZW50WydzLXAnXSkgewogICAgICAgICAgICAvLyB3ZSBmb3VuZCB0aGlzIGNvbXBvbmVudHMgZmlyc3QgYW5jZXN0b3IgY29tcG9uZW50CiAgICAgICAgICAgIC8vIGtlZXAgYSByZWZlcmVuY2UgdG8gdGhpcyBjb21wb25lbnQncyBhbmNlc3RvciBjb21wb25lbnQKICAgICAgICAgICAgYXR0YWNoVG9BbmNlc3Rvcihob3N0UmVmXzEsIGhvc3RSZWZfMS4kYW5jZXN0b3JDb21wb25lbnQkID0gYW5jZXN0b3JDb21wb25lbnQpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gLy8gTGF6eSBwcm9wZXJ0aWVzCiAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVycy5nb29nbGUuY29tL3dlYi9mdW5kYW1lbnRhbHMvd2ViLWNvbXBvbmVudHMvYmVzdC1wcmFjdGljZXMjbGF6eS1wcm9wZXJ0aWVzCgogICAgICBpZiAoY21wTWV0YS4kbWVtYmVycyQpIHsKICAgICAgICBPYmplY3QuZW50cmllcyhjbXBNZXRhLiRtZW1iZXJzJCkuZm9yRWFjaChmdW5jdGlvbiAoX2EpIHsKICAgICAgICAgIHZhciBtZW1iZXJOYW1lID0gX2FbMF0sCiAgICAgICAgICAgICAgbWVtYmVyRmxhZ3MgPSBfYVsxXVswXTsKCiAgICAgICAgICBpZiAobWVtYmVyRmxhZ3MgJiAzMQogICAgICAgICAgLyogUHJvcCAqLwogICAgICAgICAgJiYgZWxtLmhhc093blByb3BlcnR5KG1lbWJlck5hbWUpKSB7CiAgICAgICAgICAgIHZhciB2YWx1ZSA9IGVsbVttZW1iZXJOYW1lXTsKICAgICAgICAgICAgZGVsZXRlIGVsbVttZW1iZXJOYW1lXTsKICAgICAgICAgICAgZWxtW21lbWJlck5hbWVdID0gdmFsdWU7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHsKICAgICAgICAvLyBjb25uZWN0ZWRDYWxsYmFjaywgdGFza1F1ZXVlLCBpbml0aWFsTG9hZAogICAgICAgIC8vIGFuZ3VsYXIgc2V0cyBhdHRyaWJ1dGUgQUZURVIgY29ubmVjdENhbGxiYWNrCiAgICAgICAgLy8gaHR0cHM6Ly9naXRodWIuY29tL2FuZ3VsYXIvYW5ndWxhci9pc3N1ZXMvMTg5MDkKICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vYW5ndWxhci9hbmd1bGFyL2lzc3Vlcy8xOTk0MAogICAgICAgIG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiBpbml0aWFsaXplQ29tcG9uZW50KGVsbSwgaG9zdFJlZl8xLCBjbXBNZXRhKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfQoKICAgIGVuZENvbm5lY3RlZCgpOwogIH0KfTsKCnZhciBzZXRDb250ZW50UmVmZXJlbmNlID0gZnVuY3Rpb24gKGVsbSkgewogIC8vIG9ubHkgcmVxdWlyZWQgd2hlbiB3ZSdyZSBOT1QgdXNpbmcgbmF0aXZlIHNoYWRvdyBkb20gKHNsb3QpCiAgLy8gb3IgdGhpcyBicm93c2VyIGRvZXNuJ3Qgc3VwcG9ydCBuYXRpdmUgc2hhZG93IGRvbQogIC8vIGFuZCB0aGlzIGhvc3QgZWxlbWVudCB3YXMgTk9UIGNyZWF0ZWQgd2l0aCBTU1IKICAvLyBsZXQncyBwaWNrIG91dCB0aGUgaW5uZXIgY29udGVudCBmb3Igc2xvdCBwcm9qZWN0aW9uCiAgLy8gY3JlYXRlIGEgbm9kZSB0byByZXByZXNlbnQgd2hlcmUgdGhlIG9yaWdpbmFsCiAgLy8gY29udGVudCB3YXMgZmlyc3QgcGxhY2VkLCB3aGljaCBpcyB1c2VmdWwgbGF0ZXIgb24KICB2YXIgY3JOYW1lID0gJyc7CiAgdmFyIGNvbnRlbnRSZWZFbG0gPSBlbG1bJ3MtY3InXSA9IGRvYy5jcmVhdGVDb21tZW50KGNyTmFtZSk7CiAgY29udGVudFJlZkVsbVsncy1jbiddID0gdHJ1ZTsKICBlbG0uaW5zZXJ0QmVmb3JlKGNvbnRlbnRSZWZFbG0sIGVsbS5maXJzdENoaWxkKTsKfTsKCnZhciBkaXNjb25uZWN0ZWRDYWxsYmFjayA9IGZ1bmN0aW9uIChlbG0pIHsKICBpZiAoKHBsdC4kZmxhZ3MkICYgMQogIC8qIGlzVG1wRGlzY29ubmVjdGVkICovCiAgKSA9PT0gMCkgewogICAgdmFyIGhvc3RSZWYgPSBnZXRIb3N0UmVmKGVsbSk7IC8vIGNsZWFyIENTUyB2YXItc2hpbSB0cmFja2luZwoKICAgIGlmIChwbHQuJGNzc1NoaW0kKSB7CiAgICAgIHBsdC4kY3NzU2hpbSQucmVtb3ZlSG9zdChlbG0pOwogICAgfQogIH0KfTsKCnZhciBib290c3RyYXBMYXp5ID0gZnVuY3Rpb24gKGxhenlCdW5kbGVzLCBvcHRpb25zKSB7CiAgaWYgKG9wdGlvbnMgPT09IHZvaWQgMCkgewogICAgb3B0aW9ucyA9IHt9OwogIH0KCiAgdmFyIGVuZEJvb3RzdHJhcCA9IGNyZWF0ZVRpbWUoKTsKICB2YXIgY21wVGFncyA9IFtdOwogIHZhciBleGNsdWRlID0gb3B0aW9ucy5leGNsdWRlIHx8IFtdOwogIHZhciBoZWFkID0gZG9jLmhlYWQ7CiAgdmFyIGN1c3RvbUVsZW1lbnRzID0gd2luLmN1c3RvbUVsZW1lbnRzOwogIHZhciB5ID0KICAvKkBfX1BVUkVfXyovCiAgaGVhZC5xdWVyeVNlbGVjdG9yKCdtZXRhW2NoYXJzZXRdJyk7CiAgdmFyIHZpc2liaWxpdHlTdHlsZSA9CiAgLypAX19QVVJFX18qLwogIGRvYy5jcmVhdGVFbGVtZW50KCdzdHlsZScpOwogIHZhciBkZWZlcnJlZENvbm5lY3RlZENhbGxiYWNrcyA9IFtdOwogIHZhciBhcHBMb2FkRmFsbGJhY2s7CiAgdmFyIGlzQm9vdHN0cmFwcGluZyA9IHRydWU7CiAgT2JqZWN0LmFzc2lnbihwbHQsIG9wdGlvbnMpOwogIHBsdC4kcmVzb3VyY2VzVXJsJCA9IG5ldyBVUkwob3B0aW9ucy5yZXNvdXJjZXNVcmwgfHwgJy4vJywgZG9jLmJhc2VVUkkpLmhyZWY7CgogIGlmIChvcHRpb25zLnN5bmNRdWV1ZSkgewogICAgcGx0LiRmbGFncyQgfD0gNAogICAgLyogcXVldWVTeW5jICovCiAgICA7CiAgfQoKICBsYXp5QnVuZGxlcy5mb3JFYWNoKGZ1bmN0aW9uIChsYXp5QnVuZGxlKSB7CiAgICByZXR1cm4gbGF6eUJ1bmRsZVsxXS5mb3JFYWNoKGZ1bmN0aW9uIChjb21wYWN0TWV0YSkgewogICAgICB2YXIgY21wTWV0YSA9IHsKICAgICAgICAkZmxhZ3MkOiBjb21wYWN0TWV0YVswXSwKICAgICAgICAkdGFnTmFtZSQ6IGNvbXBhY3RNZXRhWzFdLAogICAgICAgICRtZW1iZXJzJDogY29tcGFjdE1ldGFbMl0sCiAgICAgICAgJGxpc3RlbmVycyQ6IGNvbXBhY3RNZXRhWzNdCiAgICAgIH07CiAgICAgIHsKICAgICAgICBjbXBNZXRhLiRtZW1iZXJzJCA9IGNvbXBhY3RNZXRhWzJdOwogICAgICB9CiAgICAgIHZhciB0YWdOYW1lID0gY21wTWV0YS4kdGFnTmFtZSQ7CgogICAgICB2YXIgSG9zdEVsZW1lbnQgPQogICAgICAvKiogQGNsYXNzICovCiAgICAgIGZ1bmN0aW9uIChfc3VwZXIpIHsKICAgICAgICBfX2V4dGVuZHMoSG9zdEVsZW1lbnQsIF9zdXBlcik7IC8vIFN0ZW5jaWxMYXp5SG9zdAoKCiAgICAgICAgZnVuY3Rpb24gSG9zdEVsZW1lbnQoc2VsZikgewogICAgICAgICAgdmFyIF90aGlzID0gLy8gQHRzLWlnbm9yZQogICAgICAgICAgX3N1cGVyLmNhbGwodGhpcywgc2VsZikgfHwgdGhpczsKCiAgICAgICAgICBzZWxmID0gX3RoaXM7CiAgICAgICAgICByZWdpc3Rlckhvc3Qoc2VsZik7CiAgICAgICAgICByZXR1cm4gX3RoaXM7CiAgICAgICAgfQoKICAgICAgICBIb3N0RWxlbWVudC5wcm90b3R5cGUuY29ubmVjdGVkQ2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgICAgIGlmIChhcHBMb2FkRmFsbGJhY2spIHsKICAgICAgICAgICAgY2xlYXJUaW1lb3V0KGFwcExvYWRGYWxsYmFjayk7CiAgICAgICAgICAgIGFwcExvYWRGYWxsYmFjayA9IG51bGw7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGlzQm9vdHN0cmFwcGluZykgewogICAgICAgICAgICAvLyBjb25uZWN0ZWRDYWxsYmFjayB3aWxsIGJlIHByb2Nlc3NlZCBvbmNlIGFsbCBjb21wb25lbnRzIGhhdmUgYmVlbiByZWdpc3RlcmVkCiAgICAgICAgICAgIGRlZmVycmVkQ29ubmVjdGVkQ2FsbGJhY2tzLnB1c2godGhpcyk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBwbHQuam1wKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICByZXR1cm4gY29ubmVjdGVkQ2FsbGJhY2soX3RoaXMsIGNtcE1ldGEpOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KICAgICAgICB9OwoKICAgICAgICBIb3N0RWxlbWVudC5wcm90b3R5cGUuZGlzY29ubmVjdGVkQ2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgICAgIHBsdC5qbXAoZnVuY3Rpb24gKCkgewogICAgICAgICAgICByZXR1cm4gZGlzY29ubmVjdGVkQ2FsbGJhY2soX3RoaXMpOwogICAgICAgICAgfSk7CiAgICAgICAgfTsKCiAgICAgICAgSG9zdEVsZW1lbnQucHJvdG90eXBlLmZvcmNlVXBkYXRlID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgZm9yY2VVcGRhdGUodGhpcywgY21wTWV0YSk7CiAgICAgICAgfTsKCiAgICAgICAgSG9zdEVsZW1lbnQucHJvdG90eXBlLmNvbXBvbmVudE9uUmVhZHkgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gZ2V0SG9zdFJlZih0aGlzKS4kb25SZWFkeVByb21pc2UkOwogICAgICAgIH07CgogICAgICAgIHJldHVybiBIb3N0RWxlbWVudDsKICAgICAgfShIVE1MRWxlbWVudCk7CgogICAgICBjbXBNZXRhLiRsYXp5QnVuZGxlSWRzJCA9IGxhenlCdW5kbGVbMF07CgogICAgICBpZiAoIWV4Y2x1ZGUuaW5jbHVkZXModGFnTmFtZSkgJiYgIWN1c3RvbUVsZW1lbnRzLmdldCh0YWdOYW1lKSkgewogICAgICAgIGNtcFRhZ3MucHVzaCh0YWdOYW1lKTsKICAgICAgICBjdXN0b21FbGVtZW50cy5kZWZpbmUodGFnTmFtZSwgcHJveHlDb21wb25lbnQoSG9zdEVsZW1lbnQsIGNtcE1ldGEsIDEKICAgICAgICAvKiBpc0VsZW1lbnRDb25zdHJ1Y3RvciAqLwogICAgICAgICkpOwogICAgICB9CiAgICB9KTsKICB9KTsgLy8gdmlzaWJpbGl0eVN0eWxlLmlubmVySFRNTCA9IGNtcFRhZ3MubWFwKHQgPT4gYCR7dH06bm90KC5oeWRyYXRlZClgKSArICd7ZGlzcGxheTpub25lfSc7CgogIHZpc2liaWxpdHlTdHlsZS5pbm5lckhUTUwgPSBjbXBUYWdzICsgJ3t2aXNpYmlsaXR5OmhpZGRlbn0uaHlkcmF0ZWR7dmlzaWJpbGl0eTppbmhlcml0fSc7CiAgdmlzaWJpbGl0eVN0eWxlLnNldEF0dHJpYnV0ZSgnZGF0YS1zdHlsZXMnLCAnJyk7CiAgaGVhZC5pbnNlcnRCZWZvcmUodmlzaWJpbGl0eVN0eWxlLCB5ID8geS5uZXh0U2libGluZyA6IGhlYWQuZmlyc3RDaGlsZCk7IC8vIFByb2Nlc3MgZGVmZXJyZWQgY29ubmVjdGVkQ2FsbGJhY2tzIG5vdyBhbGwgY29tcG9uZW50cyBoYXZlIGJlZW4gcmVnaXN0ZXJlZAoKICBpc0Jvb3RzdHJhcHBpbmcgPSBmYWxzZTsKCiAgaWYgKGRlZmVycmVkQ29ubmVjdGVkQ2FsbGJhY2tzLmxlbmd0aCA+IDApIHsKICAgIGRlZmVycmVkQ29ubmVjdGVkQ2FsbGJhY2tzLmZvckVhY2goZnVuY3Rpb24gKGhvc3QpIHsKICAgICAgcmV0dXJuIGhvc3QuY29ubmVjdGVkQ2FsbGJhY2soKTsKICAgIH0pOwogIH0gZWxzZSB7CiAgICBwbHQuam1wKGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIGFwcExvYWRGYWxsYmFjayA9IHNldFRpbWVvdXQoYXBwRGlkTG9hZCwgMzAsICd0aW1lb3V0Jyk7CiAgICB9KTsKICB9IC8vIEZhbGxiYWNrIGFwcExvYWQgZXZlbnQKCgogIGVuZEJvb3RzdHJhcCgpOwp9OwoKdmFyIGNyZWF0ZUV2ZW50ID0gZnVuY3Rpb24gKHJlZiwgbmFtZSwgZmxhZ3MpIHsKICB2YXIgZWxtID0gZ2V0RWxlbWVudChyZWYpOwogIHJldHVybiB7CiAgICBlbWl0OiBmdW5jdGlvbiAoZGV0YWlsKSB7CiAgICAgIHZhciBldiA9IG5ldyBDdXN0b21FdmVudChuYW1lLCB7CiAgICAgICAgYnViYmxlczogISEoZmxhZ3MgJiA0CiAgICAgICAgLyogQnViYmxlcyAqLwogICAgICAgICksCiAgICAgICAgY29tcG9zZWQ6ICEhKGZsYWdzICYgMgogICAgICAgIC8qIENvbXBvc2VkICovCiAgICAgICAgKSwKICAgICAgICBjYW5jZWxhYmxlOiAhIShmbGFncyAmIDEKICAgICAgICAvKiBDYW5jZWxsYWJsZSAqLwogICAgICAgICksCiAgICAgICAgZGV0YWlsOiBkZXRhaWwKICAgICAgfSk7CiAgICAgIGVsbS5kaXNwYXRjaEV2ZW50KGV2KTsKICAgICAgcmV0dXJuIGV2OwogICAgfQogIH07Cn07Cgp2YXIgZ2V0RWxlbWVudCA9IGZ1bmN0aW9uIChyZWYpIHsKICByZXR1cm4gZ2V0SG9zdFJlZihyZWYpLiRob3N0RWxlbWVudCQ7Cn07CgpleHBvcnQgeyBwYXRjaEVzbSBhcyBhLCBib290c3RyYXBMYXp5IGFzIGIsIGNyZWF0ZUV2ZW50IGFzIGMsIGgsIHBhdGNoQnJvd3NlciBhcyBwLCByZWdpc3Rlckluc3RhbmNlIGFzIHIgfTs="},{"version":3,"sources":["/home/mary/Desktop/web components/vue-test/vue-button/dist/esm-es5/core-165e720c.js"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","__generator","body","_","label","sent","t","trys","ops","f","y","g","verb","Symbol","iterator","n","v","op","TypeError","call","pop","length","push","__spreadArrays","s","i","il","arguments","r","k","a","j","jl","BUILD","NAMESPACE","queueCongestion","queuePending","scopeId","contentRef","hostTagName","useNativeShadowDom","checkSlotFallbackVisibility","checkSlotRelocate","isSvgMode","win","window","doc","document","head","plt","$flags$","$resourcesUrl$","jmp","h","raf","requestAnimationFrame","ael","el","eventName","listener","opts","addEventListener","rel","removeEventListener","supportsShadowDom","supportsConstructibleStylesheets","CSSStyleSheet","hostRefs","WeakMap","getHostRef","ref","get","registerInstance","lazyInstance","hostRef","set","$lazyInstance$","registerHost","elm","$hostElement$","$instanceValues$","Map","$onReadyPromise$","$onReadyResolve$","isMemberInElement","memberName","consoleError","console","error","moduleCache","loadModule","cmpMeta","hmrVersionId","exportName","$tagName$","replace","bundleId","$lazyBundleIds$","module","importedModule","styles","queueDomReads","queueDomWrites","queueDomWritesLow","queueTask","queue","write","cb","nextTick","flush","consume","performance","now","consumeTimeout","timeout","ts","splice","Math","ceil","Infinity","writeTask","EMPTY_OBJ","isComplexType","o","getDynamicImportFunction","namespace","patchEsm","CSS","supports","$cssShim$","__stencil_cssshim","initShim","patchBrowser","scriptElm","from","querySelectorAll","find","RegExp","test","src","getAttribute","importMeta","history","scrollRestoration","resourcesUrl","URL","href","location","patchDynamicImport","customElements","base","orgScriptElm","importFunctionName","Function","random","moduleMap_1","url","mod","script_1","createElement","type","crossOrigin","createObjectURL","Blob","onload","m","remove","appendChild","parsePropertyValue","propValue","propType","String","HYDRATED_CLASS","createTime","fnName","tagName","uniqueTime","key","measureText","rootAppliedStyles","registerStyle","cssText","allowCS","style","addStyle","styleContainerNode","mode","hostElm","getScopeId","nodeType","appliedStyles","styleElm","Set","has","createHostStyle","newScopeId","innerHTML","insertBefore","querySelector","add","adoptedStyleSheets","includes","attachStyles","endAttachStyles","getRootNode","nodeName","vnodeData","children","_i","child","slotName","simple","lastSimple","vNodeChildren","walk","c","isArray","$text$","newVNode","name","classData_1","className","class","keys","filter","join","vnode","$attrs$","$children$","$name$","tag","text","$tag$","$elm$","Host","isHost","node","setAccessor","oldValue","newValue","isSvg","flags","isProp","ln","toLowerCase","classList","oldClasses_1","parseClassList","newClasses_1","slice","isComplex","removeAttribute","setAttribute","parseClassListRegex","split","updateElement","oldVnode","newVnode","host","oldVnodeAttrs","newVnodeAttrs","undefined","createElm","oldParentVNode","newParentVNode","childIndex","parentElm","childNode","oldVNode","createTextNode","putBackInOriginalLocation","recursive","oldSlotChildNodes","childNodes","parentReferenceNode","referenceNode","addVnodes","before","parentVNode","vnodes","startIdx","endIdx","containerElm","parentNode","removeVnodes","updateChildren","oldCh","newCh","oldStartIdx","newStartIdx","oldEndIdx","oldStartVnode","oldEndVnode","newEndIdx","newStartVnode","newEndVnode","isSameVnode","patch","nextSibling","vnode1","vnode2","oldChildren","newChildren","updateFallbackSlotVisibility","ilen","slotNameAttr","hidden","textContent","trim","relocateNodes","relocateSlotContent","hostContentNodes","some","$nodeToRelocate$","$slotRefNode$","renderVdom","renderFnResults","$vnode$","rootVnode","relocateNode","orgLocationNode","parentNodeRef","insertBeforeNode","previousSibling","refNode","attachToAncestor","ancestorComponent","$onRenderResolve$","scheduleUpdate","isInitialLoad","endSchedule","$ancestorComponent$","instance","update","updateComponent","promise","endUpdate","rc","$modeName$","endRender","callRender","updateHost","forEach","childrenPromises","postUpdate","postUpdateComponent","all","render","endPostUpdate","appDidLoad","forceUpdate","isConnected","who","documentElement","thenFn","getValue","propName","setValue","newVal","oldVal","$members$","proxyComponent","Cstr","members","entries","prototype_1","_a","memberFlags","defineProperty","configurable","enumerable","attrNameToPropName_1","attributeChangedCallback","attrName","_oldValue","_this","observedAttributes","map","initializeComponent","endLoad","endNewInstance","scopeId_1","endRegisterStyles","schedule","isProxied","connectedCallback","endConnected","hostRef_1","hostId","shadowDom","setContentReference","crName","contentRefElm","createComment","firstChild","disconnectedCallback","removeHost","bootstrapLazy","lazyBundles","options","endBootstrap","cmpTags","exclude","visibilityStyle","deferredConnectedCallbacks","appLoadFallback","isBootstrapping","assign","baseURI","syncQueue","lazyBundle","compactMeta","$listeners$","HostElement","_super","self","clearTimeout","componentOnReady","HTMLElement","define","setTimeout","createEvent","getElement","emit","detail","ev","CustomEvent","bubbles","composed","cancelable","dispatchEvent"],"mappings":"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","sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nvar BUILD = { \"allRenderFn\": true, \"cmpDidLoad\": false, \"cmpShouldUpdate\": false, \"cmpDidUnload\": false, \"cmpDidUpdate\": false, \"cmpDidRender\": false, \"cmpWillLoad\": false, \"cmpWillUpdate\": false, \"cmpWillRender\": false, \"connectedCallback\": false, \"disconnectedCallback\": false, \"element\": false, \"event\": true, \"hasRenderFn\": true, \"lifecycle\": false, \"asyncLoading\": true, \"hostListener\": false, \"hostListenerTargetWindow\": false, \"hostListenerTargetDocument\": false, \"hostListenerTargetBody\": false, \"hostListenerTargetParent\": false, \"hostListenerTarget\": false, \"member\": true, \"method\": false, \"mode\": false, \"noVdomRender\": false, \"observeAttribute\": true, \"prop\": true, \"propBoolean\": false, \"propNumber\": false, \"propString\": true, \"propMutable\": false, \"reflect\": false, \"scoped\": false, \"shadowDom\": false, \"shadowDelegatesFocus\": false, \"slot\": true, \"slotRelocation\": true, \"state\": false, \"style\": true, \"svg\": false, \"updatable\": true, \"vdomAttribute\": true, \"vdomXlink\": false, \"vdomClass\": true, \"vdomFunctional\": false, \"vdomKey\": false, \"vdomListener\": true, \"vdomRef\": false, \"vdomRender\": true, \"vdomStyle\": false, \"vdomText\": false, \"watchCallback\": false, \"taskQueue\": true, \"cloneNodeFix\": false, \"appendChildSlotFix\": false, \"lazyLoad\": true, \"hydrateServerSide\": false, \"cssVarShim\": true, \"initializeNextTick\": true, \"hydrateClientSide\": false, \"isDebug\": false, \"isDev\": false, \"devTools\": false, \"lifecycleDOMEvents\": false, \"profile\": false, \"hotModuleReplacement\": false, \"constructableCSS\": true, \"cssAnnotations\": true };\nvar NAMESPACE = 'epy-components';\nvar queueCongestion = 0;\nvar queuePending = false;\nvar scopeId;\nvar contentRef;\nvar hostTagName;\nvar useNativeShadowDom = false;\nvar checkSlotFallbackVisibility = false;\nvar checkSlotRelocate = false;\nvar isSvgMode = false;\nvar win = typeof window !== 'undefined' ? window : {};\nvar doc = win.document || { head: {} };\nvar plt = {\n    $flags$: 0,\n    $resourcesUrl$: '',\n    jmp: function (h) { return h(); },\n    raf: function (h) { return requestAnimationFrame(h); },\n    ael: function (el, eventName, listener, opts) { return el.addEventListener(eventName, listener, opts); },\n    rel: function (el, eventName, listener, opts) { return el.removeEventListener(eventName, listener, opts); },\n};\nvar supportsShadowDom = false;\nvar supportsConstructibleStylesheets = /*@__PURE__*/ (function () {\n    try {\n        new CSSStyleSheet();\n        return true;\n    }\n    catch (e) { }\n    return false;\n})();\nvar hostRefs = new WeakMap();\nvar getHostRef = function (ref) { return hostRefs.get(ref); };\nvar registerInstance = function (lazyInstance, hostRef) { return hostRefs.set(hostRef.$lazyInstance$ = lazyInstance, hostRef); };\nvar registerHost = function (elm) {\n    var hostRef = {\n        $flags$: 0,\n        $hostElement$: elm,\n        $instanceValues$: new Map()\n    };\n    {\n        hostRef.$onReadyPromise$ = new Promise(function (r) { return hostRef.$onReadyResolve$ = r; });\n        elm['s-p'] = [];\n        elm['s-rc'] = [];\n    }\n    return hostRefs.set(elm, hostRef);\n};\nvar isMemberInElement = function (elm, memberName) { return memberName in elm; };\nvar consoleError = function (e) { return console.error(e); };\nvar moduleCache = /*@__PURE__*/ new Map();\nvar loadModule = function (cmpMeta, hostRef, hmrVersionId) {\n    // loadModuleImport\n    var exportName = cmpMeta.$tagName$.replace(/-/g, '_');\n    var bundleId = (cmpMeta.$lazyBundleIds$);\n    var module = moduleCache.get(bundleId);\n    if (module) {\n        return module[exportName];\n    }\n    return import(\n    /* webpackInclude: /\\.entry\\.js$/ */\n    /* webpackExclude: /\\.system\\.entry\\.js$/ */\n    /* webpackMode: \"lazy\" */\n    \"./\" + bundleId + \".entry.js\" + '').then(function (importedModule) {\n        {\n            moduleCache.set(bundleId, importedModule);\n        }\n        return importedModule[exportName];\n    }, consoleError);\n};\nvar styles = new Map();\nvar queueDomReads = [];\nvar queueDomWrites = [];\nvar queueDomWritesLow = [];\nvar queueTask = function (queue, write) { return function (cb) {\n    queue.push(cb);\n    if (!queuePending) {\n        queuePending = true;\n        if (write && plt.$flags$ & 4 /* queueSync */) {\n            nextTick(flush);\n        }\n        else {\n            plt.raf(flush);\n        }\n    }\n}; };\nvar consume = function (queue) {\n    for (var i = 0; i < queue.length; i++) {\n        try {\n            queue[i](performance.now());\n        }\n        catch (e) {\n            consoleError(e);\n        }\n    }\n    queue.length = 0;\n};\nvar consumeTimeout = function (queue, timeout) {\n    var i = 0;\n    var ts = 0;\n    while (i < queue.length && (ts = performance.now()) < timeout) {\n        try {\n            queue[i++](ts);\n        }\n        catch (e) {\n            consoleError(e);\n        }\n    }\n    if (i === queue.length) {\n        queue.length = 0;\n    }\n    else if (i !== 0) {\n        queue.splice(0, i);\n    }\n};\nvar flush = function () {\n    queueCongestion++;\n    // always force a bunch of medium callbacks to run, but still have\n    // a throttle on how many can run in a certain time\n    // DOM READS!!!\n    consume(queueDomReads);\n    var timeout = (plt.$flags$ & 6 /* queueMask */) === 2 /* appLoaded */\n        ? performance.now() + (10 * Math.ceil(queueCongestion * (1.0 / 22.0)))\n        : Infinity;\n    // DOM WRITES!!!\n    consumeTimeout(queueDomWrites, timeout);\n    consumeTimeout(queueDomWritesLow, timeout);\n    if (queueDomWrites.length > 0) {\n        queueDomWritesLow.push.apply(queueDomWritesLow, queueDomWrites);\n        queueDomWrites.length = 0;\n    }\n    if (queuePending = ((queueDomReads.length + queueDomWrites.length + queueDomWritesLow.length) > 0)) {\n        // still more to do yet, but we've run out of time\n        // let's let this thing cool off and try again in the next tick\n        plt.raf(flush);\n    }\n    else {\n        queueCongestion = 0;\n    }\n};\nvar nextTick = /*@__PURE__*/ function (cb) { return Promise.resolve().then(cb); };\nvar writeTask = /*@__PURE__*/ queueTask(queueDomWrites, true);\n/**\n * Default style mode id\n */\n/**\n * Reusable empty obj/array\n * Don't add values to these!!\n */\nvar EMPTY_OBJ = {};\nvar isComplexType = function (o) {\n    // https://jsperf.com/typeof-fn-object/5\n    o = typeof o;\n    return o === 'object' || o === 'function';\n};\nvar getDynamicImportFunction = function (namespace) {\n    return \"__sc_import_\" + namespace.replace(/\\s|-/g, '_');\n};\nvar patchEsm = function () {\n    // @ts-ignore\n    if (!(win.CSS && win.CSS.supports && win.CSS.supports('color', 'var(--c)'))) {\n        // @ts-ignore\n        return import('./css-shim-6aaf713d-9b13816a.js').then(function () {\n            plt.$cssShim$ = win.__stencil_cssshim;\n            if (plt.$cssShim$) {\n                return plt.$cssShim$.initShim();\n            }\n        });\n    }\n    return Promise.resolve();\n};\nvar patchBrowser = function () {\n    {\n        // shim css vars\n        plt.$cssShim$ = win.__stencil_cssshim;\n    }\n    // @ts-ignore\n    var scriptElm = Array.from(doc.querySelectorAll('script')).find(function (s) { return (new RegExp(\"/\" + NAMESPACE + \"(\\\\.esm)?\\\\.js($|\\\\?|#)\").test(s.src) ||\n        s.getAttribute('data-stencil-namespace') === NAMESPACE); });\n    var opts = scriptElm['data-opts'] || {};\n    var importMeta = \"\";\n    if ('onbeforeload' in scriptElm && !history.scrollRestoration && false /* IS_SYSTEM_JS_BUILD */) {\n        // Safari < v11 support: This IF is true if it's Safari below v11.\n        // This fn cannot use async/await since Safari didn't support it until v11,\n        // however, Safari 10 did support modules. Safari 10 also didn't support \"nomodule\",\n        // so both the ESM file and nomodule file would get downloaded. Only Safari\n        // has 'onbeforeload' in the script, and \"history.scrollRestoration\" was added\n        // to Safari in v11. Return a noop then() so the async/await ESM code doesn't continue.\n        // IS_ESM_BUILD is replaced at build time so this check doesn't happen in systemjs builds.\n        return { then: function () { } };\n    }\n    if (importMeta !== '') {\n        opts.resourcesUrl = new URL('.', importMeta).href;\n    }\n    else {\n        opts.resourcesUrl = new URL('.', new URL(scriptElm.getAttribute('data-resources-url') || scriptElm.src, win.location.href)).href;\n        patchDynamicImport(opts.resourcesUrl, scriptElm);\n        if (!window.customElements) {\n            // module support, but no custom elements support (Old Edge)\n            // @ts-ignore\n            return import('./dom-76cc7c7d-0a082895.js').then(function () { return opts; });\n        }\n    }\n    return Promise.resolve(opts);\n};\nvar patchDynamicImport = function (base, orgScriptElm) {\n    var importFunctionName = getDynamicImportFunction(NAMESPACE);\n    try {\n        // test if this browser supports dynamic imports\n        // There is a caching issue in V8, that breaks using import() in Function\n        // By generating a random string, we can workaround it\n        // Check https://bugs.chromium.org/p/v8/issues/detail?id=9558 for more info\n        win[importFunctionName] = new Function('w', \"return import(w);//\" + Math.random());\n    }\n    catch (e) {\n        // this shim is specifically for browsers that do support \"esm\" imports\n        // however, they do NOT support \"dynamic\" imports\n        // basically this code is for old Edge, v18 and below\n        var moduleMap_1 = new Map();\n        win[importFunctionName] = function (src) {\n            var url = new URL(src, base).href;\n            var mod = moduleMap_1.get(url);\n            if (!mod) {\n                var script_1 = doc.createElement('script');\n                script_1.type = 'module';\n                script_1.crossOrigin = orgScriptElm.crossOrigin;\n                script_1.src = URL.createObjectURL(new Blob([\"import * as m from '\" + url + \"'; window.\" + importFunctionName + \".m = m;\"], { type: 'application/javascript' }));\n                mod = new Promise(function (resolve) {\n                    script_1.onload = function () {\n                        resolve(win[importFunctionName].m);\n                        script_1.remove();\n                    };\n                });\n                moduleMap_1.set(url, mod);\n                doc.head.appendChild(script_1);\n            }\n            return mod;\n        };\n    }\n};\nvar parsePropertyValue = function (propValue, propType) {\n    // ensure this value is of the correct prop type\n    if (propValue != null && !isComplexType(propValue)) {\n        if (propType & 1 /* String */) {\n            // could have been passed as a number or boolean\n            // but we still want it as a string\n            return String(propValue);\n        }\n        // redundant return here for better minification\n        return propValue;\n    }\n    // not sure exactly what type we want\n    // so no need to change to a different type\n    return propValue;\n};\nvar HYDRATED_CLASS = 'hydrated';\nvar createTime = function (fnName, tagName) {\n    if (tagName === void 0) { tagName = ''; }\n    {\n        return function () { return; };\n    }\n};\nvar uniqueTime = function (key, measureText) {\n    {\n        return function () { return; };\n    }\n};\nvar rootAppliedStyles = new WeakMap();\nvar registerStyle = function (scopeId, cssText, allowCS) {\n    var style = styles.get(scopeId);\n    if (supportsConstructibleStylesheets && allowCS) {\n        style = (style || new CSSStyleSheet());\n        style.replace(cssText);\n    }\n    else {\n        style = cssText;\n    }\n    styles.set(scopeId, style);\n};\nvar addStyle = function (styleContainerNode, cmpMeta, mode, hostElm) {\n    var scopeId = getScopeId(cmpMeta.$tagName$);\n    var style = styles.get(scopeId);\n    // if an element is NOT connected then getRootNode() will return the wrong root node\n    // so the fallback is to always use the document for the root node in those cases\n    styleContainerNode = (styleContainerNode.nodeType === 11 /* DocumentFragment */ ? styleContainerNode : doc);\n    if (style) {\n        if (typeof style === 'string') {\n            styleContainerNode = styleContainerNode.head || styleContainerNode;\n            var appliedStyles = rootAppliedStyles.get(styleContainerNode);\n            var styleElm = void 0;\n            if (!appliedStyles) {\n                rootAppliedStyles.set(styleContainerNode, appliedStyles = new Set());\n            }\n            if (!appliedStyles.has(scopeId)) {\n                {\n                    if (plt.$cssShim$) {\n                        styleElm = plt.$cssShim$.createHostStyle(hostElm, scopeId, style, !!(cmpMeta.$flags$ & 10 /* needsScopedEncapsulation */));\n                        var newScopeId = styleElm['s-sc'];\n                        if (newScopeId) {\n                            scopeId = newScopeId;\n                            // we don't want to add this styleID to the appliedStyles Set\n                            // since the cssVarShim might need to apply several different\n                            // stylesheets for the same component\n                            appliedStyles = null;\n                        }\n                    }\n                    else {\n                        styleElm = doc.createElement('style');\n                        styleElm.innerHTML = style;\n                    }\n                    styleContainerNode.insertBefore(styleElm, styleContainerNode.querySelector('link'));\n                }\n                if (appliedStyles) {\n                    appliedStyles.add(scopeId);\n                }\n            }\n        }\n        else if (!styleContainerNode.adoptedStyleSheets.includes(style)) {\n            styleContainerNode.adoptedStyleSheets = __spreadArrays(styleContainerNode.adoptedStyleSheets, [\n                style\n            ]);\n        }\n    }\n    return scopeId;\n};\nvar attachStyles = function (elm, cmpMeta, mode) {\n    var endAttachStyles = createTime('attachStyles', cmpMeta.$tagName$);\n    var scopeId = addStyle(elm.getRootNode(), cmpMeta, mode, elm);\n    endAttachStyles();\n};\nvar getScopeId = function (tagName, mode) { return 'sc-' + (tagName); };\n/**\n * Production h() function based on Preact by\n * Jason Miller (@developit)\n * Licensed under the MIT License\n * https://github.com/developit/preact/blob/master/LICENSE\n *\n * Modified for Stencil's compiler and vdom\n */\n// const stack: any[] = [];\n// export function h(nodeName: string | d.FunctionalComponent, vnodeData: d.PropsType, child?: d.ChildType): d.VNode;\n// export function h(nodeName: string | d.FunctionalComponent, vnodeData: d.PropsType, ...children: d.ChildType[]): d.VNode;\nvar h = function (nodeName, vnodeData) {\n    var children = [];\n    for (var _i = 2; _i < arguments.length; _i++) {\n        children[_i - 2] = arguments[_i];\n    }\n    var child = null;\n    var slotName = null;\n    var simple = false;\n    var lastSimple = false;\n    var vNodeChildren = [];\n    var walk = function (c) {\n        for (var i = 0; i < c.length; i++) {\n            child = c[i];\n            if (Array.isArray(child)) {\n                walk(child);\n            }\n            else if (child != null && typeof child !== 'boolean') {\n                if (simple = typeof nodeName !== 'function' && !isComplexType(child)) {\n                    child = String(child);\n                }\n                if (simple && lastSimple) {\n                    // If the previous child was simple (string), we merge both\n                    vNodeChildren[vNodeChildren.length - 1].$text$ += child;\n                }\n                else {\n                    // Append a new vNode, if it's text, we create a text vNode\n                    vNodeChildren.push(simple ? newVNode(null, child) : child);\n                }\n                lastSimple = simple;\n            }\n        }\n    };\n    walk(children);\n    if (vnodeData) {\n        if (vnodeData.name) {\n            slotName = vnodeData.name;\n        }\n        {\n            var classData_1 = vnodeData.className || vnodeData.class;\n            if (classData_1) {\n                vnodeData.class = typeof classData_1 !== 'object'\n                    ? classData_1\n                    : Object.keys(classData_1)\n                        .filter(function (k) { return classData_1[k]; })\n                        .join(' ');\n            }\n        }\n    }\n    var vnode = newVNode(nodeName, null);\n    vnode.$attrs$ = vnodeData;\n    if (vNodeChildren.length > 0) {\n        vnode.$children$ = vNodeChildren;\n    }\n    {\n        vnode.$name$ = slotName;\n    }\n    return vnode;\n};\nvar newVNode = function (tag, text) {\n    var vnode = {\n        $flags$: 0,\n        $tag$: tag,\n        $text$: text,\n        $elm$: null,\n        $children$: null\n    };\n    {\n        vnode.$attrs$ = null;\n    }\n    {\n        vnode.$name$ = null;\n    }\n    return vnode;\n};\nvar Host = {};\nvar isHost = function (node) { return node && node.$tag$ === Host; };\n/**\n * Production setAccessor() function based on Preact by\n * Jason Miller (@developit)\n * Licensed under the MIT License\n * https://github.com/developit/preact/blob/master/LICENSE\n *\n * Modified for Stencil's compiler and vdom\n */\nvar setAccessor = function (elm, memberName, oldValue, newValue, isSvg, flags) {\n    if (oldValue === newValue) {\n        return;\n    }\n    var isProp = isMemberInElement(elm, memberName);\n    var ln = memberName.toLowerCase();\n    if (memberName === 'class') {\n        var classList = elm.classList;\n        var oldClasses_1 = parseClassList(oldValue);\n        var newClasses_1 = parseClassList(newValue);\n        classList.remove.apply(classList, oldClasses_1.filter(function (c) { return c && !newClasses_1.includes(c); }));\n        classList.add.apply(classList, newClasses_1.filter(function (c) { return c && !oldClasses_1.includes(c); }));\n    }\n    else if (!isProp && memberName[0] === 'o' && memberName[1] === 'n') {\n        // Event Handlers\n        // so if the member name starts with \"on\" and the 3rd characters is\n        // a capital letter, and it's not already a member on the element,\n        // then we're assuming it's an event listener\n        if (memberName[2] === '-') {\n            // on- prefixed events\n            // allows to be explicit about the dom event to listen without any magic\n            // under the hood:\n            // <my-cmp on-click> // listens for \"click\"\n            // <my-cmp on-Click> // listens for \"Click\"\n            // <my-cmp on-ionChange> // listens for \"ionChange\"\n            // <my-cmp on-EVENTS> // listens for \"EVENTS\"\n            memberName = memberName.slice(3);\n        }\n        else if (isMemberInElement(win, ln)) {\n            // standard event\n            // the JSX attribute could have been \"onMouseOver\" and the\n            // member name \"onmouseover\" is on the window's prototype\n            // so let's add the listener \"mouseover\", which is all lowercased\n            memberName = ln.slice(2);\n        }\n        else {\n            // custom event\n            // the JSX attribute could have been \"onMyCustomEvent\"\n            // so let's trim off the \"on\" prefix and lowercase the first character\n            // and add the listener \"myCustomEvent\"\n            // except for the first character, we keep the event name case\n            memberName = ln[2] + memberName.slice(3);\n        }\n        if (oldValue) {\n            plt.rel(elm, memberName, oldValue, false);\n        }\n        if (newValue) {\n            plt.ael(elm, memberName, newValue, false);\n        }\n    }\n    else {\n        // Set property if it exists and it's not a SVG\n        var isComplex = isComplexType(newValue);\n        if ((isProp || (isComplex && newValue !== null)) && !isSvg) {\n            try {\n                if (!elm.tagName.includes('-')) {\n                    var n = newValue == null ? '' : newValue;\n                    // Workaround for Safari, moving the <input> caret when re-assigning the same valued\n                    if (memberName === 'list') {\n                        isProp = false;\n                        // tslint:disable-next-line: triple-equals\n                    }\n                    else if (oldValue == null || elm[memberName] != n) {\n                        elm[memberName] = n;\n                    }\n                }\n                else {\n                    elm[memberName] = newValue;\n                }\n            }\n            catch (e) { }\n        }\n        if (newValue == null || newValue === false) {\n            {\n                elm.removeAttribute(memberName);\n            }\n        }\n        else if ((!isProp || (flags & 4 /* isHost */) || isSvg) && !isComplex) {\n            newValue = newValue === true ? '' : newValue;\n            {\n                elm.setAttribute(memberName, newValue);\n            }\n        }\n    }\n};\nvar parseClassListRegex = /\\s/;\nvar parseClassList = function (value) { return (!value) ? [] : value.split(parseClassListRegex); };\nvar updateElement = function (oldVnode, newVnode, isSvgMode, memberName) {\n    // if the element passed in is a shadow root, which is a document fragment\n    // then we want to be adding attrs/props to the shadow root's \"host\" element\n    // if it's not a shadow root, then we add attrs/props to the same element\n    var elm = (newVnode.$elm$.nodeType === 11 /* DocumentFragment */ && newVnode.$elm$.host) ? newVnode.$elm$.host : newVnode.$elm$;\n    var oldVnodeAttrs = (oldVnode && oldVnode.$attrs$) || EMPTY_OBJ;\n    var newVnodeAttrs = newVnode.$attrs$ || EMPTY_OBJ;\n    {\n        // remove attributes no longer present on the vnode by setting them to undefined\n        for (memberName in oldVnodeAttrs) {\n            if (!(memberName in newVnodeAttrs)) {\n                setAccessor(elm, memberName, oldVnodeAttrs[memberName], undefined, isSvgMode, newVnode.$flags$);\n            }\n        }\n    }\n    // add new & update changed attributes\n    for (memberName in newVnodeAttrs) {\n        setAccessor(elm, memberName, oldVnodeAttrs[memberName], newVnodeAttrs[memberName], isSvgMode, newVnode.$flags$);\n    }\n};\nvar createElm = function (oldParentVNode, newParentVNode, childIndex, parentElm) {\n    // tslint:disable-next-line: prefer-const\n    var newVNode = newParentVNode.$children$[childIndex];\n    var i = 0;\n    var elm;\n    var childNode;\n    var oldVNode;\n    if (!useNativeShadowDom) {\n        // remember for later we need to check to relocate nodes\n        checkSlotRelocate = true;\n        if (newVNode.$tag$ === 'slot') {\n            if (scopeId) {\n                // scoped css needs to add its scoped id to the parent element\n                parentElm.classList.add(scopeId + '-s');\n            }\n            newVNode.$flags$ |= (newVNode.$children$)\n                // slot element has fallback content\n                // still create an element that \"mocks\" the slot element\n                ? 2 /* isSlotFallback */\n                // slot element does not have fallback content\n                // create an html comment we'll use to always reference\n                // where actual slot content should sit next to\n                : 1 /* isSlotReference */;\n        }\n    }\n    if (newVNode.$flags$ & 1 /* isSlotReference */) {\n        // create a slot reference node\n        elm = newVNode.$elm$ = doc.createTextNode('');\n    }\n    else {\n        // create element\n        elm = newVNode.$elm$ = (doc.createElement((newVNode.$flags$ & 2 /* isSlotFallback */) ? 'slot-fb' : newVNode.$tag$));\n        // add css classes, attrs, props, listeners, etc.\n        {\n            updateElement(null, newVNode, isSvgMode);\n        }\n        if (newVNode.$children$) {\n            for (i = 0; i < newVNode.$children$.length; ++i) {\n                // create the node\n                childNode = createElm(oldParentVNode, newVNode, i, elm);\n                // return node could have been null\n                if (childNode) {\n                    // append our new node\n                    elm.appendChild(childNode);\n                }\n            }\n        }\n    }\n    {\n        elm['s-hn'] = hostTagName;\n        if (newVNode.$flags$ & (2 /* isSlotFallback */ | 1 /* isSlotReference */)) {\n            // remember the content reference comment\n            elm['s-sr'] = true;\n            // remember the content reference comment\n            elm['s-cr'] = contentRef;\n            // remember the slot name, or empty string for default slot\n            elm['s-sn'] = newVNode.$name$ || '';\n            // check if we've got an old vnode for this slot\n            oldVNode = oldParentVNode && oldParentVNode.$children$ && oldParentVNode.$children$[childIndex];\n            if (oldVNode && oldVNode.$tag$ === newVNode.$tag$ && oldParentVNode.$elm$) {\n                // we've got an old slot vnode and the wrapper is being replaced\n                // so let's move the old slot content back to it's original location\n                putBackInOriginalLocation(oldParentVNode.$elm$, false);\n            }\n        }\n    }\n    return elm;\n};\nvar putBackInOriginalLocation = function (parentElm, recursive) {\n    plt.$flags$ |= 1 /* isTmpDisconnected */;\n    var oldSlotChildNodes = parentElm.childNodes;\n    for (var i = oldSlotChildNodes.length - 1; i >= 0; i--) {\n        var childNode = oldSlotChildNodes[i];\n        if (childNode['s-hn'] !== hostTagName && childNode['s-ol']) {\n            // // this child node in the old element is from another component\n            // // remove this node from the old slot's parent\n            // childNode.remove();\n            // and relocate it back to it's original location\n            parentReferenceNode(childNode).insertBefore(childNode, referenceNode(childNode));\n            // remove the old original location comment entirely\n            // later on the patch function will know what to do\n            // and move this to the correct spot in need be\n            childNode['s-ol'].remove();\n            childNode['s-ol'] = undefined;\n            checkSlotRelocate = true;\n        }\n        if (recursive) {\n            putBackInOriginalLocation(childNode, recursive);\n        }\n    }\n    plt.$flags$ &= ~1 /* isTmpDisconnected */;\n};\nvar addVnodes = function (parentElm, before, parentVNode, vnodes, startIdx, endIdx) {\n    var containerElm = ((parentElm['s-cr'] && parentElm['s-cr'].parentNode) || parentElm);\n    var childNode;\n    for (; startIdx <= endIdx; ++startIdx) {\n        if (vnodes[startIdx]) {\n            childNode = createElm(null, parentVNode, startIdx, parentElm);\n            if (childNode) {\n                vnodes[startIdx].$elm$ = childNode;\n                containerElm.insertBefore(childNode, referenceNode(before));\n            }\n        }\n    }\n};\nvar removeVnodes = function (vnodes, startIdx, endIdx, vnode, elm) {\n    for (; startIdx <= endIdx; ++startIdx) {\n        if (vnode = vnodes[startIdx]) {\n            elm = vnode.$elm$;\n            {\n                // we're removing this element\n                // so it's possible we need to show slot fallback content now\n                checkSlotFallbackVisibility = true;\n                if (elm['s-ol']) {\n                    // remove the original location comment\n                    elm['s-ol'].remove();\n                }\n                else {\n                    // it's possible that child nodes of the node\n                    // that's being removed are slot nodes\n                    putBackInOriginalLocation(elm, true);\n                }\n            }\n            // remove the vnode's element from the dom\n            elm.remove();\n        }\n    }\n};\nvar updateChildren = function (parentElm, oldCh, newVNode, newCh) {\n    var oldStartIdx = 0;\n    var newStartIdx = 0;\n    var oldEndIdx = oldCh.length - 1;\n    var oldStartVnode = oldCh[0];\n    var oldEndVnode = oldCh[oldEndIdx];\n    var newEndIdx = newCh.length - 1;\n    var newStartVnode = newCh[0];\n    var newEndVnode = newCh[newEndIdx];\n    var node;\n    while (oldStartIdx <= oldEndIdx && newStartIdx <= newEndIdx) {\n        if (oldStartVnode == null) {\n            // Vnode might have been moved left\n            oldStartVnode = oldCh[++oldStartIdx];\n        }\n        else if (oldEndVnode == null) {\n            oldEndVnode = oldCh[--oldEndIdx];\n        }\n        else if (newStartVnode == null) {\n            newStartVnode = newCh[++newStartIdx];\n        }\n        else if (newEndVnode == null) {\n            newEndVnode = newCh[--newEndIdx];\n        }\n        else if (isSameVnode(oldStartVnode, newStartVnode)) {\n            patch(oldStartVnode, newStartVnode);\n            oldStartVnode = oldCh[++oldStartIdx];\n            newStartVnode = newCh[++newStartIdx];\n        }\n        else if (isSameVnode(oldEndVnode, newEndVnode)) {\n            patch(oldEndVnode, newEndVnode);\n            oldEndVnode = oldCh[--oldEndIdx];\n            newEndVnode = newCh[--newEndIdx];\n        }\n        else if (isSameVnode(oldStartVnode, newEndVnode)) {\n            // Vnode moved right\n            if ((oldStartVnode.$tag$ === 'slot' || newEndVnode.$tag$ === 'slot')) {\n                putBackInOriginalLocation(oldStartVnode.$elm$.parentNode, false);\n            }\n            patch(oldStartVnode, newEndVnode);\n            parentElm.insertBefore(oldStartVnode.$elm$, oldEndVnode.$elm$.nextSibling);\n            oldStartVnode = oldCh[++oldStartIdx];\n            newEndVnode = newCh[--newEndIdx];\n        }\n        else if (isSameVnode(oldEndVnode, newStartVnode)) {\n            // Vnode moved left\n            if ((oldStartVnode.$tag$ === 'slot' || newEndVnode.$tag$ === 'slot')) {\n                putBackInOriginalLocation(oldEndVnode.$elm$.parentNode, false);\n            }\n            patch(oldEndVnode, newStartVnode);\n            parentElm.insertBefore(oldEndVnode.$elm$, oldStartVnode.$elm$);\n            oldEndVnode = oldCh[--oldEndIdx];\n            newStartVnode = newCh[++newStartIdx];\n        }\n        else {\n            {\n                // new element\n                node = createElm(oldCh && oldCh[newStartIdx], newVNode, newStartIdx, parentElm);\n                newStartVnode = newCh[++newStartIdx];\n            }\n            if (node) {\n                {\n                    parentReferenceNode(oldStartVnode.$elm$).insertBefore(node, referenceNode(oldStartVnode.$elm$));\n                }\n            }\n        }\n    }\n    if (oldStartIdx > oldEndIdx) {\n        addVnodes(parentElm, (newCh[newEndIdx + 1] == null ? null : newCh[newEndIdx + 1].$elm$), newVNode, newCh, newStartIdx, newEndIdx);\n    }\n    else if (newStartIdx > newEndIdx) {\n        removeVnodes(oldCh, oldStartIdx, oldEndIdx);\n    }\n};\nvar isSameVnode = function (vnode1, vnode2) {\n    // compare if two vnode to see if they're \"technically\" the same\n    // need to have the same element tag, and same key to be the same\n    if (vnode1.$tag$ === vnode2.$tag$) {\n        if (vnode1.$tag$ === 'slot') {\n            return vnode1.$name$ === vnode2.$name$;\n        }\n        return true;\n    }\n    return false;\n};\nvar referenceNode = function (node) {\n    // this node was relocated to a new location in the dom\n    // because of some other component's slot\n    // but we still have an html comment in place of where\n    // it's original location was according to it's original vdom\n    return (node && node['s-ol']) || node;\n};\nvar parentReferenceNode = function (node) { return (node['s-ol'] ? node['s-ol'] : node).parentNode; };\nvar patch = function (oldVNode, newVNode) {\n    var elm = newVNode.$elm$ = oldVNode.$elm$;\n    var oldChildren = oldVNode.$children$;\n    var newChildren = newVNode.$children$;\n    {\n        // element node\n        {\n            if (newVNode.$tag$ === 'slot')\n                ;\n            else {\n                // either this is the first render of an element OR it's an update\n                // AND we already know it's possible it could have changed\n                // this updates the element's css classes, attrs, props, listeners, etc.\n                updateElement(oldVNode, newVNode, isSvgMode);\n            }\n        }\n        if (oldChildren !== null && newChildren !== null) {\n            // looks like there's child vnodes for both the old and new vnodes\n            updateChildren(elm, oldChildren, newVNode, newChildren);\n        }\n        else if (newChildren !== null) {\n            // add the new vnode children\n            addVnodes(elm, null, newVNode, newChildren, 0, newChildren.length - 1);\n        }\n        else if (oldChildren !== null) {\n            // no new child vnodes, but there are old child vnodes to remove\n            removeVnodes(oldChildren, 0, oldChildren.length - 1);\n        }\n    }\n};\nvar updateFallbackSlotVisibility = function (elm) {\n    // tslint:disable-next-line: prefer-const\n    var childNodes = elm.childNodes;\n    var childNode;\n    var i;\n    var ilen;\n    var j;\n    var slotNameAttr;\n    var nodeType;\n    for (i = 0, ilen = childNodes.length; i < ilen; i++) {\n        childNode = childNodes[i];\n        if (childNode.nodeType === 1 /* ElementNode */) {\n            if (childNode['s-sr']) {\n                // this is a slot fallback node\n                // get the slot name for this slot reference node\n                slotNameAttr = childNode['s-sn'];\n                // by default always show a fallback slot node\n                // then hide it if there are other slots in the light dom\n                childNode.hidden = false;\n                for (j = 0; j < ilen; j++) {\n                    if (childNodes[j]['s-hn'] !== childNode['s-hn']) {\n                        // this sibling node is from a different component\n                        nodeType = childNodes[j].nodeType;\n                        if (slotNameAttr !== '') {\n                            // this is a named fallback slot node\n                            if (nodeType === 1 /* ElementNode */ && slotNameAttr === childNodes[j].getAttribute('slot')) {\n                                childNode.hidden = true;\n                                break;\n                            }\n                        }\n                        else {\n                            // this is a default fallback slot node\n                            // any element or text node (with content)\n                            // should hide the default fallback slot node\n                            if (nodeType === 1 /* ElementNode */ || (nodeType === 3 /* TextNode */ && childNodes[j].textContent.trim() !== '')) {\n                                childNode.hidden = true;\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n            // keep drilling down\n            updateFallbackSlotVisibility(childNode);\n        }\n    }\n};\nvar relocateNodes = [];\nvar relocateSlotContent = function (elm) {\n    // tslint:disable-next-line: prefer-const\n    var childNodes = elm.childNodes;\n    var ilen = childNodes.length;\n    var i = 0;\n    var j = 0;\n    var nodeType = 0;\n    var childNode;\n    var node;\n    var hostContentNodes;\n    var slotNameAttr;\n    for (ilen = childNodes.length; i < ilen; i++) {\n        childNode = childNodes[i];\n        if (childNode['s-sr'] && (node = childNode['s-cr'])) {\n            // first got the content reference comment node\n            // then we got it's parent, which is where all the host content is in now\n            hostContentNodes = node.parentNode.childNodes;\n            slotNameAttr = childNode['s-sn'];\n            for (j = hostContentNodes.length - 1; j >= 0; j--) {\n                node = hostContentNodes[j];\n                if (!node['s-cn'] && !node['s-nr'] && node['s-hn'] !== childNode['s-hn']) {\n                    // let's do some relocating to its new home\n                    // but never relocate a content reference node\n                    // that is suppose to always represent the original content location\n                    nodeType = node.nodeType;\n                    if (((nodeType === 3 /* TextNode */ || nodeType === 8 /* CommentNode */) && slotNameAttr === '') ||\n                        (nodeType === 1 /* ElementNode */ && node.getAttribute('slot') === null && slotNameAttr === '') ||\n                        (nodeType === 1 /* ElementNode */ && node.getAttribute('slot') === slotNameAttr)) {\n                        // it's possible we've already decided to relocate this node\n                        if (!relocateNodes.some(function (r) { return r.$nodeToRelocate$ === node; })) {\n                            // made some changes to slots\n                            // let's make sure we also double check\n                            // fallbacks are correctly hidden or shown\n                            checkSlotFallbackVisibility = true;\n                            node['s-sn'] = slotNameAttr;\n                            // add to our list of nodes to relocate\n                            relocateNodes.push({\n                                $slotRefNode$: childNode,\n                                $nodeToRelocate$: node\n                            });\n                        }\n                    }\n                }\n            }\n        }\n        if (childNode.nodeType === 1 /* ElementNode */) {\n            relocateSlotContent(childNode);\n        }\n    }\n};\nvar renderVdom = function (hostElm, hostRef, cmpMeta, renderFnResults) {\n    hostTagName = hostElm.tagName;\n    var oldVNode = hostRef.$vnode$ || newVNode(null, null);\n    var rootVnode = isHost(renderFnResults)\n        ? renderFnResults\n        : h(null, null, renderFnResults);\n    rootVnode.$tag$ = null;\n    rootVnode.$flags$ |= 4 /* isHost */;\n    hostRef.$vnode$ = rootVnode;\n    rootVnode.$elm$ = oldVNode.$elm$ = (hostElm);\n    {\n        contentRef = hostElm['s-cr'];\n        useNativeShadowDom = supportsShadowDom;\n        // always reset\n        checkSlotFallbackVisibility = false;\n    }\n    // synchronous patch\n    patch(oldVNode, rootVnode);\n    {\n        if (checkSlotRelocate) {\n            relocateSlotContent(rootVnode.$elm$);\n            for (var i = 0; i < relocateNodes.length; i++) {\n                var relocateNode = relocateNodes[i];\n                if (!relocateNode.$nodeToRelocate$['s-ol']) {\n                    // add a reference node marking this node's original location\n                    // keep a reference to this node for later lookups\n                    var orgLocationNode = doc.createTextNode('');\n                    orgLocationNode['s-nr'] = relocateNode.$nodeToRelocate$;\n                    relocateNode.$nodeToRelocate$.parentNode.insertBefore((relocateNode.$nodeToRelocate$['s-ol'] = orgLocationNode), relocateNode.$nodeToRelocate$);\n                }\n            }\n            // while we're moving nodes around existing nodes, temporarily disable\n            // the disconnectCallback from working\n            plt.$flags$ |= 1 /* isTmpDisconnected */;\n            for (var i = 0; i < relocateNodes.length; i++) {\n                var relocateNode = relocateNodes[i];\n                // by default we're just going to insert it directly\n                // after the slot reference node\n                var parentNodeRef = relocateNode.$slotRefNode$.parentNode;\n                var insertBeforeNode = relocateNode.$slotRefNode$.nextSibling;\n                var orgLocationNode = relocateNode.$nodeToRelocate$['s-ol'];\n                while (orgLocationNode = orgLocationNode.previousSibling) {\n                    var refNode = orgLocationNode['s-nr'];\n                    if (refNode &&\n                        refNode['s-sn'] === relocateNode.$nodeToRelocate$['s-sn'] &&\n                        parentNodeRef === refNode.parentNode) {\n                        refNode = refNode.nextSibling;\n                        if (!refNode || !refNode['s-nr']) {\n                            insertBeforeNode = refNode;\n                            break;\n                        }\n                    }\n                }\n                if ((!insertBeforeNode && parentNodeRef !== relocateNode.$nodeToRelocate$.parentNode) ||\n                    (relocateNode.$nodeToRelocate$.nextSibling !== insertBeforeNode)) {\n                    // we've checked that it's worth while to relocate\n                    // since that the node to relocate\n                    // has a different next sibling or parent relocated\n                    if (relocateNode.$nodeToRelocate$ !== insertBeforeNode) {\n                        // add it back to the dom but in its new home\n                        parentNodeRef.insertBefore(relocateNode.$nodeToRelocate$, insertBeforeNode);\n                    }\n                }\n            }\n            // done moving nodes around\n            // allow the disconnect callback to work again\n            plt.$flags$ &= ~1 /* isTmpDisconnected */;\n        }\n        if (checkSlotFallbackVisibility) {\n            updateFallbackSlotVisibility(rootVnode.$elm$);\n        }\n        // always reset\n        relocateNodes.length = 0;\n    }\n};\nvar attachToAncestor = function (hostRef, ancestorComponent) {\n    if (ancestorComponent && !hostRef.$onRenderResolve$) {\n        ancestorComponent['s-p'].push(new Promise(function (r) { return hostRef.$onRenderResolve$ = r; }));\n    }\n};\nvar scheduleUpdate = function (elm, hostRef, cmpMeta, isInitialLoad) {\n    {\n        hostRef.$flags$ |= 16 /* isQueuedForUpdate */;\n    }\n    if (hostRef.$flags$ & 4 /* isWaitingForChildren */) {\n        hostRef.$flags$ |= 512 /* needsRerender */;\n        return;\n    }\n    var endSchedule = createTime('scheduleUpdate', cmpMeta.$tagName$);\n    var ancestorComponent = hostRef.$ancestorComponent$;\n    var instance = hostRef.$lazyInstance$;\n    var update = function () { return updateComponent(elm, hostRef, cmpMeta, instance, isInitialLoad); };\n    attachToAncestor(hostRef, ancestorComponent);\n    var promise;\n    endSchedule();\n    // there is no ancestorc omponent or the ancestor component\n    // has already fired off its lifecycle update then\n    // fire off the initial update\n    return then(promise, function () { return writeTask(update); });\n};\nvar updateComponent = function (elm, hostRef, cmpMeta, instance, isInitialLoad) {\n    // updateComponent\n    var endUpdate = createTime('update', cmpMeta.$tagName$);\n    var rc = elm['s-rc'];\n    if (isInitialLoad) {\n        // DOM WRITE!\n        attachStyles(elm, cmpMeta, hostRef.$modeName$);\n    }\n    var endRender = createTime('render', cmpMeta.$tagName$);\n    {\n        {\n            // looks like we've got child nodes to render into this host element\n            // or we need to update the css class/attrs on the host element\n            // DOM WRITE!\n            renderVdom(elm, hostRef, cmpMeta, callRender(instance));\n        }\n    }\n    if (plt.$cssShim$) {\n        plt.$cssShim$.updateHost(elm);\n    }\n    {\n        hostRef.$flags$ &= ~16 /* isQueuedForUpdate */;\n    }\n    {\n        hostRef.$flags$ |= 2 /* hasRendered */;\n    }\n    if (rc) {\n        // ok, so turns out there are some child host elements\n        // waiting on this parent element to load\n        // let's fire off all update callbacks waiting\n        rc.forEach(function (cb) { return cb(); });\n        elm['s-rc'] = undefined;\n    }\n    endRender();\n    endUpdate();\n    {\n        var childrenPromises = elm['s-p'];\n        var postUpdate = function () { return postUpdateComponent(elm, hostRef, cmpMeta); };\n        if (childrenPromises.length === 0) {\n            postUpdate();\n        }\n        else {\n            Promise.all(childrenPromises).then(postUpdate);\n            hostRef.$flags$ |= 4 /* isWaitingForChildren */;\n            childrenPromises.length = 0;\n        }\n    }\n};\nvar callRender = function (instance, elm) {\n    try {\n        instance = instance.render();\n    }\n    catch (e) {\n        consoleError(e);\n    }\n    return instance;\n};\nvar postUpdateComponent = function (elm, hostRef, cmpMeta) {\n    var endPostUpdate = createTime('postUpdate', cmpMeta.$tagName$);\n    var ancestorComponent = hostRef.$ancestorComponent$;\n    if (!(hostRef.$flags$ & 64 /* hasLoadedComponent */)) {\n        hostRef.$flags$ |= 64 /* hasLoadedComponent */;\n        {\n            // DOM WRITE!\n            // add the css class that this element has officially hydrated\n            elm.classList.add(HYDRATED_CLASS);\n        }\n        endPostUpdate();\n        {\n            hostRef.$onReadyResolve$(elm);\n            if (!ancestorComponent) {\n                appDidLoad();\n            }\n        }\n    }\n    else {\n        endPostUpdate();\n    }\n    // load events fire from bottom to top\n    // the deepest elements load first then bubbles up\n    {\n        if (hostRef.$onRenderResolve$) {\n            hostRef.$onRenderResolve$();\n            hostRef.$onRenderResolve$ = undefined;\n        }\n        if (hostRef.$flags$ & 512 /* needsRerender */) {\n            nextTick(function () { return scheduleUpdate(elm, hostRef, cmpMeta, false); });\n        }\n        hostRef.$flags$ &= ~(4 /* isWaitingForChildren */ | 512 /* needsRerender */);\n    }\n    // ( •_•)\n    // ( •_•)>⌐■-■\n    // (⌐■_■)\n};\nvar forceUpdate = function (elm, cmpMeta) {\n    {\n        var hostRef = getHostRef(elm);\n        var isConnected = hostRef.$hostElement$.isConnected;\n        if (isConnected && (hostRef.$flags$ & (2 /* hasRendered */ | 16 /* isQueuedForUpdate */)) === 2 /* hasRendered */) {\n            scheduleUpdate(elm, hostRef, cmpMeta, false);\n        }\n        // Returns \"true\" when the forced update was successfully scheduled\n        return isConnected;\n    }\n};\nvar appDidLoad = function (who) {\n    // on appload\n    // we have finish the first big initial render\n    {\n        doc.documentElement.classList.add(HYDRATED_CLASS);\n    }\n    {\n        plt.$flags$ |= 2 /* appLoaded */;\n    }\n};\nvar then = function (promise, thenFn) {\n    return promise && promise.then ? promise.then(thenFn) : thenFn();\n};\nvar getValue = function (ref, propName) { return getHostRef(ref).$instanceValues$.get(propName); };\nvar setValue = function (ref, propName, newVal, cmpMeta) {\n    // check our new property value against our internal value\n    var hostRef = getHostRef(ref);\n    var elm = hostRef.$hostElement$;\n    var oldVal = hostRef.$instanceValues$.get(propName);\n    var flags = hostRef.$flags$;\n    var instance = hostRef.$lazyInstance$;\n    newVal = parsePropertyValue(newVal, cmpMeta.$members$[propName][0]);\n    if (newVal !== oldVal && (!(flags & 8 /* isConstructingInstance */) || oldVal === undefined)) {\n        // gadzooks! the property's value has changed!!\n        // set our new value!\n        hostRef.$instanceValues$.set(propName, newVal);\n        if (instance) {\n            if ((flags & (2 /* hasRendered */ | 16 /* isQueuedForUpdate */)) === 2 /* hasRendered */) {\n                // looks like this value actually changed, so we've got work to do!\n                // but only if we've already rendered, otherwise just chill out\n                // queue that we need to do an update, but don't worry about queuing\n                // up millions cuz this function ensures it only runs once\n                scheduleUpdate(elm, hostRef, cmpMeta, false);\n            }\n        }\n    }\n};\nvar proxyComponent = function (Cstr, cmpMeta, flags) {\n    if (cmpMeta.$members$) {\n        // It's better to have a const than two Object.entries()\n        var members = Object.entries(cmpMeta.$members$);\n        var prototype_1 = Cstr.prototype;\n        members.forEach(function (_a) {\n            var memberName = _a[0], memberFlags = _a[1][0];\n            if (((memberFlags & 31 /* Prop */) ||\n                ((flags & 2 /* proxyState */) &&\n                    (memberFlags & 32 /* State */)))) {\n                // proxyComponent - prop\n                Object.defineProperty(prototype_1, memberName, {\n                    get: function () {\n                        // proxyComponent, get value\n                        return getValue(this, memberName);\n                    },\n                    set: function (newValue) {\n                        // proxyComponent, set value\n                        setValue(this, memberName, newValue, cmpMeta);\n                    },\n                    configurable: true,\n                    enumerable: true\n                });\n            }\n        });\n        if ((flags & 1 /* isElementConstructor */)) {\n            var attrNameToPropName_1 = new Map();\n            prototype_1.attributeChangedCallback = function (attrName, _oldValue, newValue) {\n                var _this = this;\n                plt.jmp(function () {\n                    var propName = attrNameToPropName_1.get(attrName);\n                    _this[propName] = newValue === null && typeof _this[propName] === 'boolean'\n                        ? false\n                        : newValue;\n                });\n            };\n            // create an array of attributes to observe\n            // and also create a map of html attribute name to js property name\n            Cstr.observedAttributes = members\n                .filter(function (_a) {\n                var _ = _a[0], m = _a[1];\n                return m[0] & 15;\n            } /* HasAttribute */) // filter to only keep props that should match attributes\n                .map(function (_a) {\n                var propName = _a[0], m = _a[1];\n                var attrName = m[1] || propName;\n                attrNameToPropName_1.set(attrName, propName);\n                return attrName;\n            });\n        }\n    }\n    return Cstr;\n};\nvar initializeComponent = function (elm, hostRef, cmpMeta, hmrVersionId, Cstr) { return __awaiter(void 0, void 0, void 0, function () {\n    var endLoad, endNewInstance, scopeId_1, endRegisterStyles, style, ancestorComponent, schedule;\n    return __generator(this, function (_a) {\n        switch (_a.label) {\n            case 0:\n                if (!((hostRef.$flags$ & 32 /* hasInitializedComponent */) === 0)) return [3 /*break*/, 3];\n                // we haven't initialized this element yet\n                hostRef.$flags$ |= 32 /* hasInitializedComponent */;\n                // lazy loaded components\n                // request the component's implementation to be\n                // wired up with the host element\n                Cstr = loadModule(cmpMeta);\n                if (!Cstr.then) return [3 /*break*/, 2];\n                endLoad = uniqueTime();\n                return [4 /*yield*/, Cstr];\n            case 1:\n                Cstr = _a.sent();\n                endLoad();\n                _a.label = 2;\n            case 2:\n                if (!Cstr.isProxied) {\n                    proxyComponent(Cstr, cmpMeta, 2 /* proxyState */);\n                    Cstr.isProxied = true;\n                }\n                endNewInstance = createTime('createInstance', cmpMeta.$tagName$);\n                // ok, time to construct the instance\n                // but let's keep track of when we start and stop\n                // so that the getters/setters don't incorrectly step on data\n                {\n                    hostRef.$flags$ |= 8 /* isConstructingInstance */;\n                }\n                // construct the lazy-loaded component implementation\n                // passing the hostRef is very important during\n                // construction in order to directly wire together the\n                // host element and the lazy-loaded instance\n                try {\n                    new Cstr(hostRef);\n                }\n                catch (e) {\n                    consoleError(e);\n                }\n                {\n                    hostRef.$flags$ &= ~8 /* isConstructingInstance */;\n                }\n                endNewInstance();\n                scopeId_1 = getScopeId(cmpMeta.$tagName$);\n                if (!styles.has(scopeId_1) && Cstr.style) {\n                    endRegisterStyles = createTime('registerStyles', cmpMeta.$tagName$);\n                    style = Cstr.style;\n                    registerStyle(scopeId_1, style, !!(cmpMeta.$flags$ & 1 /* shadowDomEncapsulation */));\n                    endRegisterStyles();\n                }\n                _a.label = 3;\n            case 3:\n                ancestorComponent = hostRef.$ancestorComponent$;\n                schedule = function () { return scheduleUpdate(elm, hostRef, cmpMeta, true); };\n                if (ancestorComponent && ancestorComponent['s-rc']) {\n                    // this is the intial load and this component it has an ancestor component\n                    // but the ancestor component has NOT fired its will update lifecycle yet\n                    // so let's just cool our jets and wait for the ancestor to continue first\n                    // this will get fired off when the ancestor component\n                    // finally gets around to rendering its lazy self\n                    // fire off the initial update\n                    ancestorComponent['s-rc'].push(schedule);\n                }\n                else {\n                    schedule();\n                }\n                return [2 /*return*/];\n        }\n    });\n}); };\nvar connectedCallback = function (elm, cmpMeta) {\n    if ((plt.$flags$ & 1 /* isTmpDisconnected */) === 0) {\n        var endConnected = createTime('connectedCallback', cmpMeta.$tagName$);\n        // connectedCallback\n        var hostRef_1 = getHostRef(elm);\n        if (!(hostRef_1.$flags$ & 1 /* hasConnected */)) {\n            // first time this component has connected\n            hostRef_1.$flags$ |= 1 /* hasConnected */;\n            var hostId = void 0;\n            if (!hostId) {\n                // initUpdate\n                // if the slot polyfill is required we'll need to put some nodes\n                // in here to act as original content anchors as we move nodes around\n                // host element has been connected to the DOM\n                if ((cmpMeta.$flags$ & 4 /* hasSlotRelocation */) ||\n                    (BUILD.shadowDom /* needsShadowDomShim */)) {\n                    setContentReference(elm);\n                }\n            }\n            {\n                // find the first ancestor component (if there is one) and register\n                // this component as one of the actively loading child components for its ancestor\n                var ancestorComponent = elm;\n                while ((ancestorComponent = (ancestorComponent.parentNode || ancestorComponent.host))) {\n                    // climb up the ancestors looking for the first\n                    // component that hasn't finished its lifecycle update yet\n                    if ((ancestorComponent['s-p'])) {\n                        // we found this components first ancestor component\n                        // keep a reference to this component's ancestor component\n                        attachToAncestor(hostRef_1, (hostRef_1.$ancestorComponent$ = ancestorComponent));\n                        break;\n                    }\n                }\n            }\n            // Lazy properties\n            // https://developers.google.com/web/fundamentals/web-components/best-practices#lazy-properties\n            if (cmpMeta.$members$) {\n                Object.entries(cmpMeta.$members$).forEach(function (_a) {\n                    var memberName = _a[0], memberFlags = _a[1][0];\n                    if (memberFlags & 31 /* Prop */ && elm.hasOwnProperty(memberName)) {\n                        var value = elm[memberName];\n                        delete elm[memberName];\n                        elm[memberName] = value;\n                    }\n                });\n            }\n            {\n                // connectedCallback, taskQueue, initialLoad\n                // angular sets attribute AFTER connectCallback\n                // https://github.com/angular/angular/issues/18909\n                // https://github.com/angular/angular/issues/19940\n                nextTick(function () { return initializeComponent(elm, hostRef_1, cmpMeta); });\n            }\n        }\n        endConnected();\n    }\n};\nvar setContentReference = function (elm) {\n    // only required when we're NOT using native shadow dom (slot)\n    // or this browser doesn't support native shadow dom\n    // and this host element was NOT created with SSR\n    // let's pick out the inner content for slot projection\n    // create a node to represent where the original\n    // content was first placed, which is useful later on\n    var crName = '';\n    var contentRefElm = elm['s-cr'] = doc.createComment(crName);\n    contentRefElm['s-cn'] = true;\n    elm.insertBefore(contentRefElm, elm.firstChild);\n};\nvar disconnectedCallback = function (elm) {\n    if ((plt.$flags$ & 1 /* isTmpDisconnected */) === 0) {\n        var hostRef = getHostRef(elm);\n        // clear CSS var-shim tracking\n        if (plt.$cssShim$) {\n            plt.$cssShim$.removeHost(elm);\n        }\n    }\n};\nvar bootstrapLazy = function (lazyBundles, options) {\n    if (options === void 0) { options = {}; }\n    var endBootstrap = createTime();\n    var cmpTags = [];\n    var exclude = options.exclude || [];\n    var head = doc.head;\n    var customElements = win.customElements;\n    var y = /*@__PURE__*/ head.querySelector('meta[charset]');\n    var visibilityStyle = /*@__PURE__*/ doc.createElement('style');\n    var deferredConnectedCallbacks = [];\n    var appLoadFallback;\n    var isBootstrapping = true;\n    Object.assign(plt, options);\n    plt.$resourcesUrl$ = new URL(options.resourcesUrl || './', doc.baseURI).href;\n    if (options.syncQueue) {\n        plt.$flags$ |= 4 /* queueSync */;\n    }\n    lazyBundles.forEach(function (lazyBundle) { return lazyBundle[1].forEach(function (compactMeta) {\n        var cmpMeta = {\n            $flags$: compactMeta[0],\n            $tagName$: compactMeta[1],\n            $members$: compactMeta[2],\n            $listeners$: compactMeta[3],\n        };\n        {\n            cmpMeta.$members$ = compactMeta[2];\n        }\n        var tagName = cmpMeta.$tagName$;\n        var HostElement = /** @class */ (function (_super) {\n            __extends(HostElement, _super);\n            // StencilLazyHost\n            function HostElement(self) {\n                var _this = \n                // @ts-ignore\n                _super.call(this, self) || this;\n                self = _this;\n                registerHost(self);\n                return _this;\n            }\n            HostElement.prototype.connectedCallback = function () {\n                var _this = this;\n                if (appLoadFallback) {\n                    clearTimeout(appLoadFallback);\n                    appLoadFallback = null;\n                }\n                if (isBootstrapping) {\n                    // connectedCallback will be processed once all components have been registered\n                    deferredConnectedCallbacks.push(this);\n                }\n                else {\n                    plt.jmp(function () { return connectedCallback(_this, cmpMeta); });\n                }\n            };\n            HostElement.prototype.disconnectedCallback = function () {\n                var _this = this;\n                plt.jmp(function () { return disconnectedCallback(_this); });\n            };\n            HostElement.prototype.forceUpdate = function () {\n                forceUpdate(this, cmpMeta);\n            };\n            HostElement.prototype.componentOnReady = function () {\n                return getHostRef(this).$onReadyPromise$;\n            };\n            return HostElement;\n        }(HTMLElement));\n        cmpMeta.$lazyBundleIds$ = lazyBundle[0];\n        if (!exclude.includes(tagName) && !customElements.get(tagName)) {\n            cmpTags.push(tagName);\n            customElements.define(tagName, proxyComponent(HostElement, cmpMeta, 1 /* isElementConstructor */));\n        }\n    }); });\n    // visibilityStyle.innerHTML = cmpTags.map(t => `${t}:not(.hydrated)`) + '{display:none}';\n    visibilityStyle.innerHTML = cmpTags + '{visibility:hidden}.hydrated{visibility:inherit}';\n    visibilityStyle.setAttribute('data-styles', '');\n    head.insertBefore(visibilityStyle, y ? y.nextSibling : head.firstChild);\n    // Process deferred connectedCallbacks now all components have been registered\n    isBootstrapping = false;\n    if (deferredConnectedCallbacks.length > 0) {\n        deferredConnectedCallbacks.forEach(function (host) { return host.connectedCallback(); });\n    }\n    else {\n        plt.jmp(function () { return appLoadFallback = setTimeout(appDidLoad, 30, 'timeout'); });\n    }\n    // Fallback appLoad event\n    endBootstrap();\n};\nvar createEvent = function (ref, name, flags) {\n    var elm = getElement(ref);\n    return {\n        emit: function (detail) {\n            var ev = new (CustomEvent)(name, {\n                bubbles: !!(flags & 4 /* Bubbles */),\n                composed: !!(flags & 2 /* Composed */),\n                cancelable: !!(flags & 1 /* Cancellable */),\n                detail: detail\n            });\n            elm.dispatchEvent(ev);\n            return ev;\n        }\n    };\n};\nvar getElement = function (ref) { return getHostRef(ref).$hostElement$; };\nexport { patchEsm as a, bootstrapLazy as b, createEvent as c, h, patchBrowser as p, registerInstance as r };\n"]}]}